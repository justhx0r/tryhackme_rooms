{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/4754ca4214993b9701c7668bbca1a86a.png', 'title': 'h4cked', 'description': 'Find out what happened by analysing a .pcap file and hack your way back into the machine', 'code': 'h4cked', 'users': 18668, 'tags': ['security', 'forensics', 'wireshark', 'packet capture', 'ftp', 'php', 'shell', 'reverse shell', 'rootkit', 'passwords', 'sudo', 'web shell', 'hacking', 'hydra', 'backdoor', 'medusa'], 'type': 'challenge', 'difficulty': 'easy', 'userCompleted': False, 'upVotes': 1028, 'created': '2021-02-01T22:43:39.084Z', 'published': '2021-03-12T19:00:00.720Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://i.ibb.co/Tvjg7t9/banner.png', 'creator': 'toxicat0r', 'tasks': [{'taskTitle': "Oh no! We've been hacked!", 'taskDesc': '<br />', 'taskType': 'downloadable', 'taskNo': 1, 'taskCreated': '2021-02-01T22:54:54.745Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '60188666c98efa45fcefade8', 'questions': [{'questionNo': 1, 'question': 'It seems like our machine got hacked by an anonymous threat actor. However, we are lucky to have a .pcap file from the attack. Can you determine what happened? Download the .pcap file and use Wireshark to view it.<br />', 'hint': ''}, {'questionNo': 2, 'question': 'The attacker is trying to log into a specific service. What service is this?<br />', 'hint': 'Port 21'}, {'questionNo': 3, 'question': '<p>There is a very popular tool by Van Hauser which can be used to brute force a series of services. What is the name of this tool? <br /></p>', 'hint': 'https://github.com/vanhauser-thc'}, {'questionNo': 4, 'question': '<p>The attacker is trying to log on with a specific username. What is the username?<br /></p>', 'hint': 'Look at the FTP Request'}, {'questionNo': 5, 'question': "<p>What is the user's password?<br /></p>", 'hint': 'The password is displayed in the FTP request'}, {'questionNo': 6, 'question': '<p>What is the current FTP working directory after the attacker logged in?<br /></p>', 'hint': 'Web root'}, {'questionNo': 7, 'question': "<p>The attacker uploaded a backdoor. What is the backdoor's filename?<br /></p>", 'hint': 'It has a .php extension'}, {'questionNo': 8, 'question': 'The backdoor can be downloaded from a specific URL, as it is located inside the uploaded file. What is the full URL?<br />', 'hint': 'Look at the FTP-DATA protocol'}, {'questionNo': 9, 'question': 'Which command did the attacker manually execute after getting a reverse shell?<br />', 'hint': 'You can right click on the relevant packet and select "Follow" > "TCP Stream"'}, {'questionNo': 10, 'question': "What is the computer's hostname?", 'hint': 'You can right click on the relevant packet and select "Follow" > "TCP Stream"'}, {'questionNo': 11, 'question': '<p>Which command did the attacker execute to spawn a new TTY shell?</p>', 'hint': 'https://netsec.ws/?p=337'}, {'questionNo': 12, 'question': '<p>Which command was executed to gain a root shell?<br /></p>', 'hint': 'It is sudo-related'}, {'questionNo': 13, 'question': '<p>The attacker downloaded something from GitHub. What is the name of the GitHub project?<br /></p>', 'hint': 'The GitHub URL is located in the packet stream'}, {'questionNo': 14, 'question': 'The project can be used to install a stealthy backdoor on the system. It can be very hard to detect. What is this type of backdoor called?<br />', 'hint': 'A certain type of kit'}]}, {'taskTitle': 'Hack your way back into the machine', 'taskDesc': '<br />', 'taskType': 'vm', 'taskNo': 2, 'taskCreated': '2021-02-02T10:11:22.158Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '60192d351d810237de1d5ac0', 'questions': [{'questionNo': 1, 'question': "<p>Deploy the machine.</p><p>The attacker has changed the user's password! Can you replicate the attacker's steps and read the flag.txt? The flag is located in the /root/Reptile directory. Remember, you can always look back at the .pcap file if necessary. Good luck!<br /></p>", 'hint': ''}, {'questionNo': 2, 'question': '<p>Run Hydra (or any similar tool) on the FTP service. The attacker might not have chosen a complex password. You might get lucky if you use a common word list.<br /></p>', 'hint': 'The word list might rock your socks off...'}, {'questionNo': 3, 'question': 'Change the necessary values inside the web shell and upload it to the webserver<br />', 'hint': 'You can also find a series of web shells inside the /usr/share/webshells/php directory. This includes the same web shell as the attacker used. Remember to change the $ip variable to your own IP address and chmod the file if necessary'}, {'questionNo': 4, 'question': '<p>Create a listener on the designated port on your attacker machine. Execute the web shell by visiting the .php file on the targeted web server.<br /></p>', 'hint': 'You can use, for example, netcat to create a listener on the designated port'}, {'questionNo': 5, 'question': '<p>Become root!<br /></p>', 'hint': 'Sudo-related command. There are tons to choose from!'}, {'questionNo': 6, 'question': '<p>Read the flag.txt file inside the Reptile directory<br /></p>', 'hint': ''}]}]}