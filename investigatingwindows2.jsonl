{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/355f44b808c9981ee344fd9a32738eb3.png', 'title': 'Investigating Windows 2.0', 'description': 'In the previous challenge you performed a brief analysis. Within this challenge, you will take a deeper dive into the attack. ', 'code': 'investigatingwindows2', 'users': 10312, 'tags': ['sysinternals', 'loki', 'yara'], 'type': 'challenge', 'difficulty': 'medium', 'userCompleted': False, 'upVotes': 293, 'created': '2021-01-28T19:39:28.881Z', 'published': '2021-02-12T17:52:39.043Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://assets.tryhackme.com/additional/investigation-series/investigating-windows-banner.png', 'creator': 'tryhackme', 'tasks': [{'taskTitle': 'Investigating Windows 2.0', 'taskDesc': '<p style="text-align:center"><img src="http://assets.tryhackme.com/additional/investigation-series/investigations.png" style="width:222.816px;height:200.75px" /><b style="font-size:1rem"><br /></b></p><p><b style="font-size:1rem">Note</b><span style="font-size:1rem">: In order to answer the questions in this challenge you should have completed the following rooms:</span><br /></p><ul><li><a href="http://tryhackme.com/jr/btwindowsinternals" target="_blank">Core Windows Processes</a></li><li><a href="http://tryhackme.com/jr/btsysinternalssg" target="_blank">Sysinternals</a></li><li><span style="font-size:1rem"><a href="https://tryhackme.com/room/yara" target="_blank">Yara</a></span></li></ul><p><u>Tips for LOKI</u>: </p><ul><li>When you run the Loki scan I suggest you save the output to a log file so you can reference it to answer the questions below.\xa0</li><li>The scan may take a while to complete. Make sure the prompt is always moving. It\'s an indicator that the scan is still running. You can kill the scan after you see warnings for ntds.dit files.\xa0</li></ul><p></p><hr /><p></p><p>Connect to the machine using RDP.</p><p>The credentials of the machine are as follows:</p><p><span style="font-weight:bolder">Username</span>:\xa0<code style="font-size:14px">Administrator</code><br /><span style="font-weight:bolder">Password</span>:\xa0<code style="font-size:14px">letmein123!</code></p><p>Your machine\'s IP is:\xa0<code>MACHINE_IP</code></p><p>If you\'re using Remmina to RDP, set the\xa0<span style="font-weight:bolder">Color Depth</span>\xa0to\xa0<code style="font-size:14px">RemoteFX (32 bpp)</code>.</p><p><span style="color:rgb(0, 0, 0);text-align:center"><span style="font-weight:bolder">Note</span>: This machine does not respond to ping (ICMP) and may take a few minutes to boot up.</span></p>', 'taskType': 'vm', 'taskNo': 1, 'taskCreated': '2021-01-28T19:40:47.480Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '6014438a2d6ae650293806e0', 'questions': [{'questionNo': 1, 'question': 'What registry key contains the same command that is executed within a scheduled task?', 'hint': ''}, {'questionNo': 2, 'question': '<p>What analysis tool will immediately close if/when you attempt to launch it?</p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>What is the full WQL Query associated with this script?</p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What is the script language?</p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>What is the name of the other script?</p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>What is the name of the software company visible within the script?</p>', 'hint': ''}, {'questionNo': 7, 'question': '<p>What 2 websites are associated with this software company? (<b>answer, answer</b>)</p>', 'hint': '.com website goes first'}, {'questionNo': 8, 'question': '<p>Search online for the name of the script from Q5 and one of the websites from the previous answer. What attack script comes up in your search?</p>', 'hint': ''}, {'questionNo': 9, 'question': '<p>What is the location of this file within the local machine?</p>', 'hint': ''}, {'questionNo': 10, 'question': 'Which 2 processes open and close very quickly every few minutes? (<b>answer, answer</b>)', 'hint': 'Enter your answer in alphabetical order'}, {'questionNo': 11, 'question': '<p>What is the parent process for these 2 processes?</p>', 'hint': 'Figure out how to launch Process Explorer'}, {'questionNo': 12, 'question': '<p>What is the first operation for the first of the 2 processes?</p>', 'hint': ''}, {'questionNo': 13, 'question': '<p>Inspect the properties for the 1st occurrence of this process. In the Event tab what are the 4 pieces of information displayed? (<span style="font-weight:bolder;font-size:1rem">answer,\xa0</span><span style="font-weight:bolder;font-size:1rem">answer,\xa0</span><span style="font-weight:bolder;font-size:1rem">answer,\xa0</span><span style="font-weight:bolder;font-size:1rem">answer</span><span style="font-size:1rem">)</span></p>', 'hint': ''}, {'questionNo': 14, 'question': '<p>Inspect the disk operations, what is the name of the unusual process?</p>', 'hint': 'Try Process Hacker'}, {'questionNo': 15, 'question': '<p>Run Loki. Inspect the output. What is the name of the module after `Init`?<br /></p>', 'hint': ''}, {'questionNo': 16, 'question': 'Regarding the 2nd warning, what is the name of the eventFilter?', 'hint': ''}, {'questionNo': 17, 'question': '<p>For the 4th warning, what is the class name?</p>', 'hint': ''}, {'questionNo': 18, 'question': '<p>What binary alert has the following 4d5a90000300000004000000ffff0000b8000000 as FIRST_BYTES?</p>', 'hint': ''}, {'questionNo': 19, 'question': 'According to the results, what is the description listed for reason 1?', 'hint': ''}, {'questionNo': 20, 'question': '<p>Which binary alert is marked as APT Cloaked?</p>', 'hint': ''}, {'questionNo': 21, 'question': '<p>What are the matches? (<b>str1, str2</b>)</p>', 'hint': ''}, {'questionNo': 22, 'question': '<p>Which binary alert is associated with somethingwindows.dmp found in C:\\TMP?</p>', 'hint': ''}, {'questionNo': 23, 'question': '<p>Which binary is encrypted that is similar to a trojan?</p>', 'hint': ''}, {'questionNo': 24, 'question': '<p>There is a binary that can masquerade itself as a legitimate core Windows process/image. What is the full path of this binary?</p>', 'hint': ''}, {'questionNo': 25, 'question': '<p>What is the full path location for the legitimate version?</p>', 'hint': ''}, {'questionNo': 26, 'question': '<p>What is the description listed for reason 1?<br /></p>', 'hint': ''}, {'questionNo': 27, 'question': '<p>There is a file in the same folder location that is labeled as a hacktool. What is the name of the file?</p>', 'hint': ''}, {'questionNo': 28, 'question': '<p>What is the name of the Yara Rule MATCH?</p>', 'hint': ''}, {'questionNo': 29, 'question': '<p><span style="font-size:1rem">Which binary didn\'t show in the Loki results?</span><br /></p>', 'hint': ''}, {'questionNo': 30, 'question': '<p>Complete the yar rule file located within the Tools folder on the Desktop. What are 3 strings to complete the rule in order to detect the binary Loki didn\'t hit on? (<span style="font-weight:bolder;font-size:1rem">answer,\xa0</span><span style="font-weight:bolder;font-size:1rem">answer,\xa0</span><span style="font-weight:bolder;font-size:1rem">answer</span><span style="font-size:1rem">)</span></p>', 'hint': ''}]}]}