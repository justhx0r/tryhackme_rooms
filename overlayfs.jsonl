{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/29fd674a4ce506920970714ef27b3d45.png', 'title': 'OverlayFS - CVE-2021-3493', 'description': 'Exploit a 2021 Kernel vulnerability in Ubuntu to become root almost instantly!', 'code': 'overlayfs', 'users': 6620, 'tags': ['privesc', 'linux', 'ubuntu', 'kernel', 'overlay', 'CVE-2021-3493'], 'type': 'walkthrough', 'difficulty': 'info', 'userCompleted': False, 'upVotes': 460, 'created': '2021-04-22T22:50:18.683Z', 'published': '2021-04-28T19:00:00.174Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://images.unsplash.com/photo-1569235186275-626cb53b83ce?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=1352&q=80', 'creator': 'NinjaJc01', 'tasks': [{'taskTitle': 'What is OverlayFS?', 'taskDesc': '<p>OverlayFS is a Linux kernel module that allows the system to combine several mount points into one, so that you can access all the files from each within one directory structure.</p><p>It\'s often used by live USBs, or some other specialist applications. One use is having a read only root file system, and another partition "overlayed" with that to allow applications to write to a temporary file system.</p><p>More resources are included in the final task (Further reading) if you\'d like to learn more about OverlayFS and this exploit.</p><p>Room Banner by\xa0<a href="https://unsplash.com/photos/Q9y3LRuuxmg" target="_blank">Maksym Kaharlytskyi</a> on <a href="https://unsplash.com/" target="_blank">Unsplash</a><br /></p>', 'taskType': 'none', 'taskNo': 1, 'taskCreated': '2021-04-22T22:51:38.819Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'I have a very rough overview of what OverlayFS is', 'hint': ''}]}, {'taskTitle': 'CVE-2021-3493 - OverlayFS Exploit', 'taskDesc': '<h3>About the vuln</h3><p><span style="font-size:1rem">Recently, SSD-Disclosure released a proof of concept (and a great explanation) for an Ubuntu kernel exploit (</span><a href="https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/" target="_blank">https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/</a>)<span style="font-size:1rem">.</span><br /></p><p>This vulnerability is particularly serious, as overlayfs is a kernel module that is installed by default on Ubuntu 1804 Server.<br />If the system is vulnerable, you can very easily escalate from any user to root, as long as you can run a binary. <br />If there isn\'t a C compiler installed on the machine, you can compile the binary statically elsewhere and copy just the binary over.</p><h3>Credentials for SSH</h3><p><code><span style="font-size:14px">Username: overlay</span></code></p><p><code><span style="font-size:14px">Password: tryhackme123</span></code></p><p><i>If you\'re using the web-based machine, open it in full screen (by clicking the <i class="far fa-expand-alt"></i> icon) to copy/paste the exploit code.</i></p>', 'taskType': 'vm', 'taskNo': 2, 'taskCreated': '2021-04-22T23:06:32.147Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '60820d1b94ba003936dbec74', 'questions': [{'questionNo': 1, 'question': 'Deploy the machine with the Start Machine button in this task and wait up to 2 minutes for the VM to boot.', 'hint': ''}, {'questionNo': 2, 'question': '<p><span style="font-size:1rem">SSH into the machine with the credentials provided in the task text.</span></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>Grab the source code for the exploit from <a href="https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/" target="_blank">SSD-Disclosure here</a> and save it as exploit.c on the target machine.<br /></p>', 'hint': 'Perhaps the easiest way is copy/pasting the code into a text editor like Nano or Vim!'}, {'questionNo': 4, 'question': "<p>Compile the exploit with gcc. If you're finding this difficult, a command is given in the hints.</p>", 'hint': 'gcc -o exploit exploit.c'}, {'questionNo': 5, 'question': "<p>Run your compiled exploit, and get root!<br />What's the flag in /root/?<br /></p>", 'hint': ''}]}, {'taskTitle': 'Further reading', 'taskDesc': '<h3>Want to know more about OverlayFS?</h3><p><a href="https://yagrebu.net/unix/rpi-overlay.md" target="_blank">https://yagrebu.net/unix/rpi-overlay.md</a>\xa0- Read only root file system with overlayfs to allow applications to run normally.</p><p><a href="https://wiki.archlinux.org/index.php/Overlay_filesystem" target="_blank">https://wiki.archlinux.org/index.php/Overlay_filesystem</a>\xa0- The Arch Wiki\'s page on OverlayFS (I don\'t use Arch BTW)</p><h3>Want to know more about this specific CVE?</h3><p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3493" target="_blank">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3493</a>\xa0- Mitre\'s CVE entry for this vulnerability, which includes many further links.</p><p><a href="https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/" target="_blank">https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/</a><a href="https://ssd-disclosure.com/ssd-advisory-overlayfs-pe/" target="_blank"></a>\xa0- This is where we got the PoC code, and it explains the vulnerability very well.<br /></p>', 'taskType': 'none', 'taskNo': 3, 'taskCreated': '2021-04-22T23:51:17.960Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': "Hope you've enjoyed this short room.", 'hint': ''}]}]}