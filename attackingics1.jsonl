{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/f07ba5ffd2068e849893904f14128cf5.png', 'title': 'Attacking ICS Plant #1', 'description': 'Learn how to discover and attack ICS plants using modbus protocol (Modicon / Schneider Electric).', 'code': 'attackingics1', 'users': 4626, 'tags': ['security', 'ics', 'ot', 'scada', 'iot'], 'type': 'walkthrough', 'difficulty': 'easy', 'userCompleted': False, 'upVotes': 223, 'created': '2020-09-02T12:02:48.913Z', 'published': '2020-11-17T19:00:00.175Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://assets.tryhackme.com/img/banners/default_tryhackme.png', 'creator': 'dainok', 'tasks': [{'taskTitle': 'Introduction to OT/ICS', 'taskDesc': '<p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Operational Technology (OT) refers to systems used to monitor and control industrial operations. Industrial Control Systems (ICS) includes systems used to monitor and control industrial processes.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">If IT operators have dozens of years of experience securing networks, systems and applications, OT operators are pretty new to this topic. Moreover in OT/ICS development availability is always preferred over integrity and confidentiality. In other words ICS softwares are designed to be fast but, often, insecure.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Supervisory Control and Data Acquisition (SCADA) systems are used to control and automate industrial processes. SCADA systems includes:</span></p><ul><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-weight:700;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Supervisory computers:</span><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap"> the servers used to manage the process gathering data on the process and communicating with filed devices (PLC/RTU). In smaller deployments HMI is embedded in a single computer, in larger deploy HMI is installed into a dedicated computer.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-weight:700;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Programmable Logic Controllers (PLC):</span><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap"> digital computers used mainly for automating industrial processes. They are used to continuously monitor sensors (input) and make decisions controlling devices (output).</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Remote Terminal Units (RTU): nowadays RTUs and PLCs functionalities overlap with each other. RTUs are usually preferred for wider geographical telemetry whereas PLCs are better with local controls.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-weight:700;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Communication network:</span><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap"> the network connecting all SCADA components (Ethernet, Serial, telephones, radio, cellular...). Network failures do not necessarily impact negatively on the plant process.\xa0 Both RTU\'s and PLC\'s should be designed to operate autonomously, using the last instruction given from the supervisory system.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;background-color:transparent;font-weight:700;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Human Machine Interface (HMI):</span><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap"> displays a digitalized representation of the plant. Operators can interact with the plant issuing commands using mouse, keyboards or touch screens. </span><span style="font-size:12pt;background-color:transparent;font-weight:700;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Operators can make supervisory decisions adjusting or overriding the normal plant behaviour.</span></p></li></ul><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">In short and simple words:</span></p><ul><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">industries are managed by sophisticated, mission critical computers (SCADA systems);</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">security is not the first priority in OT/ICS;</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">operators can manually override the behaviour of the plant via mouse/keyboard/touchscreen, locally or remotely;</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">a malicious software can override the behaviour of the plant like HMI does.</span></p></li></ul><p><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">For more information see </span><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-82r2.pdf"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Guide to Industrial Control Systems (ICS) Security (NIST 800-82)</span></a><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">.</span></p>', 'taskType': 'none', 'taskNo': 1, 'taskCreated': '2020-09-02T12:05:30.593Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'No answer needed', 'hint': ''}]}, {'taskTitle': 'Introduction to Modbus protocol', 'taskDesc': '<p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Modbus is an industrial protocol developed by Modicon, acquired by Schneider Electric. Modbus is widely used to connect industrial devices; protocol specification is available and royalty-free.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Modbus protocol is a master/slave protocol: the master reads and writes slaves\' registers.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Modbus RTU is usually used via RS-485 (serial network): one master is present with one or more slaves. Each slave has an unique 8-bit address.\xa0</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Modbus data is used to read and write "registers" which are 16-bit long. The most common register is called "holding register" which is readable and writable; registry type "input register" is readable only. The registers "coil" and "discrete input" are 1-bit long: coils are readable and writable, discrete inputs are readable only.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Modbus register types:</span></p><ul><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Discrete Input (Status Input): 1bit, RO</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Coil (Discrete Output): 1bit, R/W</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Input Register: 16bit, RO</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Holding Register: 16bit R/W</span></p></li></ul><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Most commonly Modbus function:</span></p><div style="margin-left:0pt" align="left"><table style="border:none"><tbody><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Function Code</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Register Type</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">1</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Read Coil</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">2</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Read Discrete Input</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">3</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Read Holding Registers</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">4</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Read Input Registers</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">5</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Write Single Coil</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">6</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Write Single Holding Register</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">15</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Write Multiple Coils</span></p></td></tr><tr><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">16</span></p></td><td style="border-width:0.75pt;border-style:solid;border-color:rgb(222, 226, 230);vertical-align:middle;padding:5pt;overflow:hidden;overflow-wrap:break-word"><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Write Multiple Holding Registers</span></p></td></tr></tbody></table></div><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Modbus TCP encapsulates Modbus RTU request and response data packets in a TCP packet transmitted over standard Ethernet networks. The TCP Modbus standard port is 502.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">For more information see </span><a href="https://www.csimn.com/CSI_pages/Modbus101.html"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Modbus 101 - Introduction to Modbus</span></a><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Before starting, download the attached script package and install the Modbus TCP library for Python with the following command:</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">pip3 install pymodbus==1.5.2</span></p>', 'taskType': 'downloadable', 'taskNo': 2, 'taskCreated': '2020-09-02T12:24:13.038Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fe496b3c7540d51ba92adb3', 'questions': [{'questionNo': 1, 'question': '<div>Which is the function used to read holding registers in pymodbus library?</div>', 'hint': 'See discovery.py.'}, {'questionNo': 2, 'question': '<p>Which is the function used to write holding registers in pymodbus library?</p>', 'hint': 'See any attack*.py files.'}]}, {'taskTitle': 'Discovery', 'taskDesc': '<p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Connect to the plant using the browser (</span><a href="http://machine_ip"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;color:rgb(17, 85, 204);background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-line:underline;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre-wrap">http://MACHINE_IP</span></a><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">) and learn how the bottle-filling plant works.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">We have three phases:</span></p><ol><li style="list-style-type:decimal;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Initialization: the plant is starting from the beginning. The roller moves the first bottle under the nozzle.</span></p></li><li style="list-style-type:decimal;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Filling: once a bottle is under the nozzle, the nozzle opens and the water flows in the bottle.</span></p></li><li style="list-style-type:decimal;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Moving: once the bottle is filled, the roller starts again moving the next empty bottle under the nozzle.</span></p></li></ol><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">When the phase 3 ends, the plant starts again with phase 2.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">From the three phases described above, we can observe:</span></p><ul><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Sensors: used to read a state of the plant.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Actuators: used to alter the state of the plant.</span></p></li></ul><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Example: a sensor can detect if a bottle is under the nozzle, while an actuator can open or close the nozzle.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Mind we can press the ESC button to start the plant from the beginning.</span></p><p><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">VirtuaPlant can be downloaded from </span><a href="https://github.com/jseidl/virtuaplant/network/members"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">GitHub</span></a><span style="font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">.</span><br /></p>', 'taskType': 'vm', 'taskNo': 3, 'taskCreated': '2020-09-02T12:25:56.020Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5f70c814b84724257e3a9043', 'questions': [{'questionNo': 1, 'question': 'How many phases can we observe?', 'hint': ''}, {'questionNo': 2, 'question': '<p>How many sensors can we observe?</p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>How many actuators can we observe?</p>', 'hint': 'Include the button to start or stop the plant.'}, {'questionNo': 4, 'question': '<p>Using the script discovery.py, how many registers can we count?</p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>After the plant is started and a bottle is loaded, how many registers are\xa0continuously\xa0<span style="font-size:1rem">changing their values?</span></p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>Which is the minimum observed value?</p>', 'hint': ''}, {'questionNo': 7, 'question': '<p>Which is the maximum observed value?</p>', 'hint': ''}, {'questionNo': 8, 'question': '<p>Which registry is holding its value?</p>', 'hint': 'Start counting from 1.'}, {'questionNo': 9, 'question': '<p>Which registries are set to 1 while the nozzle is filling a bottle?</p>', 'hint': 'Start counting from 1.'}, {'questionNo': 10, 'question': '<p>Which registries are set to 1 while the roller is moving the bottles?</p>', 'hint': 'Start counting from 1.'}, {'questionNo': 11, 'question': '<p>Which is the color of the water level sensor?</p>', 'hint': ''}, {'questionNo': 12, 'question': '<p>Which is the color of the bottle sensor?</p>', 'hint': ''}, {'questionNo': 13, 'question': 'If you observe the plant at the very beginning, which is the registry associated with the roller?', 'hint': 'Restart the plant and observe it from the very beginning.'}, {'questionNo': 14, 'question': '<p>Based on the previous answer, which is the registry associated with the water level sensor?</p>', 'hint': 'The roller is moving only when the bottle is filled.'}]}, {'taskTitle': 'Play to learn', 'taskDesc': '<p><span class="font" style="font-family:Ubuntu, sans-serif"><span class="size" style="font-size:12pt">On the previous task, we learned a lot about registries:</span></span></p>\n<ul>\n<li><span class="size" style="font-size:12pt">Bottle-filling plant exposes 16 registries, but only 5 are used.</span></li>\n<li><span class="size" style="font-size:12pt">Registry 16 is associated with the start/stop button: 1 means plant is on, 0 means plant is off.</span></li>\n<li><span class="size" style="font-size:12pt">Registries 1 and 3 usually have the same value, except in the initialization phase.</span></li>\n<li><span class="size" style="font-size:12pt">Registries 2 and 4 always have the same value.</span></li>\n</ul>\n<p><span class="font" style="font-family:Ubuntu, sans-serif"><span class="size" style="font-size:12pt">We observed three phases, and the associated registries are:</span></span></p>\n<ul>\n<li><span class="size" style="font-size:12pt">Initialization: [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]</span></li>\n<li><span class="size" style="font-size:12pt">Filling: once a bottle is under the nozzle, the nozzle opens and the water flows in the bottle.</span></li>\n<li><span class="size" style="font-size:12pt">Moving: once the bottle is filled, the roller starts again moving the next empty bottle under the nozzle.</span></li>\n</ul>\n<p><span class="font" style="font-family:Ubuntu, sans-serif"><span class="size" style="font-size:12pt">We also assumed the plant has two sensors and three actuators. Actuators:</span></span></p>\n<ul>\n<li><span class="size" style="font-size:12pt">Start/stop button: registry 16.</span></li>\n<li><span class="size" style="font-size:12pt">Roller engine: registry 3.</span></li>\n<li><span class="size" style="font-size:12pt">Nozzle: registry 2 or 4. We need to spend additional time on that.</span></li>\n</ul>\n<p><span class="font" style="font-family:Ubuntu, sans-serif"><span class="size" style="font-size:12pt">Sensors:</span></span></p>\n<ul>\n<li><span class="size" style="font-size:12pt">Water level: 1 (red sensor)</span></li>\n<li><span class="size" style="font-size:12pt">Bottle position: 2 or 4 (green sensor). We need to spend additional time on that.</span></li>\n</ul>\n<p><span class="font" style="font-family:Ubuntu, sans-serif"><span class="size" style="font-size:12pt">Now play with set_registry.py script and find out which registries are associated with the nozzle.</span></span></p>\n', 'taskType': 'none', 'taskNo': 4, 'taskCreated': '2020-09-02T12:26:36.606Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p>Which is the registry associated with the nozzle?</p>\n', 'hint': 'Set registry 2 to value 1. Do the same with registry 4. '}]}, {'taskTitle': 'Attack', 'taskDesc': '<p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">On the previous tasks, we figured out how registries work:</span></p><ul><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Registry 1: associated with the bottle sensor. Value is 1 if the bottle is under the nozzle.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Registry 2: associated with the water level sensor. Value is 1 if the bottle is filled.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Registry 3: associated with the roller actuators. Value 1 turns the roller on.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt"><span style="font-size:12pt;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Registry 4: associated with the nozzle. Value 1 opens the nozzle.</span></p></li><li style="list-style-type:disc;font-size:12pt;font-family:Ubuntu, sans-serif;background-color:transparent;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre"><p style="line-height:1.38;margin-top:0pt;margin-bottom:12pt"><span style="font-size:12pt;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Registry 16: associated with the plant. Value 1 starts the plant</span></p></li></ul><p style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;padding:0pt 0pt 10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">We can abuse the registries forcing a custom value to the above registries. We can do that in many ways.</span></p><p style="line-height:1.38;margin-top:0pt;margin-bottom:10pt"><span style="font-size:12pt;font-family:Ubuntu, sans-serif;font-variant-numeric:normal;font-variant-east-asian:normal;vertical-align:baseline;white-space:pre-wrap">Mind that the plant manager will shut down the plant if an abnormal condition is detected.</span></p><ul></ul>', 'taskType': 'none', 'taskNo': 5, 'taskCreated': '2020-09-02T12:58:50.012Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'Shutdown the plant and avoid the plant manager starts it again.', 'hint': 'See attack_shutdown.py'}, {'questionNo': 2, 'question': '<p>Start the plant, open the nozzle while bottles are moving.</p>', 'hint': 'See attack_move_fill.py'}, {'questionNo': 3, 'question': '<p>Start the plant, open the nozzle and stop the rollet.</p>', 'hint': 'See attack_stop_fill.py'}, {'questionNo': 4, 'question': '<p>Repeat attack in question 1 abusing sensor registries.</p>', 'hint': 'See attack_shutdown2.py'}, {'questionNo': 5, 'question': '<p>Repeat attack in question 2 abusing\xa0sensor registries.<br /></p>', 'hint': 'See attack_move_fill2.py'}, {'questionNo': 6, 'question': '<p>Repeat attack in question 3 abusing\xa0sensor registries.<br /></p>', 'hint': 'See attack_stop_fill2.py'}]}]}