{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/46d805a52e01a41ddbc06f161c76e696.jpeg', 'title': 'Crack The Hash Level 2', 'description': 'Advanced cracking hashes challenges and wordlist generation', 'code': 'crackthehashlevel2', 'users': 7993, 'tags': ['hash', 'hashcat', 'johntheripper', 'cracking', 'password', 'wordlists', 'wordlist generation'], 'type': 'challenge', 'difficulty': 'medium', 'userCompleted': False, 'upVotes': 412, 'created': '2020-09-03T17:15:58.670Z', 'published': '2021-01-13T19:00:00.261Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://i.imgur.com/Ln8tSMc.png', 'creator': 'noraj', 'tasks': [{'taskTitle': '<span class="badge badge-soft-info size-16">Info</span> Introduction', 'taskDesc': '<p>Password cracking is part of the penetration tester job but is rarely taught on challenges platforms. In this room you will learn to how to crack hashes, identify hash types, create custom wordlists, find specific wordlists, create mutations rules, etc.</p><p>This room is a spiritual successor to <a href="https://tryhackme.com/room/crackthehash" target="_blank">Crack the Hash</a>.<br /></p><p align="center"><a href="https://tryhackme.com/room/crackthehash" target="_blank"><img style="width:501px" src="https://i.imgur.com/iernsR4.png" /></a><br /></p><p>I recommend you to have done the room <a href="https://tryhackme.com/room/crackthehash" target="_blank">Crack the hash</a> before attempting this one, which is harder and will use more advanced techniques.</p><p>However this room include a course about hash cracking before you have to face the cracking challenges, it may be a good idea to read the course part before doing <a href="https://tryhackme.com/room/crackthehash" target="_blank">Crack the hash</a> if you are a new comer.<br /></p>', 'taskType': 'none', 'taskNo': 1, 'taskCreated': '2020-09-03T17:19:12.883Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<br />', 'hint': ''}]}, {'taskTitle': '<span class="badge size-16" style="background-color:rgba(252,190,108,.18);color:#fcbe6c">Walkthrough</span> Hash identification', 'taskDesc': '<p>Often the first thing you will need when you encounter a hash, is trying to identify which kind of hash it is.<br />There are a lot of hash types, some are very famous like MD5 or SHA1 but other are less and there are several hash types possible for a given character set and length.</p>', 'taskType': 'none', 'taskNo': 2, 'taskCreated': '2020-09-03T17:39:43.791Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<a href="https://noraj.github.io/haiti/" target="_blank">Haiti</a> is a CLI tool to identify the hash type of a given hash. <a href="https://noraj.github.io/haiti/#/pages/install" target="_blank">Install</a> it.<br />', 'hint': ''}, {'questionNo': 2, 'question': '<p>Launch Haiti on this hash:<br /></p><p><code>741ebf5166b9ece4cca88a3868c44871e8370707cf19af3ceaa4a6fba006f224ae03f39153492853</code></p><p>What kind of hash it is?<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>Launch Haiti on this hash:</p><p>\n<code>1aec7a56aa08b25b596057e1ccbcb6d768b770eaa0f355ccbd56aee5040e02ee</code>\n<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What is Keccak-256 Hashcat code?<br /></p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>What is Keccak-256 John the Ripper code?<br /></p>', 'hint': ''}]}, {'taskTitle': '<span class="badge size-16" style="background-color:rgba(252,190,108,.18);color:#fcbe6c">Walkthrough</span> Wordlists', 'taskDesc': '<p>For hash cracking you will often need some custom or specialized dictionaries called wordlists.</p><p><a href="https://github.com/danielmiessler/SecLists" target="_blank">SecLists</a> is a collection of multiple types of lists used during security assessments, \ncollected in one place. List types include usernames, passwords, URLs, \nsensitive data patterns, fuzzing payloads, web shells, and many more.</p><p><a href="https://github.com/BlackArch/wordlistctl" target="_blank">wordlistctl</a> is a script to fetch, install, update and search wordlist archives from websites\noffering wordlists with more than 6300 wordlists available.</p><p><a href="https://inventory.raw.pm/overview.html" target="_blank">Rawsec\'s CyberSecurity Inventory</a> is an inventory of tools and resources about CyberSecurity. The <a href="https://inventory.raw.pm/tools.html#title-tools-cracking" target="_blank">Cracking</a> category will be especially useful to find wordlist generator tools.</p><p><span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:&quot;ubuntu&quot;"><b><span style="font-family:&quot;ubuntu&quot;">Note</span></b><span style="font-family:&quot;ubuntu&quot;">: On the exercise below</span></span><span style="font-family:&quot;ubuntu&quot;"> we will see how to use how to use wordlistctl to download a list, for the example I took rockyou</span><span style="font-family:&quot;ubuntu&quot;"> which is a famous wordlist but if you use </span></span></span></span></span></span></span><span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:&quot;ubuntu&quot;">TryHackMe AttackBox or Kali Linux you should already have it under </span></span></span></span></span></span><code>/usr/share/wordlists/</code><span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:&quot;ubuntu&quot;">, so you don\'t need to download it again, this is just an example to show you how </span></span></span></span></span></span><span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:&quot;ubuntu&quot;"><span style="font-family:&quot;ubuntu&quot;">wordlistctl works.</span><br /></span></span></span></span></span></span></span></span></span></span></span></span></span></p>', 'taskType': 'none', 'taskNo': 3, 'taskCreated': '2020-09-03T17:30:37.297Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p><a href="https://en.wikipedia.org/wiki/RockYou#Data_breach" target="_blank">RockYou</a> is a famous wordlist contains a large set of commonly used password sorted by frequency.<br />To search for this wordlist with wordlistclt run:</p><p><code>wordlistctl search rockyou</code></p>', 'hint': ''}, {'questionNo': 2, 'question': '<p>Which option do you need to add to the previous command to search into local archives instead of remote ones?<br /></p>', 'hint': 'wordlistctl search -h'}, {'questionNo': 3, 'question': '<p>Download and install rockyou wordlist by running this command: <code>wordlistctl fetch -l rockyou</code></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>Now search again for rockyou on your local archive with <code>wordlistctl search -l rockyou</code></p><p>You should see that the wordlist is deployed at <code>/usr/share/wordlists/passwords/rockyou.txt.tar.gz</code><br /></p><p>But the wordlist is compressed in a tar.gz archive, to decompress it run <code>wordlistctl fetch -l rockyou -d</code>.<br />If you run <code>wordlistctl search -l rockyou</code> one more time, what is the path where is stored the wordlist?<br /></p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>You can search for a wordlist about a specific subject (eg. facebook) <code>wordlistctl search facebook</code> or list all wordlists from a category (eg. fuzzing) <code>wordlistctl list -g fuzzing</code><span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace">.</span></span></span></span></span></span></p><p>What is the name of the first wordlist in the usernames category?<span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace"><br /></span></span></span></span></span></span></p><p><span style="font-family:monospace"><span style="font-family:monospace"><span style="color:#000000;background-color:#ffffff"><span style="font-family:monospace"><span style="font-family:monospace"><span style="font-family:monospace"></span></span></span></span></span></span></p>', 'hint': ''}]}, {'taskTitle': '<span class="badge size-16" style="background-color:rgba(252,190,108,.18);color:#fcbe6c">Walkthrough</span> Cracking tools, modes &amp; rules', 'taskDesc': '<p><span>\ufeff</span>Finally you\'ll need a cracking tool, the 2 very common ones are:</p><ul><li><a href="https://hashcat.net/hashcat/" target="_blank">Hashcat</a></li><li><a href="http://www.openwall.com/john/" target="_blank">John the Ripper</a> (jumbo version)</li></ul><p>There are several modes of cracking you can use:</p><ul><li><b>Wordlist mode</b>, which consist in trying all words contained in a dictionary. For example, a list of common passwords, a list of usernames, etc.</li><li><b>Incremental mode</b>, which consist in trying all possible\ncharacter combinations as passwords. This is powerful but much more longer especially if the password is long.</li><li><b>Rule mode</b>, which consist in using the wordlist mode by adding it some pattern or mangle the string. For example adding the current year, or appending a common special character.</li></ul><p>There are 2 ways of performing a rule based bruteforce:</p><ol><li>Generating a custom wordlist and using the classic wordlist mode with it.<br /></li><li>Using a common wordlist and tell the cracking tool to apply some custom mangling rules on it.</li></ol><p>The second option is much more powerful as you wont waste gigabytes by storing tons of wordlists and waste time generating ones you will use only one time. Rather having a few interesting lists and apply various mangling rules that you can re-use over different wordlist.<br /></p><p>John the Ripper already include various mangling rules but you can create your owns and apply them the wordlist when cracking:</p><pre><code>$ john hash.txt --wordlist=/usr/share/wordlists/passwords/rockyou.txt rules=norajCommon02</code></pre><pre><span style="font-family:&quot;Ubuntu Mono&quot;;font-size:16px">\ufeff</span><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px;font-family:&quot;ubuntu&quot;">Yo</span><span style="font-size:16px;font-family:&quot;ubuntu&quot;">u can</span><span style="font-size:16px;font-family:&quot;ubuntu&quot;"> consult John the Ripper </span><span style="font-size:16px;font-family:&quot;ubuntu&quot;"><a href="https://www.openwall.com/john/doc/RULES.shtml" target="_blank">Wordlist rules syntax</a></span><span style="font-size:16px;font-family:&quot;ubuntu&quot;"> for creating your own rules.</span></span></pre><pre><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px;font-family:&quot;ubuntu&quot;">I\'ll give you the main ideas of mutation rules, of course several can be combined together.</span></span></pre><ul><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Border mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - commonly used combinations of digits and special symbols can be added at the end or at the beginning, or both</span></span></span></li><li><b><span style="font-family:&quot;ubuntu&quot;">Freak mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - letters are replaced with similarly looking special symbols</span><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><br /></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Case mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - the program checks all variations of uppercase/lowercase letters for any character</span></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Order mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - character order is reversed</span></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Repetition mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - the same group of characters are repeated several times</span></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Vowels mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - vowels are omitted or capitalized</span></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Strip mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - one or several characters are removed</span></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Swap mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - some characters are swapped and change places</span></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Duplicate mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - some characters are duplicated</span></span></span></li><li><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px"><b><span style="font-family:&quot;ubuntu&quot;">Delimiter mutation</span></b><span style="font-family:&quot;ubuntu&quot;"> - </span></span></span><span style="font-family:&quot;Ubuntu Mono&quot;"><span style="font-size:16px;font-family:&quot;ubuntu&quot;">delimiters are added between characters</span></span></li></ul>', 'taskType': 'none', 'taskNo': 4, 'taskCreated': '2020-09-03T17:44:19.819Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'Depending of your distribution, the John configuration may be located at <code>/etc/john/john.conf</code> and/or <code>/usr/share/john/john.conf</code>. To locate the JtR install directory run locate <code>john.conf</code>, then create <code>john-local.conf</code> in the same directory (in my case<code>/usr/share/john/john-local.conf</code>) and create our rules in here.', 'hint': ''}, {'questionNo': 2, 'question': 'Let\'s use the top 10 000 most used password list from <a href="https://github.com/danielmiessler/SecLists#install" target="_blank">SecLists</a> (<code>/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt</code>) and generate a simple border mutation by appending all 2 digits combinations at the end of each password.<br />\nLet\'s edit <code>/usr/share/john/john-local.conf</code> and add a new rule:<br />\n<pre>[List.Rules:THM01]\n$[0-9]$[0-9]\n</pre>', 'hint': ''}, {'questionNo': 3, 'question': "<p>Now let's crack the SHA1 hash <code>2d5c517a4f7a14dcb38329d228a7d18a3b78ce83</code>, we just have to write the hash in a text file and to specify the hash type, the wordlist and our rule name.\n<code>john hash.txt --format=raw-sha1 --wordlist=/usr/share/seclists/Passwords/Common-Credentials/10k-most-common.txt --rules=THM01</code></p><p>What was the password?<br />\n</p>", 'hint': ''}]}, {'taskTitle': '<span class="badge size-16" style="background-color:rgba(252,190,108,.18);color:#fcbe6c">Walkthrough</span> Custom wordlist generation', 'taskDesc': '<p>As I said in the previous task mangling rules avoid to waste storage space and time but there are some cases where generating a custom wordlist could be a better idea:</p><ul><li>You will often re-use the wordlist, generating one will save computation power rather than using a mangling rule</li><li>You want to use the wordlist with several tools</li><li>You want to use a tool that support wordlists but not mangling rules</li><li>You find the custom rule syntax of John too complex</li></ul>', 'taskType': 'none', 'taskNo': 5, 'taskCreated': '2020-10-22T18:38:28.020Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'Let\'s say we know the password we want to crack is about dogs.\nWe can download a list of dog races <code>wordlistctl fetch -l dogs -d</code>\n(<code>/usr/share/wordlists/misc/dogs.txt</code>).\nThen we can use <a href="https://github.com/sc0tfree/mentalist" target="_blank">Mentalist</a> to generate some mutations.\n', 'hint': ''}, {'questionNo': 2, 'question': '<p>We can load our dog wordlist in Mentalist, add some Case, Substitution, Append/Prepend rules.<br />Here we will toggle the case of one char of two and replace all s with a dollar sign.<br /></p><p><img style="width:100%" src="https://i.imgur.com/MBwYfcF.png" /></p><p>Then we can process and save the newly generated wordlist.<br />It\'s also possible to export John/Hashcat rules.<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>Crack the following md5 hash with the wordlist generated in the previous steps.<br /></p><p><code>ed91365105bba79fdab20c376d83d752</code></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>Now let\'s use <a href="https://github.com/digininja/CeWL" target="_blank">CeWL</a> to generate a wordlist from a website. It could be useful to retrieve a lot of words related to the password\'s topic.<br /></p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>For example to download all words from example.org with a depth of 2, run:<br /><code>cewl -d 2 -w $(pwd)/example.txt https://example.org</code><br />The depth is the number of link level the spider will follow.<br /></p>\nWhat is the last word of the list?', 'hint': ''}, {'questionNo': 6, 'question': '<p>With <a href="https://github.com/tp7309/TTPassGen" target="_blank">TTPassGen</a> we can craft wordlists from scratch. Create a first wordlist containing all 4 digits PIN code value.<br /></p><p><code>ttpassgen --rule \'[?d]{4:4:*}\' pin.txt</code></p>', 'hint': ''}, {'questionNo': 7, 'question': "<p>Generate a list of all lowercase chars combinations of length 1 to 3.</p><p><code>ttpassgen --rule '[?l]{1:3:*}' abc.txt</code></p>", 'hint': ''}, {'questionNo': 8, 'question': "<p>Then we can create a new wordlist that is a combination of several wordlists. Eg. combine the PIN wordlist and the letter wordlist separated by a dash.</p><p><code>ttpassgen --dictlist 'pin.txt,abc.txt' --rule '$0[-]{1}$1' combination.txt</code></p>\nBe warned combining wordlists quickly generated huge files, here combination.txt is 1.64 GB.\n<pre>$ wc pin.txt \n10000 10000 50000 pin.txt\n\n$ wc abc.txt \n18278 18278 72384 abc.txt\n\n$ wc combination.txt \n 182780000  182780000 1637740000 combination.txt\n</pre>", 'hint': ''}, {'questionNo': 9, 'question': '<p>Crack this md5 hash with combination.txt.<br /></p><p><code>e5b47b7e8df2597077e703c76ee86aee</code></p>', 'hint': ''}]}, {'taskTitle': '<span class="badge badge-soft-danger size-16">Challenge</span> It\'s time to crack hashes', 'taskDesc': "<p>You will have to crack several hashes. For each hash you will be given a short scenario that will help you to create a mangling rules, build a wordlist or finding some specialized data you'll need to crack the hash.</p><p>The scenarios are located on the website: Password advisor (http://MACHINE_IP), each piece of advice matches one of the following hashes (in the same order).</p>", 'taskType': 'vm', 'taskNo': 6, 'taskCreated': '2020-09-03T18:10:20.088Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '5fa6a250f0506c48b1fc2134', 'questions': [{'questionNo': 1, 'question': '<pre>Advice n°1 <code>b16f211a8ad7f97778e5006c7cecdf31</code></pre>', 'hint': 'English male name, MD5, Border mutation, custom rule'}, {'questionNo': 2, 'question': '<pre>Advice n°2 <code>7463fcb720de92803d179e7f83070f97</code></pre>', 'hint': 'English female name, MD5, Border mutation, custom rule'}, {'questionNo': 3, 'question': '<pre>Advice n°3 <code>f4476669333651be5b37ec6d81ef526f</code></pre>', 'hint': 'Town name of Mexico, MD5, Freak mutation, mentalist tool'}, {'questionNo': 4, 'question': '<pre>Advice n°4 <code>a3a321e1c246c773177363200a6c0466a5030afc</code></pre>', 'hint': 'Own name, SHA1, Case mutation; existing rule'}, {'questionNo': 5, 'question': '<pre>Advice n°5 <code>d5e085772469d544a447bc8250890949</code></pre>', 'hint': 'Lyrics, MD5, Order mutation, lyricpass'}, {'questionNo': 6, 'question': '<pre>Advice n°6 <code>377081d69d23759c5946a95d1b757adc</code></pre>', 'hint': 'Phone number, MD5, No mutation, pnwgen'}, {'questionNo': 7, 'question': '<pre>Advice n°7 <code>ba6e8f9cd4140ac8b8d2bf96c9acd2fb58c0827d556b78e331d1113fcbfe425ca9299fe917f6015978f7e1644382d1ea45fd581aed6298acde2fa01e7d83cdbd</code></pre>', 'hint': 'Rockyou, SHA3-512, No mutation'}, {'questionNo': 8, 'question': '<pre>Advice n°8 <code>9f7376709d3fe09b389a27876834a13c6f275ed9a806d4c8df78f0ce1aad8fb343316133e810096e0999eaf1d2bca37c336e1b7726b213e001333d636e896617</code></pre>', 'hint': 'Web scrapping, blake2, Repetition, CeWL'}, {'questionNo': 9, 'question': '<pre>Advice n°9 <code>$6$kI6VJ0a31.SNRsLR$Wk30X8w8iEC2FpasTo0Z5U7wke0TpfbDtSwayrNebqKjYWC4gjKoNEJxO/DkP.YFTLVFirQ5PEh4glQIHuKfA/</code></pre>', 'hint': 'Rockyou, SHA512-crypt, No mutation'}]}, {'taskTitle': '<span class="badge badge-soft-info size-16">Info</span> About the author', 'taskDesc': '<p>I hoped you enjoyed the room.<br />To find out more on me (<b><span style="background-color:transparent">noraj</span></b>) check <a href="https://pwn.by/noraj" target="_blank">pwn.by/noraj</a>.<br />You can find my other THM rooms on <a href="https://tryhackme.com/p/noraj" target="_blank">my THM profile</a>.</p>\n<a href="https://pwn.by/noraj" target="_blank"><img src="https://tryhackme-badges.s3.amazonaws.com/noraj.png" alt="TryHackMe" /></a>', 'taskType': 'none', 'taskNo': 7, 'taskCreated': '2021-05-23T09:35:11.698Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'Thank you<br />', 'hint': ''}]}]}