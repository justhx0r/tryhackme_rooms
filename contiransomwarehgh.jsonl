{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/efe12f2572d7ed0e3d94c37c00560bdc.png', 'title': 'Conti', 'description': 'An Exchange server was compromised with ransomware. Use Splunk to investigate how the attackers compromised the server. ', 'code': 'contiransomwarehgh', 'users': 4733, 'tags': ['conti', 'ransomware', 'splunk', 'MITRE ID S0575'], 'type': 'challenge', 'difficulty': 'medium', 'userCompleted': False, 'upVotes': 183, 'created': '2021-09-20T21:17:59.995Z', 'published': '2022-01-07T15:50:13.596Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://assets.tryhackme.com/additional/conti/conti-room-banner.png', 'creator': 'tryhackme', 'tasks': [{'taskTitle': 'SITREP', 'taskDesc': '<p><span style="font-size:1rem;text-align:left">Some employees from your company reported that they can’t log into Outlook. The Exchange system admin also reported that he can’t log in to the Exchange Admin Center. After initial triage, they discovered some weird readme files settled on the Exchange server.\xa0\xa0</span></p><p><span style="font-size:1rem">Below is a copy of the ransomware note.</span></p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/15db974b80239a7eb2c52fb26c458933.png" style="width:100%" /><br /></p><p><span style="font-size:1rem"><b>Warning</b></span><span style="font-size:1rem">: Do\xa0<b>NOT</b>\xa0attempt to visit and/or interact with any URLs displayed in the ransom note.\xa0</span><br /></p><p>Read the latest on the Conti ransomware <a href="https://www.bleepingcomputer.com/news/security/fbi-cisa-and-nsa-warn-of-escalating-conti-ransomware-attacks/" target="_blank">here</a>.\xa0</p><hr /><p>Connect to OpenVPN or use the AttackBox to access the attached Splunk instance.\xa0</p><p>Splunk Interface Credentials:</p><p><b>Username</b>:\xa0<code>bellybear</code></p><p><b>Password</b>:\xa0<code>password!!!</code></p><p><b>Splunk URL</b>: <code>http://MACHINE_IP:8000</code></p><p style="text-align:center">Special thanks to\xa0<a href="https://www.linkedin.com/in/bohansec?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAACFkYBwB9L43-CozJsTYeFoIV29KBlKU9qc&amp;lipi=urn%3Ali%3Apage%3Ad_flagship3_search_srp_all%3BWgzBOFb8RQWd%2B24UFVSw%2Fw%3D%3D" target="_blank">Bohan Zhang</a>\xa0for this challenge.</p>', 'taskType': 'none', 'taskNo': 1, 'taskCreated': '2021-09-20T21:18:10.791Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': 'Start the attached virtual machine.', 'hint': ''}]}, {'taskTitle': 'Exchange Server Compromised', 'taskDesc': '<p><span style="font-size:1rem">Below are the error messages that the Exchange admin and employees see when they try to access anything related to Exchange or Outlook.</span><br /></p><p><b>Exchange Control Panel</b>:<br /><img style="width:100%" src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/214468bd3cc7466762b2358993bb3069.png" /><img style="font-size:1rem;width:100%" /></p><p></p><p><b>Outlook Web Access</b>:</p><p><img src="https://tryhackme-images.s3.amazonaws.com/user-uploads/5de58e2bfac4a912bcc7a3e9/room-content/c7d87fb962d961d81502f02dd1fdba77.png" style="width:100%" /><br /></p><p></p><p><b>Task</b>: You are assigned to investigate this situation. Use Splunk to answer the questions below regarding the Conti ransomware.\xa0</p>', 'taskType': 'vm', 'taskNo': 2, 'taskCreated': '2021-09-21T23:08:09.111Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '61d898aa1adf990043357ef8', 'questions': [{'questionNo': 1, 'question': 'Can you identify the location of the ransomware?', 'hint': 'Look for a common Windows binary located in an unusual location.'}, {'questionNo': 2, 'question': '<p>What is the Sysmon event ID for the related file creation event?<br /></p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>Can you find the MD5 hash of the ransomware?<br /></p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What file was saved to multiple folder locations?</p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>What was the command the attacker used to add a new user to the compromised system?</p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>The attacker migrated the process for better persistence. What is the migrated process image (executable)<span style="font-size:1rem">, and what is the original process image (executable) when the attacker got on the system?</span></p>', 'hint': 'Try Sysmon event code 8.'}, {'questionNo': 7, 'question': '<p>The attacker also retrieved the system hashes. What is the process image used for getting the system hashes?<br /></p>', 'hint': 'Try Sysmon event code 8 & check Target Image.'}, {'questionNo': 8, 'question': '<p>What is the web shell the exploit deployed to the system?<br /></p>', 'hint': 'Try looking in the IIS logs for POST requests.'}, {'questionNo': 9, 'question': '<p>What is the command line that executed this web shell?<br /></p>', 'hint': 'Check the CommandLine.'}, {'questionNo': 10, 'question': '<p>What three CVEs did this exploit leverage?<br /></p>', 'hint': 'External research required.'}]}]}