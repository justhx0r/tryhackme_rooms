{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/03fe1b480ba9d32b7065f2dda0bf4fba.png', 'title': 'Masterminds', 'description': 'Practice analyzing malicious traffic using Brim.', 'code': 'mastermindsxlq', 'users': 2729, 'tags': ['security', 'traffic analysis', 'brim', 'packet analysis'], 'type': 'challenge', 'difficulty': 'medium', 'userCompleted': False, 'upVotes': 253, 'created': '2021-08-29T21:22:51.725Z', 'published': '2021-10-07T18:06:23.387Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://assets.tryhackme.com/additional/brimchallenge/brim-challenge-banner2.png', 'creator': 'tryhackme', 'tasks': [{'taskTitle': 'Detect the compromise using Brim. ', 'taskDesc': '<p style="text-align:center"><img src="https://i.ibb.co/T1tPZdn/Depositphotos-174220344-s-2019.jpg" style="width:318.167px;height:318.167px" /><br /></p><p>Three machines in the Finance department at Pfeffer PLC were compromised. We suspect the initial source of the compromise happened through a phishing attempt and by an infected USB drive. The Incident Response team managed to pull the network traffic logs from the endpoints. Use Brim to investigate the network traffic for any indicators of an attack and determine who stands behind the attacks.\xa0</p><p><b>NOTE: DO NOT</b> directly interact with any domains and IP addresses in this challenge.\xa0</p><hr /><p>Deploy the machine attached to this task; it will be visible in the <b>split-screen</b> view once it is ready.</p><p>If you don\'t see a virtual machine load then click the <b>Show Split View</b> button.</p><p><img src="https://assets.tryhackme.com/additional/brimchallenge/brim-split-view.png" style="width:1076px" /></p>', 'taskType': 'vm', 'taskNo': 1, 'taskCreated': '2021-08-29T21:23:07.675Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '6154c9de2f9d47004fab51e5', 'questions': [{'questionNo': 1, 'question': 'Read the above.', 'hint': ''}]}, {'taskTitle': '[Infection 1]', 'taskDesc': '<p style="text-align:center"><img src="https://i.ibb.co/SrZtgk8/Depositphotos-29702781-s-2019.jpg" style="width:167.583px;height:156.355px" /></p><p style="text-align:center"><br /></p><p>Start by loading the Infection1 packet capture in Brim to investigate the compromise event for the first machine. All the PCAPs can be found here: <code>/home/ubuntu/Desktop/PCAPs</code><br /></p><p><b>Note</b>:\xa0For questions that require multiple answers, please separate the answers with a comma.</p>', 'taskType': 'none', 'taskNo': 2, 'taskCreated': '2021-08-29T21:30:30.866Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': "<p>Provide the victim's IP address.</p>", 'hint': ''}, {'questionNo': 2, 'question': "The victim attempted to make HTTP connections to two suspicious domains with the status '404 Not Found'. Provide the hosts/domains requested.\xa0", 'hint': ''}, {'questionNo': 3, 'question': '<p>The victim made a successful HTTP connection to one of the domains and received the response_body_len of 1,309 (uncompressed content size of the data transferred from the server). Provide the domain and the destination IP address.</p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>How many unique DNS requests were made to cab[.]myfkn[.]com domain (including the capitalized domain)?\xa0</p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>Provide the URI of the domain bhaktivrind[.]com that the victim reached out over HTTP.\xa0</p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>Provide the IP address of the malicious server and the executable that the victim downloaded from the server.\xa0</p>', 'hint': ''}, {'questionNo': 7, 'question': 'Based on the information gathered from the second question, provide the name of the malware using <a href="https://www.virustotal.com/gui/home/upload" target="_blank">VirusTotal</a>.\xa0', 'hint': 'Check what the Community has to say.'}]}, {'taskTitle': '[Infection 2]', 'taskDesc': '<p style="text-align:center"><img src="https://i.ibb.co/6v1mjDq/Blue-file-folder-isolated-on-white-background.jpg" style="width:298.7px;height:298.7px" /><br /></p><p>Please, navigate to the\xa0<span style="font-weight:bolder">Infection2\xa0</span>packet capture in Brim to investigate the compromise event for the second machine.</p><p><span style="font-weight:bolder">Note</span>:\xa0For questions that require multiple answers, please separate the answers with a comma.<br /></p>', 'taskType': 'none', 'taskNo': 3, 'taskCreated': '2021-08-29T21:59:14.216Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p>Provide the IP address of the victim machine.\xa0</p>', 'hint': ''}, {'questionNo': 2, 'question': 'Provide the IP address the victim made the POST connections to.\xa0', 'hint': ''}, {'questionNo': 3, 'question': '<p>How many POST connections were made to the IP address in the previous question?</p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>Provide the domain where the binary was downloaded from.\xa0</p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>Provide the name of the binary including the full URI.</p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>Provide the IP address of the domain that hosts the binary.</p>', 'hint': ''}, {'questionNo': 7, 'question': '<p>There were 2 Suricata "A Network Trojan was detected" alerts. What were the source and destination IP addresses?\xa0</p>', 'hint': ''}, {'questionNo': 8, 'question': '<p>Taking a look at .top domain in HTTP requests, provide the name of the stealer (Trojan that gathers information from a system) involved in this packet capture using\xa0<a href="https://urlhaus.abuse.ch/" target="_blank">URLhaus Database</a>.\xa0</p>', 'hint': ''}]}, {'taskTitle': '[Infection 3]', 'taskDesc': '<p style="text-align:center"><img src="https://i.ibb.co/bP1frZQ/Depositphotos-5808322-s-2019.jpg" style="width:360.4px;height:270.3px" /><br /></p><p>Please, load the Infection3 packet capture in Brim to investigate the compromise event for the third machine.<br /></p><p><span style="font-weight:bolder">Note</span>:\xa0For questions that require multiple answers, please separate the answers with a comma.<br /></p>', 'taskType': 'none', 'taskNo': 4, 'taskCreated': '2021-08-30T00:06:31.809Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '', 'questions': [{'questionNo': 1, 'question': '<p>Provide the IP address of the victim machine.</p>', 'hint': ''}, {'questionNo': 2, 'question': 'Provide three C2 domains from which the binaries were downloaded (starting from the earliest to the latest in the timestamp)', 'hint': "Start from the bottom of the output and work your way up or use '| sort ts'."}, {'questionNo': 3, 'question': 'Provide the IP addresses for all three domains in the previous question.', 'hint': ''}, {'questionNo': 4, 'question': '<p>How many unique DNS queries were made to the domain associated from the first IP address from the previous answer?\xa0</p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>How many binaries were downloaded from the above domain in total?\xa0</p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>Provided the user-agent listed to download the binaries.\xa0</p>', 'hint': 'Try to type "user_agent" in the search bar.'}, {'questionNo': 7, 'question': '<p>Provide the amount of DNS connections made in total for this packet capture.</p>', 'hint': ''}, {'questionNo': 8, 'question': "<p>With some OSINT skills, provide the name of the worm using the first domain you have managed to collect from Question 2. (Please use quotation marks for Google searches, don't use .ru in your search, and DO NOT interact with the domain directly).</p>", 'hint': ''}]}]}