{'image': 'https://tryhackme-images.s3.amazonaws.com/room-icons/fa099a85e684e1c3b381e3a447fc2a90.png', 'title': 'Investigating Windows 3.x', 'description': 'Find the artifacts resident on the endpoint and sift through captured data to determine what type attack occurred on the endpoint. ', 'code': 'investigatingwindows3', 'users': 6767, 'tags': ['sysinternals', 'mitre', 'event logs', 'sysmon'], 'type': 'challenge', 'difficulty': 'medium', 'userCompleted': False, 'upVotes': 192, 'created': '2021-01-22T12:40:04.237Z', 'published': '2021-02-12T17:52:27.612Z', 'freeToUse': True, 'businessOnly': False, 'headerImage': 'https://assets.tryhackme.com/additional/investigation-series/investigating-windows-banner3.png', 'creator': 'tryhackme', 'tasks': [{'taskTitle': 'Investigating Windows 3.x', 'taskDesc': '<div style="display:flex"><div style="flex:2 1 0%;overflow:hidden"><p style="text-align:center"><img src="https://assets.tryhackme.com/additional/investigation-series/investigations.png" style="width:232.805px;height:209.75px" /><b><br /></b></p><p><b>Note</b>: In order to answer the questions in this challenge you should have completed the following rooms:</p><ul><li><a href="http://tryhackme.com/jr/btwindowsinternals" target="_blank">Core Windows Processes</a></li><li><a href="https://tryhackme.com/room/windowseventlogs" target="_blank">Windows Event Logs</a></li><li><a href="http://tryhackme.com/jr/btsysinternalssg" target="_blank">Sysinternals</a></li><li><a href="https://tryhackme.com/room/sysmon" target="_blank">Sysmon</a></li><li><a href="https://tryhackme.com/room/yara" target="_blank">Yara</a></li><li><a href="https://tryhackme.com/room/mitre" target="_blank">MITRE</a></li></ul><p></p><hr /><p></p><p>Connect to the machine using RDP. </p><p>The credentials of the machine are as follows:</p><p><b>Username</b>: <code>Administrator</code><br /><b>Password</b>:\xa0<code>blueT3aming!</code></p><p>Your machine\'s IP is:\xa0MACHINE_IP</p><p>If you\'re using Remmina to RDP, set the <b>Color Depth</b> to <code>RemoteFX (32 bpp)</code>.</p><p><span style="color:rgb(0, 0, 0);text-align:center"><b>Note</b>: This machine does not respond to ping (ICMP) and may take a few minutes to boot up.</span></p></div><div><br /></div></div>', 'taskType': 'vm', 'taskNo': 1, 'taskCreated': '2021-01-22T12:45:59.488Z', 'taskDeadline': None, 'tasksInfo': [], 'uploadId': '600f454978068f55c4a3112a', 'questions': [{'questionNo': 1, 'question': 'What is the registry key with the encoded payload? (full path)\xa0', 'hint': ''}, {'questionNo': 2, 'question': '<p>What is the rule name for this run key generated by Sysmon?</p>', 'hint': ''}, {'questionNo': 3, 'question': '<p>What tactics is classified with this MITRE ATT&amp;CK ID?</p>', 'hint': ''}, {'questionNo': 4, 'question': '<p>What was UTC time for the Sysmon event?</p>', 'hint': ''}, {'questionNo': 5, 'question': '<p>What was the Sysmon Event ID? Event Type?\xa0<span style="font-size:1rem">(</span><span style="font-size:1rem;font-weight:bolder">answer, answer</span><span style="font-size:1rem">)</span></p>', 'hint': ''}, {'questionNo': 6, 'question': '<p>Decode the payload. What service will the payload attempt start?</p>', 'hint': ''}, {'questionNo': 7, 'question': 'The payload attempts to open a local port. What is the port number?', 'hint': ''}, {'questionNo': 8, 'question': '<p>What process does the payload attempt to terminate?</p>', 'hint': ''}, {'questionNo': 9, 'question': '<p>What DLL file does the payload attempt to remove? (<b>full path</b>)</p>', 'hint': ''}, {'questionNo': 10, 'question': '<p><span style="font-size:1rem">What is the Windows Event ID\xa0</span>associated with this service?</p>', 'hint': 'This DLL is associated with Print Spooler or Fax services'}, {'questionNo': 11, 'question': '<p>What is listed as the New Default Printer?</p>', 'hint': ''}, {'questionNo': 12, 'question': '<p>What process is associated with this event?</p>', 'hint': ''}, {'questionNo': 13, 'question': 'What is the parent PID for the above process?', 'hint': ''}, {'questionNo': 14, 'question': '<p>Examine the other processes. What is the PID of the process running the encoded payload?</p>', 'hint': ''}, {'questionNo': 15, 'question': '<p>Decode the payload. What is the a visible partial path?</p>', 'hint': ''}, {'questionNo': 16, 'question': '<p>This is the default communication profile the agent used to connect to the attack machine. What attack framework was used? What is the name of the variable? (<b>answer, answer</b>)</p>', 'hint': ''}, {'questionNo': 17, 'question': '<p>What other file paths are you likely to find in the logs? (<b>answer, answer</b>)</p>', 'hint': ''}, {'questionNo': 18, 'question': '<p>What is the MITRE ATT&amp;CK URI for the attack framework?</p>', 'hint': ''}, {'questionNo': 19, 'question': 'What was the FQDN of the attacker machine that the suspicious process connected to?', 'hint': ''}, {'questionNo': 20, 'question': '<p>What other process connected to the attacker machine?</p>', 'hint': ''}, {'questionNo': 21, 'question': '<p>What is the PID for this process?</p>', 'hint': ''}, {'questionNo': 22, 'question': "<p>What was the path for the first image loaded for the process identified in Q's 19 &amp; 20?</p>", 'hint': ''}, {'questionNo': 23, 'question': '<p>What Sysmon event was generated between these 2 processes? What is its associated Event ID #?\xa0<span style="font-size:1rem">(</span><span style="font-size:1rem;font-weight:bolder">answer, answer</span><span style="font-size:1rem">)</span></p>', 'hint': ''}, {'questionNo': 24, 'question': '<p>What is the UTC time for the first event between these 2 processes?</p>', 'hint': ''}, {'questionNo': 25, 'question': '<p>What is the value under Date and Time? <span style="font-size:1rem">(</span><span style="font-size:1rem;font-weight:bolder">MM/DD/YYYY H:MM:SS [AM/PM]</span><span style="font-size:1rem">)</span></p>', 'hint': ''}, {'questionNo': 26, 'question': '<p>What is the first operation listed by the 2nd process starting with the Date and Time from Q25?</p>', 'hint': ''}, {'questionNo': 27, 'question': '<div><span style="font-size:1rem">What is the full registry path that was queried by the attacker to get information about the victim?</span></div>', 'hint': "Try searching for ProcMon events beginning with '1/21/2021 5:07'"}, {'questionNo': 28, 'question': '<p>What is the name of the last module in the stack from this event which had a successful result?</p>', 'hint': ''}, {'questionNo': 29, 'question': '<p>Most likely what module within the attack framework was used between the 2 processes?\xa0</p>', 'hint': ''}, {'questionNo': 30, 'question': '<p>What is the MITRE ID for this technique?</p>', 'hint': ''}]}]}